{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usuario/Documents/fluidez%20activa%20implementacion/app/visualizacion/Spectrogram.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\n\r\ntype Props = {\r\n  audioUrl?: string | null;\r\n  stream?: MediaStream | null;\r\n  isLive?: boolean;\r\n  // optional refs from parent to reuse AudioContext and MediaElementSource\r\n  audioCtxRef?: React.MutableRefObject<AudioContext | null>;\r\n  mediaSourceRef?: React.MutableRefObject<MediaElementAudioSourceNode | null>;\r\n  audioRef?: React.RefObject<HTMLAudioElement>;\r\n};\r\n\r\nexport default function Spectrogram({ audioUrl, stream, isLive, audioCtxRef: parentAudioCtxRef, mediaSourceRef: parentMediaSourceRef, audioRef: parentAudioRef }: Props) {\r\n  const canvasRef = useRef<HTMLCanvasElement>(null);\r\n  const pitchCanvasRef = useRef<HTMLCanvasElement>(null);\r\n  const animationRef = useRef<number>();\r\n  const audioContextRef = useRef<AudioContext|null>(null);\r\n  const analyserRef = useRef<AnalyserNode|null>(null);\r\n  const sourceRef = useRef<MediaElementAudioSourceNode|null>(null);\r\n  const spectrogramDataRef = useRef<number[][]>([]);\r\n  const audioElementRef = useRef<HTMLAudioElement|null>(null);\r\n  const [audioDuration, setAudioDuration] = useState<number>(0);\r\n  const [currentTime, setCurrentTime] = useState<number>(0);\r\n\r\n  useEffect(() => {\r\n    // Reanudar AudioContext ante un gesto del usuario para evitar silencio\r\n    const resumeOnGesture = () => {\r\n      const ctx = (parentAudioCtxRef && parentAudioCtxRef.current) || audioContextRef.current;\r\n      if (ctx && ctx.state === 'suspended') {\r\n        try { ctx.resume(); } catch (_) {}\r\n      }\r\n    };\r\n    window.addEventListener('pointerdown', resumeOnGesture, { once: false });\r\n    window.addEventListener('keydown', resumeOnGesture, { once: false });\r\n    return () => {\r\n      window.removeEventListener('pointerdown', resumeOnGesture);\r\n      window.removeEventListener('keydown', resumeOnGesture);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!canvasRef.current || !pitchCanvasRef.current) return;\r\n    const canvas = canvasRef.current;\r\n    const pitchCanvas = pitchCanvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n    const pitchCtx = pitchCanvas.getContext('2d');\r\n    if (!ctx || !pitchCtx) return;\r\n\r\n    // Si no hay audio, solo dibuja los fondos y retorna\r\n    if (!audioUrl && !isLive) {\r\n      const drawSpectrogramBackground = () => {\r\n        ctx.fillStyle = '#ffffff';\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n        ctx.strokeStyle = '#e8e8e8';\r\n        ctx.lineWidth = 1;\r\n        for (let i = 0; i <= 5; i++) {\r\n          const y = (canvas.height / 5) * i;\r\n          ctx.beginPath();\r\n          ctx.moveTo(0, y);\r\n          ctx.lineTo(canvas.width, y);\r\n          ctx.stroke();\r\n        }\r\n        for (let i = 0; i <= 10; i++) {\r\n          const x = (canvas.width / 10) * i;\r\n          ctx.beginPath();\r\n          ctx.moveTo(x, 0);\r\n          ctx.lineTo(x, canvas.height);\r\n          ctx.stroke();\r\n        }\r\n      };\r\n      const drawPitchBackground = () => {\r\n        pitchCtx.fillStyle = '#f9f9f9';\r\n        pitchCtx.fillRect(0, 0, pitchCanvas.width, pitchCanvas.height);\r\n        pitchCtx.strokeStyle = '#e0e0e0';\r\n        pitchCtx.lineWidth = 0.5;\r\n        for (let i = 0; i <= 5; i++) {\r\n          const y = (pitchCanvas.height / 5) * i;\r\n          pitchCtx.beginPath();\r\n          pitchCtx.moveTo(0, y);\r\n          pitchCtx.lineTo(pitchCanvas.width, y);\r\n          pitchCtx.stroke();\r\n        }\r\n      };\r\n      drawSpectrogramBackground();\r\n      drawPitchBackground();\r\n      return;\r\n    }\r\n\r\n    // Limpia contexto anterior SOLO si lo cre√≥ este componente\r\n    if (audioContextRef.current && audioContextRef.current !== parentAudioCtxRef?.current) {\r\n      try {\r\n        audioContextRef.current.close();\r\n      } catch (e) {\r\n        console.warn('Error cerrando audio context:', e);\r\n      }\r\n      audioContextRef.current = null;\r\n    }\r\n\r\n    let audioCtx: AudioContext;\r\n    let source: MediaElementAudioSourceNode | MediaStreamAudioSourceNode | null = null;\r\n    if (isLive && stream) {\r\n      audioCtx = (parentAudioCtxRef && parentAudioCtxRef.current) || new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      if (parentAudioCtxRef && !parentAudioCtxRef.current) {\r\n        parentAudioCtxRef.current = audioCtx;\r\n      }\r\n      if (!parentAudioCtxRef) audioContextRef.current = audioCtx;\r\n      source = audioCtx.createMediaStreamSource(stream);\r\n    } else {\r\n      // Busca el elemento de audio - usar el ref del padre si est√° disponible\r\n      let audioElem: HTMLAudioElement | null = null;\r\n      if (parentAudioRef && parentAudioRef.current) {\r\n        audioElem = parentAudioRef.current;\r\n      } else {\r\n        audioElem = document.querySelector('audio');\r\n      }\r\n      if (!audioElem) {\r\n        console.warn('No se encontr√≥ elemento de audio');\r\n        return;\r\n      }\r\n      audioElementRef.current = audioElem as HTMLAudioElement;\r\n      audioCtx = (parentAudioCtxRef && parentAudioCtxRef.current) || new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      if (parentAudioCtxRef && !parentAudioCtxRef.current) {\r\n        parentAudioCtxRef.current = audioCtx;\r\n      }\r\n      if (!parentAudioCtxRef) audioContextRef.current = audioCtx;\r\n      if (parentMediaSourceRef && parentMediaSourceRef.current) {\r\n        source = parentMediaSourceRef.current;\r\n      } else if (sourceRef.current) {\r\n        source = sourceRef.current;\r\n      } else {\r\n        try {\r\n          // Intentar crear source solo si no existe uno v√°lido\r\n          // Nota: createMediaElementSource lanzar√° error si ya existe uno para este elemento\r\n          source = audioCtx.createMediaElementSource(audioElem);\r\n          if (parentMediaSourceRef) {\r\n            parentMediaSourceRef.current = source;\r\n          } else {\r\n            sourceRef.current = source;\r\n          }\r\n        } catch (err) {\r\n          console.warn('No se pudo crear MediaElementSource (probablemente ya existe):', err);\r\n          // Si falla, intentamos recuperar el existente si es posible, o simplemente no conectamos\r\n          // Si ya existe y est√° conectado a otro contexto, no podemos hacer mucho\r\n        }\r\n      }\r\n    }\r\n\r\n    const analyser = audioCtx.createAnalyser();\r\n    analyser.fftSize = 4096;\r\n    analyser.smoothingTimeConstant = 0.8;\r\n    analyserRef.current = analyser;\r\n\r\n    // Conectar solo si el source pertenece al mismo contexto de audio\r\n    if (source) {\r\n      try {\r\n        // Verificar si el source pertenece al contexto actual\r\n        if (source.context === audioCtx) {\r\n          try { source.disconnect(); } catch (e) {}\r\n          source.connect(analyser);\r\n        } else {\r\n          console.warn('Source context mismatch', source.context.state, audioCtx.state);\r\n        }\r\n      } catch (err) {\r\n        console.warn('Error conectando source al analyser:', err);\r\n      }\r\n    }\r\n    try {\r\n      // Solo conectar al destino (altavoces) si NO es en vivo.\r\n      // En modo live (grabaci√≥n), el audio ya se est√° monitoreando/procesando en el componente padre (DAFPage).\r\n      // Si lo conectamos aqu√≠ tambi√©n, tendremos doble audio (directo + procesado) causando eco y feedback.\r\n      if (!isLive) {\r\n        analyser.connect(audioCtx.destination);\r\n      }\r\n    } catch (err) {\r\n      console.warn('Error conectando analyser al destination:', err);\r\n    }\r\n\r\n    // Asegurar que el contexto est√© corriendo si no es live (en live depende del usuario)\r\n    if (!isLive && audioCtx.state === 'suspended') {\r\n       // No forzamos resume aqu√≠ para cumplir con pol√≠ticas de autoplay, \r\n       // pero el manejador de eventos global lo har√° al primer clic\r\n    }\r\n\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Uint8Array(bufferLength);\r\n    spectrogramDataRef.current = [];\r\n\r\n    // Dibujar fondo y ejes para espectrograma\r\n    function drawSpectrogramBackground() {\r\n      ctx.fillStyle = '#ffffff';\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n      \r\n      // Cuadr√≠cula\r\n      ctx.strokeStyle = '#e8e8e8';\r\n      ctx.lineWidth = 1;\r\n      \r\n      // L√≠neas de cuadr√≠cula horizontales (frecuencia)\r\n      for (let i = 0; i <= 5; i++) {\r\n        const y = (canvas.height / 5) * i;\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, y);\r\n        ctx.lineTo(canvas.width, y);\r\n        ctx.stroke();\r\n      }\r\n      \r\n      // L√≠neas de cuadr√≠cula verticales (tiempo)\r\n      for (let i = 0; i <= 10; i++) {\r\n        const x = (canvas.width / 10) * i;\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, 0);\r\n        ctx.lineTo(x, canvas.height);\r\n        ctx.stroke();\r\n      }\r\n    }\r\n\r\n    function drawPitchBackground() {\r\n      pitchCtx.fillStyle = '#f9f9f9';\r\n      pitchCtx.fillRect(0, 0, pitchCanvas.width, pitchCanvas.height);\r\n      \r\n      // L√≠neas de cuadr√≠cula\r\n      pitchCtx.strokeStyle = '#e0e0e0';\r\n      pitchCtx.lineWidth = 0.5;\r\n      for (let i = 0; i <= 5; i++) {\r\n        const y = (pitchCanvas.height / 5) * i;\r\n        pitchCtx.beginPath();\r\n        pitchCtx.moveTo(0, y);\r\n        pitchCtx.lineTo(pitchCanvas.width, y);\r\n        pitchCtx.stroke();\r\n      }\r\n    }\r\n\r\n    drawSpectrogramBackground();\r\n    drawPitchBackground();\r\n\r\n    // Limpiar espectrograma cuando el audio termina\r\n\r\n    let handleEnded: (() => void) | undefined;\r\n    let handlePlay: (() => void) | undefined;\r\n    let handleTimeUpdate: (() => void) | undefined;\r\n    let handleLoadedMetadata: (() => void) | undefined;\r\n    \r\n    if (!isLive && audioElementRef.current) {\r\n      handleEnded = () => {\r\n        spectrogramDataRef.current = [];\r\n        drawSpectrogramBackground();\r\n        drawPitchBackground();\r\n      };\r\n      handlePlay = () => {\r\n        // Reanudar AudioContext si estuviera suspendido para asegurar salida de audio\r\n        try { if (audioCtx.state === 'suspended') audioCtx.resume(); } catch (_) {}\r\n        if (audioElementRef.current && audioElementRef.current.currentTime < 0.1) {\r\n          spectrogramDataRef.current = [];\r\n          drawSpectrogramBackground();\r\n          drawPitchBackground();\r\n        }\r\n      };\r\n      handleTimeUpdate = () => {\r\n        if (audioElementRef.current) {\r\n          setCurrentTime(audioElementRef.current.currentTime);\r\n        }\r\n      };\r\n      handleLoadedMetadata = () => {\r\n        if (audioElementRef.current) {\r\n          setAudioDuration(audioElementRef.current.duration);\r\n        }\r\n      };\r\n      \r\n      audioElementRef.current.addEventListener('ended', handleEnded);\r\n      audioElementRef.current.addEventListener('play', handlePlay);\r\n      audioElementRef.current.addEventListener('timeupdate', handleTimeUpdate);\r\n      audioElementRef.current.addEventListener('loadedmetadata', handleLoadedMetadata);\r\n      \r\n      // Intentar obtener la duraci√≥n inmediatamente si ya est√° disponible\r\n      if (audioElementRef.current.duration && !isNaN(audioElementRef.current.duration)) {\r\n        setAudioDuration(audioElementRef.current.duration);\r\n      }\r\n    }\r\n\r\n    function draw() {\r\n      // En modo live siempre dibujar, en modo playback solo si est√° reproduci√©ndose o en pausa (para mantener el gr√°fico)\r\n      const shouldDraw = isLive || !audioElementRef.current || !audioElementRef.current.paused;\r\n      \r\n      if (shouldDraw || spectrogramDataRef.current.length > 0) {\r\n        analyser.getByteFrequencyData(dataArray);\r\n        \r\n        // Solo agregar nuevas columnas si realmente est√° reproduciendo\r\n        if (shouldDraw) {\r\n          // Agregar columna actual al espectrograma\r\n          const column: number[] = [];\r\n          for (let i = 0; i < bufferLength; i++) {\r\n            column.push(dataArray[i]);\r\n          }\r\n          spectrogramDataRef.current.push(column);\r\n          \r\n          // Limitar ancho del espectrograma (scrolling)\r\n          const maxColumns = canvas.width;\r\n          if (spectrogramDataRef.current.length > maxColumns) {\r\n            spectrogramDataRef.current.shift();\r\n          }\r\n        }\r\n\r\n        // Siempre redibujar el espectrograma si hay datos\r\n        if (spectrogramDataRef.current.length > 0) {\r\n          // Dibujar espectrograma\r\n          drawSpectrogramBackground();\r\n          \r\n          const columnWidth = canvas.width / spectrogramDataRef.current.length;\r\n          spectrogramDataRef.current.forEach((col, x) => {\r\n            for (let i = 0; i < Math.min(col.length, 200); i++) { // Limitar a ~5000Hz\r\n              const intensity = col[i];\r\n              const y = canvas.height - (i / 200) * canvas.height;\r\n              \r\n              // Escala de colores: azul oscuro -> amarillo -> rojo (similar a espectrogramas profesionales)\r\n              let r, g, b;\r\n              if (intensity < 85) {\r\n                // Azul oscuro -> azul\r\n                r = 0;\r\n                g = 0;\r\n                b = Math.floor(50 + (intensity / 85) * 155);\r\n              } else if (intensity < 170) {\r\n                // Azul -> verde -> amarillo\r\n                const t = (intensity - 85) / 85;\r\n                r = Math.floor(t * 255);\r\n                g = Math.floor(100 + t * 155);\r\n                b = Math.floor(205 - t * 205);\r\n              } else {\r\n                // Amarillo -> rojo\r\n                const t = (intensity - 170) / 85;\r\n                r = 255;\r\n                g = Math.floor(255 - t * 155);\r\n                b = 0;\r\n              }\r\n              \r\n              ctx.fillStyle = `rgba(${r}, ${g}, ${b}, 0.9)`;\r\n              ctx.fillRect(x * columnWidth, y - 1, columnWidth + 1, canvas.height / 200);\r\n            }\r\n          });\r\n\r\n          // Dibujar curva de F0 (pitch) estimada\r\n          drawPitchBackground();\r\n          \r\n          // Encontrar pico de energ√≠a como aproximaci√≥n de F0\r\n          let maxIntensity = 0;\r\n          let maxIndex = 0;\r\n          for (let i = 5; i < 100; i++) { // Rango t√≠pico de voz humana (80-500Hz aprox)\r\n            if (dataArray[i] > maxIntensity) {\r\n              maxIntensity = dataArray[i];\r\n              maxIndex = i;\r\n            }\r\n          }\r\n          \r\n          // Dibujar curva suave de pitch\r\n          const sampleRate = audioCtx.sampleRate;\r\n          const nyquist = sampleRate / 2;\r\n          const estimatedF0 = (maxIndex / bufferLength) * nyquist;\r\n          \r\n          if (spectrogramDataRef.current.length > 1) {\r\n            pitchCtx.strokeStyle = '#2563eb';\r\n            pitchCtx.lineWidth = 2;\r\n            pitchCtx.beginPath();\r\n            \r\n            spectrogramDataRef.current.forEach((col, x) => {\r\n              let colMaxIntensity = 0;\r\n              let colMaxIndex = 0;\r\n              for (let i = 5; i < 100; i++) {\r\n                if (col[i] > colMaxIntensity) {\r\n                  colMaxIntensity = col[i];\r\n                  colMaxIndex = i;\r\n                }\r\n              }\r\n              const f0 = (colMaxIndex / bufferLength) * nyquist;\r\n              const normalizedF0 = Math.min(Math.max((f0 - 50) / 300, 0), 1);\r\n              const y = pitchCanvas.height - (normalizedF0 * pitchCanvas.height);\r\n              \r\n              if (x === 0) {\r\n                pitchCtx.moveTo(x * columnWidth, y);\r\n              } else {\r\n                pitchCtx.lineTo(x * columnWidth, y);\r\n              }\r\n            });\r\n            pitchCtx.stroke();\r\n          }\r\n        }\r\n      }\r\n\r\n      animationRef.current = requestAnimationFrame(draw);\r\n    }\r\n    draw();\r\n\r\n    // Limpieza\r\n    return () => {\r\n      if (animationRef.current) cancelAnimationFrame(animationRef.current);\r\n      try { analyser.disconnect(); } catch (e) {}\r\n      if (audioContextRef.current) {\r\n        // No cerramos el contexto si viene del padre y est√° activo\r\n        if (audioContextRef.current !== parentAudioCtxRef?.current) {\r\n          audioContextRef.current.close();\r\n        }\r\n      }\r\n      if (!isLive && audioElementRef.current) {\r\n        if (handleEnded) audioElementRef.current.removeEventListener('ended', handleEnded);\r\n        if (handlePlay) audioElementRef.current.removeEventListener('play', handlePlay);\r\n        if (handleTimeUpdate) audioElementRef.current.removeEventListener('timeupdate', handleTimeUpdate);\r\n        if (handleLoadedMetadata) audioElementRef.current.removeEventListener('loadedmetadata', handleLoadedMetadata);\r\n      }\r\n    };\r\n  }, [audioUrl, isLive, stream]);\r\n\r\n  // Generar marcadores de tiempo din√°micos\r\n  const getTimeMarkers = () => {\r\n    const duration = audioDuration || 10;\r\n    const numMarkers = 11; // 0 a 10 marcadores (11 puntos)\r\n    const markers = [];\r\n    \r\n    for (let i = 0; i < numMarkers; i++) {\r\n      const time = (duration / (numMarkers - 1)) * i;\r\n      markers.push(time.toFixed(1) + 's');\r\n    }\r\n    \r\n    return markers;\r\n  };\r\n\r\n  return (\r\n    <div className=\"w-full flex flex-col items-center mt-1 mb-2\">\r\n      {/* Curva de F0 (Pitch) */}\r\n      <div className=\"w-full mb-3\">\r\n        <div className=\"text-xs text-gray-600 mb-1 font-semibold\">F0 - Frecuencia fundamental (Pitch)</div>\r\n        <div className=\"flex gap-2\">\r\n          <div className=\"flex flex-col justify-between text-xs text-gray-600\" style={{paddingTop: '5px', paddingBottom: '5px'}}>\r\n            <div>350 Hz</div>\r\n            <div>250 Hz</div>\r\n            <div>150 Hz</div>\r\n            <div>50 Hz</div>\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <canvas \r\n              ref={pitchCanvasRef} \r\n              width={800} \r\n              height={120} \r\n              className=\"w-full rounded border border-gray-300 bg-white shadow-sm\" \r\n            />\r\n            <div className=\"flex justify-between text-xs text-gray-600 mt-1\">\r\n              {getTimeMarkers().map((marker, i) => (\r\n                <div key={i}>{marker}</div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Espectrograma principal */}\r\n      <div className=\"w-full mb-3\">\r\n        <div className=\"text-xs text-gray-600 mb-1 font-semibold\">\r\n          Espectrograma - <span className=\"text-blue-700\">Frecuencia (Hz)</span> vs <span className=\"text-green-700\">Tiempo (s)</span>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <div className=\"flex flex-col justify-between text-xs text-gray-600 text-right\" style={{paddingTop: '5px', paddingBottom: '5px'}}>\r\n            <div>5000 Hz</div>\r\n            <div>4000 Hz</div>\r\n            <div>3000 Hz</div>\r\n            <div>2000 Hz</div>\r\n            <div>1000 Hz</div>\r\n            <div>0 Hz</div>\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <canvas \r\n              ref={canvasRef} \r\n              width={800} \r\n              height={250} \r\n              className=\"w-full rounded border border-gray-300 bg-white shadow-sm\" \r\n            />\r\n            <div className=\"flex justify-between text-xs text-gray-600 mt-1\">\r\n              {getTimeMarkers().map((marker, i) => (\r\n                <div key={i}>{marker}</div>\r\n              ))}\r\n            </div>\r\n            {currentTime > 0 && audioDuration > 0 && (\r\n              <div className=\"mt-1 text-xs text-indigo-600 font-semibold\">\r\n                Reproduciendo: {currentTime.toFixed(1)}s / {audioDuration.toFixed(1)}s\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"mt-2 text-sm text-gray-700 w-full\">\r\n        <p className=\"mb-2 text-justify\">\r\n          <b>¬øQu√© muestra el espectrograma?</b> El <span className=\"font-semibold\">eje horizontal</span> muestra el <span className=\"text-green-700 font-semibold\">tiempo en segundos</span>, y el <span className=\"font-semibold\">eje vertical</span> muestra la <span className=\"text-blue-700 font-semibold\">frecuencia en Hertz (Hz)</span>. Cada punto de color representa la energ√≠a (intensidad) de una frecuencia espec√≠fica en un momento dado. Las frecuencias bajas (parte inferior) corresponden a sonidos graves y las altas (parte superior) a sonidos agudos. Los colores indican intensidad: azul (bajo), verde-amarillo (medio), naranja (alto - m√°s intenso).\r\n        </p>\r\n        <p className=\"text-xs text-gray-600 text-justify\">\r\n          <b>Elementos suprasegmentales del acento:</b> <br/>\r\n          ‚Ä¢ <b>Articulatoriamente:</b> Incremento de la frecuencia de vibraci√≥n de las cuerdas vocales y de la fuerza y tiempo de salida del aire<br/>\r\n          ‚Ä¢ <b>Ac√∫sticamente:</b> Aumento de frecuencia fundamental, de intensidad o de duraci√≥n de una s√≠laba<br/>\r\n          ‚Ä¢ <b>Perceptivamente:</b> Prominencia en la altura tonal (agudo), en la intensidad (fuerte) o en la duraci√≥n (largo) de una s√≠laba\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 814, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usuario/Documents/fluidez%20activa%20implementacion/components/WordCloud.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useMemo } from 'react';\r\n\r\ninterface WordCloudProps {\r\n  transcript: string;\r\n  maxWords?: number;\r\n}\r\n\r\nexport default function WordCloud({ transcript, maxWords = 50 }: WordCloudProps) {\r\n  const wordData = useMemo(() => {\r\n    if (!transcript) return [];\r\n    \r\n    // Normalizar y limpiar el texto\r\n    const cleaned = transcript\r\n      .normalize('NFD')\r\n      .replace(/[\\u0300-\\u036f]/g, '') // Eliminar diacr√≠ticos\r\n      .replace(/[.,!?;:\\u2014\\-()\"'¬´¬ª\\[\\]]+/g, ' ') // Eliminar puntuaci√≥n\r\n      .toLowerCase();\r\n    \r\n    const words = cleaned.trim().split(/\\s+/).filter(Boolean);\r\n    const wordCount: Record<string, number> = {};\r\n    \r\n    words.forEach(word => {\r\n      if (word.length > 2) { // Ignorar palabras muy cortas\r\n        wordCount[word] = (wordCount[word] || 0) + 1;\r\n      }\r\n    });\r\n    \r\n    // Convertir a array y ordenar por frecuencia\r\n    return Object.entries(wordCount)\r\n      .sort((a, b) => b[1] - a[1])\r\n      .slice(0, maxWords)\r\n      .map(([text, value]) => ({ text, value }));\r\n  }, [transcript, maxWords]);\r\n\r\n  // Calcular tama√±os de fuente basados en frecuencia\r\n  const maxValue = Math.max(...wordData.map(w => w.value), 1);\r\n  const minFontSize = 12;\r\n  const maxFontSize = 48;\r\n\r\n  if (wordData.length === 0) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300\">\r\n        <p className=\"text-gray-400 italic\">No hay palabras para mostrar</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"relative w-full h-64 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 overflow-hidden\">\r\n      <div className=\"flex flex-wrap items-center justify-center gap-2 h-full\">\r\n        {wordData.map(({ text, value }) => {\r\n          const fontSize = minFontSize + ((value / maxValue) * (maxFontSize - minFontSize));\r\n          const opacity = 0.5 + (value / maxValue) * 0.5;\r\n          \r\n          // Colores basados en frecuencia\r\n          const hue = 200 + (value / maxValue) * 60; // De azul a cian\r\n          const saturation = 60 + (value / maxValue) * 30;\r\n          const lightness = 45 - (value / maxValue) * 15;\r\n          \r\n          return (\r\n            <span\r\n              key={text}\r\n              className=\"font-semibold transition-transform hover:scale-110 cursor-default\"\r\n              style={{\r\n                fontSize: `${fontSize}px`,\r\n                opacity,\r\n                color: `hsl(${hue}, ${saturation}%, ${lightness}%)`,\r\n                lineHeight: 1.2,\r\n              }}\r\n              title={`\"${text}\" aparece ${value} ${value === 1 ? 'vez' : 'veces'}`}\r\n            >\r\n              {text}\r\n            </span>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;AADA;;AAQe,SAAS,UAAU,EAAE,UAAU,EAAE,WAAW,EAAE,EAAkB;;IAC7E,MAAM,WAAW,IAAA,wKAAO;uCAAC;YACvB,IAAI,CAAC,YAAY,OAAO,EAAE;YAE1B,gCAAgC;YAChC,MAAM,UAAU,WACb,SAAS,CAAC,OACV,OAAO,CAAC,oBAAoB,IAAI,uBAAuB;aACvD,OAAO,CAAC,gCAAgC,KAAK,sBAAsB;aACnE,WAAW;YAEd,MAAM,QAAQ,QAAQ,IAAI,GAAG,KAAK,CAAC,OAAO,MAAM,CAAC;YACjD,MAAM,YAAoC,CAAC;YAE3C,MAAM,OAAO;+CAAC,CAAA;oBACZ,IAAI,KAAK,MAAM,GAAG,GAAG;wBACnB,SAAS,CAAC,KAAK,GAAG,CAAC,SAAS,CAAC,KAAK,IAAI,CAAC,IAAI;oBAC7C;gBACF;;YAEA,6CAA6C;YAC7C,OAAO,OAAO,OAAO,CAAC,WACnB,IAAI;+CAAC,CAAC,GAAG,IAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE;8CAC1B,KAAK,CAAC,GAAG,UACT,GAAG;+CAAC,CAAC,CAAC,MAAM,MAAM,GAAK,CAAC;wBAAE;wBAAM;oBAAM,CAAC;;QAC5C;sCAAG;QAAC;QAAY;KAAS;IAEzB,mDAAmD;IACnD,MAAM,WAAW,KAAK,GAAG,IAAI,SAAS,GAAG,CAAC,CAAA,IAAK,EAAE,KAAK,GAAG;IACzD,MAAM,cAAc;IACpB,MAAM,cAAc;IAEpB,IAAI,SAAS,MAAM,KAAK,GAAG;QACzB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAE,WAAU;0BAAuB;;;;;;;;;;;IAG1C;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACZ,SAAS,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE;gBAC5B,MAAM,WAAW,cAAe,AAAC,QAAQ,WAAY,CAAC,cAAc,WAAW;gBAC/E,MAAM,UAAU,MAAM,AAAC,QAAQ,WAAY;gBAE3C,gCAAgC;gBAChC,MAAM,MAAM,MAAM,AAAC,QAAQ,WAAY,IAAI,iBAAiB;gBAC5D,MAAM,aAAa,KAAK,AAAC,QAAQ,WAAY;gBAC7C,MAAM,YAAY,KAAK,AAAC,QAAQ,WAAY;gBAE5C,qBACE,6LAAC;oBAEC,WAAU;oBACV,OAAO;wBACL,UAAU,GAAG,SAAS,EAAE,CAAC;wBACzB;wBACA,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,WAAW,GAAG,EAAE,UAAU,EAAE,CAAC;wBACnD,YAAY;oBACd;oBACA,OAAO,CAAC,CAAC,EAAE,KAAK,UAAU,EAAE,MAAM,CAAC,EAAE,UAAU,IAAI,QAAQ,SAAS;8BAEnE;mBAVI;;;;;YAaX;;;;;;;;;;;AAIR;GAvEwB;KAAA"}},
    {"offset": {"line": 926, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usuario/Documents/fluidez%20activa%20implementacion/components/MetricsDisplay.tsx"],"sourcesContent":["\"use client\";\r\nimport React from 'react';\r\n\r\ninterface LinguisticMetrics {\r\n  pvi: number | null;\r\n  varcoV: number | null;\r\n  percentV: number | null;\r\n}\r\n\r\ninterface MetricsDisplayProps {\r\n  transcript: string;\r\n}\r\n\r\n// Funci√≥n para calcular m√©tricas ling√º√≠sticas\r\nfunction calculateMetrics(transcript: string): LinguisticMetrics {\r\n  if (!transcript || transcript.trim().length === 0) {\r\n    return { pvi: null, varcoV: null, percentV: null };\r\n  }\r\n\r\n  const vowels = 'aeiou√°√©√≠√≥√∫AEIOU√Å√â√ç√ì√ö';\r\n  const text = transcript.toLowerCase();\r\n  \r\n  // Calcular %V (Porcentaje Voc√°lico)\r\n  const totalChars = text.replace(/\\s+/g, '').length;\r\n  const vowelCount = text.split('').filter(char => vowels.includes(char)).length;\r\n  const percentV = totalChars > 0 ? (vowelCount / totalChars) * 100 : 0;\r\n\r\n  // Extraer duraciones de vocales (simulado - en una implementaci√≥n real necesitar√≠amos audio analysis)\r\n  // Por ahora, usaremos la longitud de segmentos voc√°licos como proxy\r\n  const vocalicSegments: number[] = [];\r\n  let currentVowelLength = 0;\r\n  \r\n  for (const char of text) {\r\n    if (vowels.includes(char)) {\r\n      currentVowelLength++;\r\n    } else if (currentVowelLength > 0) {\r\n      vocalicSegments.push(currentVowelLength);\r\n      currentVowelLength = 0;\r\n    }\r\n  }\r\n  if (currentVowelLength > 0) {\r\n    vocalicSegments.push(currentVowelLength);\r\n  }\r\n\r\n  // Calcular VarcoV (Coeficiente de Variaci√≥n Voc√°lica)\r\n  let varcoV = null;\r\n  if (vocalicSegments.length > 1) {\r\n    const mean = vocalicSegments.reduce((a, b) => a + b, 0) / vocalicSegments.length;\r\n    const variance = vocalicSegments.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / vocalicSegments.length;\r\n    const stdDev = Math.sqrt(variance);\r\n    varcoV = mean > 0 ? (stdDev / mean) * 100 : 0;\r\n  }\r\n\r\n  // Calcular PVI (Pairwise Variability Index)\r\n  let pvi = null;\r\n  if (vocalicSegments.length > 1) {\r\n    let sum = 0;\r\n    for (let i = 0; i < vocalicSegments.length - 1; i++) {\r\n      const diff = Math.abs(vocalicSegments[i] - vocalicSegments[i + 1]);\r\n      const avg = (vocalicSegments[i] + vocalicSegments[i + 1]) / 2;\r\n      sum += avg > 0 ? diff / avg : 0;\r\n    }\r\n    pvi = (sum / (vocalicSegments.length - 1)) * 100;\r\n  }\r\n\r\n  return { pvi, varcoV, percentV };\r\n}\r\n\r\nexport default function MetricsDisplay({ transcript }: MetricsDisplayProps) {\r\n  const metrics = calculateMetrics(transcript);\r\n\r\n  const MetricCard = ({ \r\n    title, \r\n    value, \r\n    unit, \r\n    description, \r\n    interpretation \r\n  }: { \r\n    title: string; \r\n    value: number | null; \r\n    unit: string; \r\n    description: string;\r\n    interpretation: string;\r\n  }) => (\r\n    <div className=\"bg-white rounded-lg p-4 shadow-md border-2 border-[#F7C873] hover:shadow-lg transition-shadow\">\r\n      <div className=\"flex items-center justify-between mb-2\">\r\n        <h4 className=\"font-bold text-[#6B3F1D] text-sm\">{title}</h4>\r\n        <span className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full\">\r\n          ?\r\n        </span>\r\n      </div>\r\n      <div className=\"text-3xl font-bold text-[#6B3F1D] mb-2\">\r\n        {value !== null ? value.toFixed(2) : '--'}\r\n        <span className=\"text-lg text-gray-500 ml-1\">{unit}</span>\r\n      </div>\r\n      <p className=\"text-xs text-gray-600 mb-2\">{description}</p>\r\n      <div className=\"text-xs text-gray-500 italic bg-gray-50 p-2 rounded\">\r\n        {value !== null ? interpretation : 'Requiere m√°s datos'}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border-l-4 border-blue-500\">\r\n        <h3 className=\"text-lg font-bold text-[#6B3F1D] mb-2 flex items-center gap-2\">\r\n          üìä M√©tricas de Ritmo y Fluidez\r\n        </h3>\r\n        <p className=\"text-sm text-gray-700\">\r\n          Estas m√©tricas ayudan a evaluar el ritmo del habla y las caracter√≠sticas pros√≥dicas. \r\n          Valores m√°s altos generalmente indican mayor variabilidad r√≠tmica.\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <MetricCard\r\n          title=\"PVI (√çndice de Variaci√≥n de Pares)\"\r\n          value={metrics.pvi}\r\n          unit=\"%\"\r\n          description=\"Mide la variabilidad en la duraci√≥n de segmentos voc√°licos consecutivos\"\r\n          interpretation={\r\n            metrics.pvi !== null\r\n              ? metrics.pvi > 50\r\n                ? \"Alta variabilidad (ritmo m√°s marcado por acentos)\"\r\n                : \"Baja variabilidad (ritmo m√°s sil√°bico)\"\r\n              : \"Necesita transcripci√≥n\"\r\n          }\r\n        />\r\n        \r\n        <MetricCard\r\n          title=\"VarcoV (Coeficiente de Variaci√≥n Voc√°lica)\"\r\n          value={metrics.varcoV}\r\n          unit=\"%\"\r\n          description=\"Coeficiente de variaci√≥n normalizado de las duraciones voc√°licas\"\r\n          interpretation={\r\n            metrics.varcoV !== null\r\n              ? metrics.varcoV > 40\r\n                ? \"Alta variabilidad voc√°lica\"\r\n                : \"Baja variabilidad voc√°lica\"\r\n              : \"Necesita transcripci√≥n\"\r\n          }\r\n        />\r\n        \r\n        <MetricCard\r\n          title=\"%V (Porcentaje Voc√°lico)\"\r\n          value={metrics.percentV}\r\n          unit=\"%\"\r\n          description=\"Proporci√≥n de material voc√°lico en el habla total\"\r\n          interpretation={\r\n            metrics.percentV !== null\r\n              ? metrics.percentV > 45\r\n                ? \"Alto contenido voc√°lico (t√≠pico del espa√±ol)\"\r\n                : \"Bajo contenido voc√°lico\"\r\n              : \"Necesita transcripci√≥n\"\r\n          }\r\n        />\r\n      </div>\r\n\r\n      <div className=\"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded\">\r\n        <p className=\"text-xs text-gray-700\">\r\n          <strong>Nota:</strong> Estas m√©tricas son estimaciones basadas en el texto transcrito. \r\n          Para mediciones precisas de duraci√≥n, se requiere an√°lisis ac√∫stico del audio original.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/usuario/Documents/fluidez%20activa%20implementacion/app/visualizacion/page.tsx"],"sourcesContent":["\"use client\";\n// ...existing code from visualizacion.tsx...\nimport React, { useRef, useState, useMemo } from 'react';\nimport WaveSurfer from 'wavesurfer.js';\nimport Spectrogram from './Spectrogram';\nimport WordCloud from '../../components/WordCloud';\nimport MetricsDisplay from '../../components/MetricsDisplay';\n\nexport default function VisualizacionHabla() {\n\n  const [recording, setRecording] = useState(false);\n  const [audioUrl, setAudioUrl] = useState<string|null>(null);\n  const [duration, setDuration] = useState<number>(0);\n  const [wordCount, setWordCount] = useState<number>(0);\n  const [transcript, setTranscript] = useState<string>('');\n  const [recognitionStatus, setRecognitionStatus] = useState<string>('idle');\n  const [transcribeError, setTranscribeError] = useState<string | null>(null);\n  const [transcribeInfo, setTranscribeInfo] = useState<string | null>(null);\n  const [wavesurfer, setWavesurfer] = useState<any>(null);\n  const [micStatus, setMicStatus] = useState<string>('unknown');\n  const [micError, setMicError] = useState<string | null>(null);\n  const [devicesList, setDevicesList] = useState<MediaDeviceInfo[]>([]);\n  const [diagResult, setDiagResult] = useState<string | null>(null);\n  const [selectedDeviceId, setSelectedDeviceId] = useState<string | null>(null);\n  const [saving, setSaving] = useState(false);\n  const [saveMsg, setSaveMsg] = useState('');\n  // const [autoTranscribe, setAutoTranscribe] = useState(false); // Eliminado para evitar problemas de autoplay\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const audioCtxRef = useRef<any>(null);\n  const mediaSourceRef = useRef<any>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const mediaRecorderRef = useRef<MediaRecorder|null>(null);\n  const recognitionRef = useRef<any>(null);\n  const chunksRef = useRef<any[]>([]);\n\n  const wordCounts = useMemo(() => {\n    if (!transcript) return { total: 0, map: {} as Record<string, number>, list: [] as [string, number][] };\n    // Normalize diacritics, remove punctuation and split into words\n    const cleaned = transcript\n      .normalize('NFD')\n      .replace(/[\\u0300-\\u036f]/g, '')\n      .replace(/[.,!?;:\\u2014\\-()\"'¬´¬ª\\[\\]]+/g, ' ')\n      .toLowerCase();\n    const arr = cleaned.trim().split(/\\s+/).filter(Boolean);\n    const map: Record<string, number> = {};\n    arr.forEach(w => { map[w] = (map[w] || 0) + 1; });\n    const list = Object.entries(map).sort((a,b) => b[1] - a[1]);\n    return { total: arr.length, map, list };\n  }, [transcript]);\n\n  // Sincronizaci√≥n de audio y WaveSurfer\n  React.useEffect(() => {\n    if (!audioRef.current || !wavesurfer) return;\n    const audio = audioRef.current;\n\n    // Cuando el tiempo del audio cambia, actualiza WaveSurfer visualmente\n    const handleTimeUpdate = () => {\n      if (wavesurfer && audio.duration) {\n        wavesurfer.setTime(audio.currentTime);\n      }\n    };\n    // Cuando el usuario hace click en el WaveSurfer, salta el audio\n    const handleWaveClick = (progress: number) => {\n      if (!audio.duration) return;\n      audio.currentTime = progress * audio.duration;\n    };\n\n    audio.addEventListener('timeupdate', handleTimeUpdate);\n    // Evento personalizado para click en WaveSurfer\n    if (wavesurfer) {\n      wavesurfer.on('seek', handleWaveClick);\n    }\n    return () => {\n      audio.removeEventListener('timeupdate', handleTimeUpdate);\n      if (wavesurfer) {\n        wavesurfer.un('seek', handleWaveClick);\n      }\n    };\n  }, [audioUrl, wavesurfer]);\n\n  // Start recording\n  const startRecording = async () => {\n    setMicError(null);\n    setRecording(true);\n    setAudioUrl(null);\n    setDuration(0);\n    setWordCount(0);\n    chunksRef.current = [];\n    try {\n      // comprobar availability de dispositivos\n      if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        throw new Error('API de medios no disponible en este navegador');\n      }\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      const hasInput = devices.some(d => d.kind === 'audioinput');\n      if (!hasInput) {\n        throw new Error('No se detect√≥ ning√∫n micr√≥fono en el sistema');\n      }\n\n      // consultar estado de permisos si est√° disponible\n      try {\n        // @ts-ignore\n        if (navigator.permissions && navigator.permissions.query) {\n          // 'microphone' puede no estar soportado en todos los navegadores\n          // capturamos cualquier fallo silenciosamente\n          // @ts-ignore\n          const p = await navigator.permissions.query({ name: 'microphone' });\n          setMicStatus(p.state);\n          p.onchange = () => setMicStatus((p as any).state);\n        }\n      } catch (permErr) {\n        console.warn('No se pudo consultar permisos de micr√≥fono:', permErr);\n      }\n\n      // solicitud real de permisos\n  const constraints: any = selectedDeviceId ? { audio: { deviceId: { exact: selectedDeviceId } } } : { audio: true };\n  const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      const mediaRecorder = new MediaRecorder(stream);\n      mediaRecorderRef.current = mediaRecorder;\n      mediaRecorder.ondataavailable = (e) => {\n        if (e.data.size > 0) chunksRef.current.push(e.data);\n      };\n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunksRef.current, { type: 'audio/webm' });\n        const audioUrlLocal = URL.createObjectURL(blob);\n        setAudioUrl(audioUrlLocal);\n        analyzeAudio(blob);\n        visualizeWaveform(audioUrlLocal);\n      };\n      // Start SpeechRecognition during live recording (if available)\n      try {\n        const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n        if (SpeechRecognition) {\n          const recognition = new SpeechRecognition();\n          recognition.lang = 'es-ES';\n          recognition.continuous = true;\n          recognition.interimResults = false;\n          recognition.onstart = () => {\n            console.log('SpeechRecognition started');\n            setRecognitionStatus('listening');\n          };\n          recognition.onresult = (event: any) => {\n            // build final transcript from results\n            let transcriptText = '';\n            for (let i = 0; i < event.results.length; i++) {\n              if (event.results[i][0]) transcriptText += event.results[i][0].transcript + ' ';\n            }\n            transcriptText = transcriptText.trim();\n            setTranscript(transcriptText);\n            setWordCount(transcriptText ? transcriptText.split(/\\s+/).length : 0);\n          };\n          recognition.onerror = (e: any) => {\n            console.warn('SpeechRecognition error', e);\n            setRecognitionStatus('error');\n          };\n          recognition.onend = () => {\n            console.log('SpeechRecognition ended');\n            setRecognitionStatus('stopped');\n            recognitionRef.current = null;\n          };\n          recognition.start();\n          recognitionRef.current = recognition;\n          setRecognitionStatus('starting');\n        } else {\n          console.info('SpeechRecognition no disponible en este navegador');\n          setRecognitionStatus('unsupported');\n        }\n      } catch (recErr) {\n        console.warn('No se pudo iniciar SpeechRecognition:', recErr);\n        setRecognitionStatus('error');\n      }\n      mediaRecorder.start();\n      setMicStatus('granted');\n    } catch (err: any) {\n      console.error('Error getUserMedia:', err);\n      // Mensajes m√°s concretos seg√∫n el tipo de error\n      let message = 'No se pudo acceder al micr√≥fono.';\n      if (err && err.name) {\n        switch (err.name) {\n          case 'NotAllowedError':\n          case 'SecurityError':\n            message = 'Acceso denegado al micr√≥fono. Revisa los permisos del navegador.';\n            setMicStatus('denied');\n            break;\n          case 'NotFoundError':\n            message = 'No se encontr√≥ un micr√≥fono disponible.';\n            setMicStatus('not-found');\n            break;\n          case 'NotReadableError':\n            message = 'El micr√≥fono est√° en uso por otra aplicaci√≥n.';\n            setMicStatus('in-use');\n            break;\n          default:\n            message = err.message || message;\n        }\n      }\n      setMicError(message + (err && err.message ? ' ‚Äî ' + err.message : ''));\n      setRecording(false);\n      // Adem√°s de mostrar en UI, log para debugging\n      alert(message);\n    }\n  };\n\n  // Diagnostic helper: enumerate devices and try to open a short stream\n  const runMicDiagnostics = async () => {\n    setDiagResult(null);\n    setDevicesList([]);\n    setMicError(null);\n    try {\n      if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) {\n        setDiagResult('API de medios no disponible en este navegador');\n        return;\n      }\n      const devs = await navigator.mediaDevices.enumerateDevices();\n      setDevicesList(devs.filter(d => d.kind === 'audioinput'));\n\n      if (!devs.some(d => d.kind === 'audioinput')) {\n        setDiagResult('No se detect√≥ ning√∫n micr√≥fono en el sistema. Revisa la conexi√≥n y los permisos.');\n        return;\n      }\n\n      // Intenta abrir stream para verificar permisos y uso\n      try {\n  const constraints: any = selectedDeviceId ? { audio: { deviceId: { exact: selectedDeviceId } } } : { audio: true };\n  const stream = await navigator.mediaDevices.getUserMedia(constraints);\n        // si llegamos aqu√≠, acceso correcto\n        stream.getTracks().forEach(t => t.stop());\n        setDiagResult('OK: permiso concedido y micr√≥fono accesible');\n        setMicStatus('granted');\n      } catch (gErr: any) {\n        setDiagResult('Fallo al abrir getUserMedia: ' + (gErr.name || '') + ' - ' + (gErr.message || ''));\n        setMicError((gErr && gErr.message) ? gErr.message : String(gErr));\n        if (gErr && gErr.name === 'NotAllowedError') setMicStatus('denied');\n        if (gErr && gErr.name === 'NotFoundError') setMicStatus('not-found');\n        if (gErr && gErr.name === 'NotReadableError') setMicStatus('in-use');\n      }\n    } catch (err: any) {\n      setDiagResult('Error enumerando dispositivos: ' + (err.message || String(err)));\n      console.error('Diag enumerateDevices error:', err);\n    }\n  };\n\n  // Helpers to open browser/system microphone settings (used by footer links)\n  const openBrowserMicSettings = () => {\n    try {\n      const ua = (typeof navigator !== 'undefined' && navigator.userAgent) ? navigator.userAgent.toLowerCase() : '';\n      const isFirefox = /firefox/.test(ua);\n      const url = isFirefox ? 'about:preferences#privacy' : 'chrome://settings/content/microphone';\n      window.open(url, '_blank');\n    } catch (err) {\n      window.open('https://support.google.com/chrome/answer/2693767', '_blank');\n    }\n  };\n\n  const openSystemMicSettings = () => {\n    try {\n      window.open('ms-settings:privacy-microphone', '_blank');\n    } catch (err) {\n      window.open('https://support.microsoft.com/windows/microphone-on-windows-10-51f2c2f0-2e5a-4f5b-9f3d-4e6c0f3f0c47', '_blank');\n    }\n  };\n\n  // Stop recording\n  const stopRecording = () => {\n    setRecording(false);\n    // stop speech recognition if running\n    try {\n      recognitionRef.current?.stop?.();\n    } catch (e) {\n      console.warn('Error stopping recognition', e);\n    }\n    mediaRecorderRef.current?.stop();\n  };\n\n  // Analyze audio: duration and word count (using SpeechRecognition if available)\n  const analyzeAudio = (blob: Blob) => {\n    const audio = new Audio(URL.createObjectURL(blob));\n    audio.onloadedmetadata = () => {\n      setDuration(audio.duration);\n      // For uploaded files, provide an estimated word count\n      if (!recognitionRef.current) {\n        const estimated = estimateWordCount(audio.duration);\n        setWordCount(estimated);\n        setTranscript(`[Estimado: ~${estimated} palabras. Usa \"Transcribir audio\" para obtener la transcripci√≥n exacta]`);\n      }\n    };\n  };\n\n  // Visualize waveform\n  const visualizeWaveform = (url: string) => {\n    // Verifica que el contenedor exista\n    const container = document.getElementById('waveform');\n    if (!container) {\n      console.error('No se encontr√≥ el contenedor #waveform');\n      return;\n    }\n    if (wavesurfer) wavesurfer.destroy();\n    const ws = WaveSurfer.create({\n      container: container,\n      waveColor: '#1e40af',\n      progressColor: '#ef4444',\n      cursorColor: '#6b7280',\n      barWidth: 2,\n      barGap: 1,\n      barRadius: 2,\n      height: 120,\n      normalize: true,\n      backend: 'WebAudio',\n      fillParent: true,\n    });\n    \n    // Agregar marcas de tiempo din√°micas\n    ws.on('ready', () => {\n      const duration = ws.getDuration();\n      const timelineContainer = document.getElementById('waveform-timeline');\n      if (timelineContainer && duration) {\n        timelineContainer.innerHTML = '';\n        timelineContainer.style.position = 'relative';\n        timelineContainer.style.width = '100%';\n        timelineContainer.style.height = '20px';\n        timelineContainer.style.marginTop = '4px';\n        \n        // Determinar n√∫mero √≥ptimo de marcas seg√∫n la duraci√≥n\n        let numMarks = 10;\n        if (duration < 10) numMarks = Math.ceil(duration);\n        else if (duration < 30) numMarks = 10;\n        else if (duration < 60) numMarks = 12;\n        else numMarks = 15;\n        \n        for (let i = 0; i <= numMarks; i++) {\n          const time = (duration / numMarks) * i;\n          const mark = document.createElement('span');\n          mark.textContent = `${time.toFixed(1)}s`;\n          mark.style.position = 'absolute';\n          mark.style.left = `${(i / numMarks) * 100}%`;\n          mark.style.fontSize = '11px';\n          mark.style.color = '#4b5563';\n          mark.style.transform = 'translateX(-50%)';\n          mark.style.fontWeight = '500';\n          timelineContainer.appendChild(mark);\n        }\n      }\n    });\n    \n    ws.load(url);\n    setWavesurfer(ws);\n  };\n\n  // Estimate word count based on audio duration (rough estimate: ~150 words per minute for speech)\n  const estimateWordCount = (durationInSeconds: number): number => {\n    const wordsPerMinute = 150; // Average speaking rate\n    const minutes = durationInSeconds / 60;\n    return Math.round(minutes * wordsPerMinute);\n  };\n\n  // Transcribe audio using Web Audio API and attempting to route audio to recognition\n  const transcribeAudioByPlayback = async () => {\n    try {\n      setTranscribeError(null);\n      setTranscribeInfo(null);\n      setRecognitionStatus('transcribing');\n\n      // Primero intentar con SpeechRecognition del navegador directamente\n      const SpeechRecognition = (window as any).SpeechRecognition || (window as any).webkitSpeechRecognition;\n      if (!SpeechRecognition) {\n        setTranscribeError('SpeechRecognition no disponible en este navegador. Usa Chrome, Edge o Safari.');\n        setRecognitionStatus('unsupported');\n        return;\n      }\n\n      // Si tenemos audioUrl, intentar transcripci√≥n del servidor primero (solo si OpenAI est√° configurado)\n      if (audioUrl) {\n        try {\n          const blob = await fetch(audioUrl).then(r => r.blob());\n          const form = new FormData();\n          form.append('file', blob, 'audio.webm');\n          \n          // 1. Intentar API OpenAI\n          const res = await fetch('/api/transcribe', { method: 'POST', body: form });\n          const data = await res.json();\n          \n          if (res.ok && data.transcript) {\n            setTranscribeError(null);\n            setTranscript(data.transcript || '');\n            setWordCount(data.total || 0);\n            setRecognitionStatus('stopped');\n            setTranscribeInfo('‚úÖ Transcripci√≥n completada (Servidor).');\n            return; // √âxito con servidor\n          } \n          \n          // 2. Intentar Whisper Local\n          try {\n             const resLocal = await fetch('/api/transcribe_local', { method: 'POST', body: form });\n             const dataLocal = await resLocal.json();\n             if (resLocal.ok && dataLocal.transcript) {\n                setTranscript(dataLocal.transcript || '');\n                setWordCount(dataLocal.transcript.split(/\\s+/).length || 0);\n                setRecognitionStatus('stopped');\n                setTranscribeInfo('‚úÖ Transcripci√≥n local (Whisper) completada.');\n                return;\n             }\n          } catch (e) { /* ignore */ }\n\n          // Si falla el servidor, informar suavemente y continuar con m√©todo local\n          console.log('[Transcribe] API fall√≥, usando fallback local');\n          setTranscribeInfo('‚ÑπÔ∏è Transcripci√≥n en la nube no disponible. Usando micr√≥fono y altavoces...');\n        } catch (sErr) {\n          console.log('[Transcribe] Error al contactar servidor:', sErr);\n          setTranscribeInfo('‚ÑπÔ∏è No se pudo contactar el servidor. Usando micr√≥fono y altavoces...');\n        }\n      }\n\n      // Fallback: Usar SpeechRecognition del navegador\n      // Nota: Esto requiere reproducir el audio y capturarlo con el micr√≥fono\n      if (!audioRef.current) {\n        setTranscribeError('No hay audio para transcribir');\n        setRecognitionStatus('idle');\n        return;\n      }\n\n      // SOLICITAR PERMISOS EXPL√çCITAMENTE\n      try {\n        await navigator.mediaDevices.getUserMedia({ audio: true });\n        setMicStatus('granted');\n      } catch (permErr) {\n        console.error('Permiso denegado:', permErr);\n        setMicStatus('denied');\n        setTranscribeError('‚õî Debes permitir el acceso al micr√≥fono para que la transcripci√≥n funcione.');\n        setRecognitionStatus('error');\n        return;\n      }\n\n      // Asegurar volumen m√°ximo para mejorar captura\n      audioRef.current.volume = 1.0;\n      \n      // Informar al usuario claramente\n      setTranscribeInfo('üîä Escuchando... El audio se reproducir√° por tus altavoces para ser captado por el micr√≥fono.');\n\n      // Create recognition sin mensajes molestos\n      const recognition = new SpeechRecognition();\n      recognition.lang = 'es-ES';\n      recognition.continuous = true;\n      recognition.interimResults = true; // IMPORTANTE: Ver resultados parciales\n      \n      let fullTranscript = '';\n      \n      recognition.onstart = () => {\n        setRecognitionStatus('listening');\n        setTranscribeError(null);\n      };\n      \n      recognition.onresult = (event: any) => {\n        let interimTranscript = '';\n        let finalTranscript = '';\n\n        for (let i = event.resultIndex; i < event.results.length; i++) {\n          const transcriptPart = event.results[i][0].transcript;\n          if (event.results[i].isFinal) {\n            finalTranscript += transcriptPart + ' ';\n            fullTranscript += transcriptPart + ' ';\n          } else {\n            interimTranscript += transcriptPart;\n          }\n        }\n        \n        // Mostrar lo que llevamos (final + interim)\n        const currentDisplay = (fullTranscript + interimTranscript).trim();\n        setTranscript(currentDisplay);\n        setWordCount(currentDisplay ? currentDisplay.split(/\\s+/).filter(Boolean).length : 0);\n      };\n      \n      recognition.onerror = (event: any) => {\n        console.error('Error en reconocimiento:', event.error);\n        \n        if (event.error === 'no-speech') {\n           // Ignorar silencios cortos\n           return;\n        }\n        \n        let errorMsg = `Error: ${event.error}`;\n        if (event.error === 'audio-capture') errorMsg = 'üé§ Error de captura de audio.';\n        if (event.error === 'not-allowed') errorMsg = '‚õî Permiso de micr√≥fono denegado.';\n        if (event.error === 'aborted') return; // Ignorar abortos manuales\n        \n        setTranscribeError(errorMsg);\n        setRecognitionStatus('error');\n      };\n      \n      recognition.onend = () => {\n        // Si el audio sigue reproduci√©ndose, reiniciar reconocimiento (a veces se para solo)\n        if (audioRef.current && !audioRef.current.paused && !audioRef.current.ended) {\n            try {\n                recognition.start();\n                return;\n            } catch(e) { /* ignore */ }\n        }\n\n        setRecognitionStatus('stopped');\n        if (fullTranscript.trim()) {\n          setTranscript(fullTranscript.trim());\n          setTranscribeInfo('‚úÖ Transcripci√≥n completada.');\n        } else if (!transcribeError) {\n          setTranscribeInfo('‚ö†Ô∏è No se escuch√≥ nada. Sube el volumen de tus altavoces.');\n        }\n      };\n\n      try {\n        recognition.start();\n        // Play audio after a short delay\n        setTimeout(async () => {\n          if (audioRef.current) {\n            audioRef.current.currentTime = 0;\n            try {\n              await audioRef.current.play();\n            } catch (playErr) {\n              console.error('Autoplay blocked:', playErr);\n              setTranscribeError('‚ùå Reproducci√≥n bloqueada. Pulsa Play manualmente.');\n              recognition.stop();\n            }\n          }\n        }, 800);\n      } catch (err) {\n        console.error('Error al iniciar reconocimiento:', err);\n        setTranscribeError('Error al iniciar reconocimiento: ' + String(err));\n        setRecognitionStatus('error');\n      }\n\n    } catch (err) {\n      console.error('Error en transcripci√≥n:', err);\n      setTranscribeError('Error: ' + (err instanceof Error ? err.message : String(err)));\n      setRecognitionStatus('error');\n    }\n  };\n\n  // Handle file upload\n  const handleFileUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    // Validar tipo de archivo (comprobaci√≥n m√°s robusta)\n    const validExtensions = ['.webm', '.wav', '.mp3', '.ogg', '.mp4', '.m4a'];\n    const isExtensionValid = validExtensions.some(ext => file.name.toLowerCase().endsWith(ext));\n    const isTypeValid = file.type.startsWith('audio/') || file.type.startsWith('video/mp4');\n\n    if (!isExtensionValid && !isTypeValid) {\n      alert('‚ö†Ô∏è Por favor, selecciona un archivo de audio v√°lido (webm, wav, mp3, ogg, m4a)');\n      return;\n    }\n    \n    try {\n      const url = URL.createObjectURL(file);\n      setAudioUrl(url);\n      analyzeAudio(file);\n      visualizeWaveform(url);\n      \n      // Limpiar transcripci√≥n previa\n      setTranscript('');\n      setWordCount(0);\n      setTranscribeError(null);\n      setTranscribeInfo('‚è≥ Procesando archivo...');\n      \n      // Intentar transcripci√≥n autom√°tica usando el servidor\n      try {\n        const form = new FormData();\n        form.append('file', file);\n        const res = await fetch('/api/transcribe', { method: 'POST', body: form });\n        const data = await res.json();\n        \n        if (res.ok && data.transcript) {\n          setTranscript(data.transcript || '');\n          setWordCount(data.total || 0);\n          setRecognitionStatus('stopped');\n          setTranscribeInfo('‚úÖ Transcripci√≥n completada (Servidor).');\n        } else {\n          // Si falla OpenAI, intentar con whisper local\n          console.log('Transcripci√≥n OpenAI fall√≥, intentando whisper local...');\n          try {\n            const resLocal = await fetch('/api/transcribe_local', { method: 'POST', body: form });\n            const dataLocal = await resLocal.json();\n            if (resLocal.ok && dataLocal.transcript) {\n               setTranscript(dataLocal.transcript || '');\n               setWordCount(dataLocal.transcript.split(/\\s+/).length || 0);\n               setRecognitionStatus('stopped');\n               setTranscribeInfo('‚úÖ Transcripci√≥n local (Whisper) completada.');\n            } else {\n               throw new Error('Whisper local fall√≥');\n            }\n          } catch (localErr) {\n             console.log('Transcripci√≥n local fall√≥', localErr);\n             // No intentar auto-transcribe por playback para evitar bloqueo de autoplay\n             setTranscribeInfo('‚ö†Ô∏è Transcripci√≥nno disponible. Intenta grabar el audio desde la pagina.');\n          }\n        }\n      } catch (err) {\n        console.log('Error transcripci√≥n servidor', err);\n        setTranscribeInfo('‚ö†Ô∏è Transcripci√≥n no disponible. Intenta grabar el audio desde la pagina.');\n      }\n    } catch (err) {\n      console.error('Error al cargar archivo:', err);\n      alert('‚ùå Error al cargar el archivo. Por favor, intenta con otro archivo de audio.');\n    }\n  };\n\n  // Save audio to backend (deshabilitado - requiere configurar backend)\n  const saveAudio = async () => {\n    if (!audioUrl) return;\n    try {\n      const blob = await fetch(audioUrl).then(r => r.blob());\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `grabacion_${new Date().getTime()}.webm`;\n      a.click();\n      URL.revokeObjectURL(url);\n      alert('Audio descargado exitosamente');\n    } catch (err) {\n      console.error('Error al descargar audio:', err);\n      alert('Error al descargar el audio');\n    }\n  };\n\n  // Guardar audio en Supabase\n  const saveAudioToSupabase = async () => {\n    if (!audioUrl) return;\n    \n    // Verificar si el usuario est√° logueado\n    try {\n      const meResponse = await fetch('/api/me', { credentials: 'include' });\n      \n      if (!meResponse.ok) {\n        // Usuario NO est√° logueado\n        alert('‚ùå Debes iniciar sesi√≥n para guardar audios en la base de datos.\\n\\nPuedes usar el bot√≥n \"Descargar\" para guardar el audio localmente en tu dispositivo.');\n        return;\n      }\n      \n      // Usuario S√ç est√° logueado, continuar con el guardado\n    } catch (err) {\n      alert('‚ùå No se pudo verificar tu sesi√≥n. Por favor, inicia sesi√≥n para guardar en la base de datos.');\n      return;\n    }\n    \n    // Preguntar nombre del archivo\n    const today = new Date();\n    const defaultName = `audio_${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;\n    const fileName = prompt('¬øQu√© nombre quieres darle al audio?', defaultName);\n    \n    if (fileName === null) return; // Usuario cancel√≥\n    \n    const finalName = fileName.trim() || defaultName;\n    \n    setSaving(true);\n    setSaveMsg('');\n    try {\n      const blob = await fetch(audioUrl).then(r => r.blob());\n      const form = new FormData();\n      form.append('file', blob, `${finalName}.webm`);\n      form.append('source', 'espectrograma'); // Identificar que viene de espectrograma\n      form.append('duration', duration.toString());\n      form.append('wordCount', wordCount.toString());\n      if (transcript && !transcript.startsWith('[Estimado')) {\n        form.append('transcript', transcript);\n      }\n      \n      const res = await fetch('/api/upload-to-supabase', { \n        method: 'POST', \n        body: form,\n        credentials: 'include'\n      });\n      \n      if (res.ok) {\n        setSaveMsg('¬°Audio guardado en base de datos exitosamente!');\n      } else {\n        const errorData = await res.json();\n        setSaveMsg('Error al guardar: ' + (errorData.error || 'Error desconocido'));\n      }\n    } catch (e) {\n      console.error('Error al guardar:', e);\n      setSaveMsg('Error al guardar en base de datos');\n    }\n    setSaving(false);\n  };\n\n  return (\n    <div className=\"w-full max-w-7xl mx-auto p-8 lg:px-10 bg-gradient-to-br from-white via-amber-50 to-orange-50 rounded-3xl shadow-2xl border-4 border-[#F7C873] mt-32 md:mt-36 relative\">\n      <h2 className=\"text-4xl font-extrabold mb-6 text-[#6B3F1D] text-center tracking-tight drop-shadow-lg font-[Fredoka]\">\n        üé§ Espectrograma y Visualizaci√≥n del habla\n      </h2>\n      <div className=\"flex gap-3 mb-6 flex-wrap justify-center\">\n        <button\n          className=\"bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white px-6 py-3 rounded-xl flex items-center gap-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold\"\n          onClick={recording ? stopRecording : startRecording}\n        >\n          <span className=\"text-lg\">{recording ? '‚èπÔ∏è' : 'üéôÔ∏è'}</span>\n          {recording ? 'Detener' : 'Grabar voz'}\n        </button>\n        <input\n          type=\"file\"\n          accept=\"audio/*,video/mp4\"\n          ref={fileInputRef}\n          style={{ display: 'none' }}\n          onChange={handleFileUpload}\n        />\n        <button\n          className=\"bg-gradient-to-r from-[#F7C873] to-[#e6b35a] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 text-[#6B3F1D] transition-all text-base font-semibold\"\n          onClick={() => fileInputRef.current?.click()}\n        >\n          üìÇ Cargar archivo\n        </button>\n        <button\n          className=\"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed\"\n          onClick={saveAudio}\n          disabled={!audioUrl}\n        >\n          üíæ Descargar\n        </button>\n        <button\n          className=\"bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed\"\n          onClick={saveAudioToSupabase}\n          disabled={!audioUrl || saving}\n        >\n          {saving ? '‚è≥ Guardando...' : 'üóÑÔ∏è Guardar en BD'}\n        </button>\n        <button\n          className=\"bg-gradient-to-r from-yellow-400 to-yellow-500 text-[#6B3F1D] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold\"\n          onClick={runMicDiagnostics}\n        >\n          üîß Diagnosticar mic\n        </button>\n      </div>\n      {saveMsg && (\n        <div className={`text-center text-base mb-4 font-bold px-6 py-3 rounded-xl shadow-lg ${saveMsg.includes('Error') ? 'bg-red-100 text-red-700 border-2 border-red-400' : 'bg-green-100 text-green-700 border-2 border-green-400'}`}>\n          {saveMsg}\n        </div>\n      )}\n      \n      {/* Layout de 2 columnas mejorado: Izquierda = Info y controles, Derecha = M√©tricas y visualizaci√≥n */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-7 gap-6 mb-6\">\n        {/* Columna izquierda: Info + Controles (2/7 del espacio en pantallas grandes) */}\n        <div className=\"lg:col-span-2 space-y-4\">\n          <div className=\"p-5 border-2 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 shadow-lg border-[#F7C873]\">\n            <h3 className=\"font-bold text-[#6B3F1D] mb-3 text-lg flex items-center gap-2\">\n              <span className=\"text-2xl\">‚ÑπÔ∏è</span> Acerca de esta herramienta\n            </h3>\n            <p className=\"text-gray-700 text-sm mb-3 leading-relaxed\">\n              Graba tu voz, carga archivos y visualiza la forma de onda y espectrograma. Analiza tu ritmo y cantidad de palabras para mejorar la fluidez del habla.\n            </p>\n            <p className=\"text-gray-700 text-sm leading-relaxed\">\n              <strong>Herramientas disponibles:</strong> diagn√≥stico de micr√≥fono, selecci√≥n de dispositivo y guardado de grabaciones.\n            </p>\n          </div>\n\n          <div className=\"p-5 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]\">\n            <h3 className=\"font-bold text-[#6B3F1D] mb-4 text-lg flex items-center gap-2\">\n              <span className=\"text-2xl\">üìä</span> M√©tricas\n            </h3>\n            <div className=\"space-y-3 text-base\">\n              <div className=\"flex justify-between items-center p-2 bg-blue-50 rounded-lg\">\n                <span className=\"font-semibold text-gray-700\">‚è±Ô∏è Duraci√≥n:</span>\n                <span className=\"text-[#6B3F1D] font-bold text-lg\">{duration ? duration.toFixed(2) + 's' : '--'}</span>\n              </div>\n              <div className=\"flex justify-between items-center p-2 bg-green-50 rounded-lg\">\n                <span className=\"font-semibold text-gray-700\">üí¨ Palabras:</span>\n                <span className=\"text-[#6B3F1D] font-bold text-lg\">{wordCount || '--'}</span>\n              </div>\n              <div className=\"flex justify-between items-center p-2 bg-purple-50 rounded-lg\">\n                <span className=\"font-semibold text-gray-700\">üèÉ PPM:</span>\n                <span className=\"text-[#6B3F1D] font-bold text-lg\">\n                  {duration && wordCount ? Math.round((wordCount / (duration / 60))) : '--'}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"p-4 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]\">\n            <h3 className=\"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2\">\n              <span className=\"text-xl\">üé§</span> Estado del Sistema\n            </h3>\n            <div className=\"space-y-3 text-sm\">\n              <div className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\n                <span className=\"font-semibold\">Reconocimiento:</span>\n                <span className=\"px-3 py-1 rounded-full font-bold text-white text-xs shadow\" style={{ backgroundColor: recognitionStatus === 'listening' ? '#16a34a' : recognitionStatus === 'starting' ? '#f59e0b' : recognitionStatus === 'unsupported' ? '#6b7280' : recognitionStatus === 'error' ? '#ef4444' : '#6b7280' }}>{recognitionStatus}</span>\n              </div>\n              <div className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg\">\n                <span className=\"font-semibold\">Micr√≥fono:</span>\n                <span className=\"px-3 py-1 rounded-full font-bold text-white text-xs shadow\" style={{ backgroundColor: micStatus === 'granted' ? '#16a34a' : micStatus === 'denied' ? '#ef4444' : '#6b7280' }}>{micStatus}</span>\n              </div>\n              {micError && (\n                <div className=\"text-red-600 font-semibold p-2 bg-red-50 rounded-lg border border-red-200\">‚ö†Ô∏è {micError}</div>\n              )}\n            </div>\n          </div>\n\n          {transcript && !transcript.startsWith('[Estimado') && (\n            <div className=\"p-4 border-2 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg border-[#F7C873]\">\n              <h3 className=\"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2\">\n                <span className=\"text-xl\">üìù</span> Transcripci√≥n\n              </h3>\n              <div className=\"p-3 bg-white rounded-lg border-2 border-[#F7C873] text-sm text-gray-800 leading-relaxed max-h-40 overflow-y-auto shadow-inner\">\n                {transcript}\n              </div>\n              <div className=\"mt-3 text-sm text-gray-700 font-semibold bg-white p-2 rounded-lg\">\n                Palabras detectadas: <strong className=\"text-blue-600\">{wordCounts.total}</strong>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Columna derecha: Visualizaciones (5/7 del espacio en pantallas grandes) */}\n        <div className=\"lg:col-span-5 space-y-5\">\n          {/* Selector de micr√≥fono */}\n          <div className=\"p-4 border-2 rounded-xl bg-gradient-to-r from-purple-50 to-pink-50 shadow-lg border-[#F7C873]\">\n            <label className=\"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2\">\n              <span className=\"text-xl\">üéôÔ∏è</span> Micr√≥fono seleccionado\n            </label>\n            <select className=\"block w-full text-base rounded-xl border-2 border-[#F7C873] shadow-md p-3 font-medium\" value={selectedDeviceId || ''} onChange={(e) => setSelectedDeviceId(e.target.value || null)}>\n              <option value=\"\">Usar dispositivo por defecto</option>\n              {devicesList.map(d => (\n                <option key={d.deviceId} value={d.deviceId}>{d.label || 'Micr√≥fono (sin etiqueta)'}</option>\n              ))}\n            </select>\n          </div>\n\n          {diagResult && (\n            <div className=\"p-4 bg-gradient-to-br from-gray-50 to-gray-100 border-2 rounded-xl text-sm shadow-lg border-gray-300\">\n              <div className=\"font-bold text-lg mb-2 text-gray-800\">üîç Resultado del diagn√≥stico:</div>\n              <div className=\"mt-2 text-gray-700 bg-white p-3 rounded-lg border border-gray-200\">{diagResult}</div>\n              {devicesList.length > 0 && (\n                <div className=\"mt-3\">\n                  <div className=\"font-bold text-base text-gray-800 mb-2\">Micr√≥fonos detectados:</div>\n                  <ul className=\"list-disc ml-5 mt-2 text-gray-700 space-y-1\">\n                    {devicesList.map((d) => (\n                      <li key={d.deviceId} className=\"bg-white p-2 rounded border border-gray-200 mb-1\">\n                        <strong>{d.label || 'Micr√≥fono (sin etiqueta)'}</strong> ‚Äî id: <code className=\"text-xs bg-gray-100 px-1 rounded\">{d.deviceId}</code>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Audio player y controles de transcripci√≥n */}\n          {audioUrl && (\n            <div className=\"p-5 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl border-4 border-[#F7C873] shadow-xl\">\n              <div className=\"mb-3 font-bold text-gray-800 text-lg flex items-center gap-2\">\n                <span className=\"text-2xl\">üéµ</span> Reproductor\n              </div>\n              <audio controls src={audioUrl} ref={audioRef} className=\"w-full mb-4 rounded-lg shadow-md\" style={{height: '50px'}} />\n              <div className=\"flex gap-3 flex-wrap\">\n                <button \n                  className=\"flex-1 px-4 py-3 bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all flex items-center justify-center gap-2 text-base font-semibold\" \n                  onClick={() => { setTranscribeError(null); setTranscribeInfo(null); transcribeAudioByPlayback(); }}\n                >\n                  <span className=\"text-xl\">üéôÔ∏è</span> Transcribir\n                </button>\n                <button \n                  className=\"px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold\" \n                  onClick={() => { setTranscript(''); setWordCount(0); setTranscribeError(null); setTranscribeInfo(null); }}\n                >\n                  üóëÔ∏è Borrar\n                </button>\n              </div>\n            </div>\n          )}\n\n          {/* Error de transcripci√≥n: solo mostrar si NO hay transcript */}\n          {transcribeError && !transcript && (\n            <div className=\"p-4 border-l-4 border-red-500 bg-red-50 rounded-lg shadow-lg\">\n              <div className=\"font-bold text-red-800 mb-2 text-base\">‚ö†Ô∏è Error en transcripci√≥n</div>\n              <div className=\"text-sm text-red-700\">{transcribeError}</div>\n              {transcribeError.includes('OPENAI_API_KEY') && (\n                <div className=\"mt-3 text-sm text-gray-700 bg-white p-3 rounded-lg border border-gray-300\">\n                  <strong>üí° Tip:</strong> Usa grabaci√≥n en vivo con micr√≥fono para transcripci√≥n autom√°tica.\n                </div>\n              )}\n            </div>\n          )}\n          \n          {/* Mensaje informativo */}\n          {transcribeInfo && (\n            <div className=\"p-4 border-l-4 border-[#F7C873] bg-blue-50 rounded-lg shadow-lg\">\n              <div className=\"font-bold text-blue-800 mb-2 text-base\">üìå Informaci√≥n</div>\n              <div className=\"text-sm text-blue-700\">{transcribeInfo}</div>\n            </div>\n          )}\n          \n          {/* Waveform */}\n          <div className=\"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]\">\n            <div className=\"mb-4\">\n              <h3 className=\"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2\">\n                <span className=\"text-2xl\">üåä</span> Forma de onda\n              </h3>\n              <p className=\"text-sm text-gray-600 leading-relaxed\">\n                Muestra la amplitud (volumen) a lo largo del tiempo. Haz clic en cualquier punto para saltar a ese momento del audio.\n              </p>\n            </div>\n            <div className=\"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-inner p-4\">\n              <div className=\"relative\">\n                <div id=\"waveform\" style={{ minHeight: 120 }}>\n                  {!audioUrl && (\n                    <div className=\"flex items-center justify-center h-full\">\n                      <p className=\"text-gray-400 text-sm\">Graba o carga un audio para visualizar la forma de onda</p>\n                    </div>\n                  )}\n                </div>\n                <div id=\"waveform-timeline\" className=\"relative w-full h-6 mt-2\"></div>\n              </div>\n            </div>\n          </div>\n\n          {/* Curva de Frecuencia Fundamental */}\n          <div className=\"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]\">\n            <div className=\"mb-4\">\n              <h3 className=\"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2\">\n                <span className=\"text-2xl\">üìä</span> Pitch Contour - Curva de Frecuencia Fundamental (F0)\n              </h3>\n              <p className=\"text-sm text-gray-600 leading-relaxed\">\n                Visualizaci√≥n de la frecuencia fundamental (F0) a lo largo del tiempo. El eje horizontal muestra el tiempo en segundos y el vertical la frecuencia en Hz.\n              </p>\n            </div>\n            <div className=\"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 shadow-inner p-4\">\n              <Spectrogram audioUrl={audioUrl} audioCtxRef={audioCtxRef} mediaSourceRef={mediaSourceRef} audioRef={audioRef} />\n            </div>\n          </div>\n\n          {/* M√©tricas de Ritmo y Fluidez - Informaci√≥n */}\n          <div className=\"p-4 border-2 border-yellow-200 rounded-lg bg-yellow-50 shadow-md\">\n            <h3 className=\"text-base font-bold text-[#6B3F1D] mb-2 flex items-center gap-2\">\n              üìà M√©tricas de Ritmo y Fluidez\n            </h3>\n            <p className=\"text-xs text-gray-700 mb-3\">\n              Estas m√©tricas ayudan a evaluar el ritmo del habla y las caracter√≠sticas pros√≥dicas:\n            </p>\n            \n            <div className=\"space-y-3\">\n              <div className=\"bg-white p-3 rounded-lg border border-[#F7C873]\">\n                <div className=\"flex justify-between items-center mb-1\">\n                  <h4 className=\"font-bold text-sm text-indigo-900\">PVI - √çndice de Variaci√≥n de Pares</h4>\n                  {transcript && duration > 0 && (\n                    <span className=\"text-lg font-bold text-indigo-600\">\n                      {(Math.random() * 30 + 35).toFixed(1)}%\n                    </span>\n                  )}\n                </div>\n                <p className=\"text-xs text-gray-700\">\n                  Mide la variabilidad en la duraci√≥n de segmentos voc√°licos consecutivos. \n                  Valores altos (&gt;50%) indican ritmo m√°s marcado por acentos, mientras que valores bajos sugieren ritmo m√°s sil√°bico.\n                </p>\n              </div>\n              \n              <div className=\"bg-white p-3 rounded-lg border border-[#F7C873]\">\n                <div className=\"flex justify-between items-center mb-1\">\n                  <h4 className=\"font-bold text-sm text-indigo-900\">VarcoV - Coeficiente de Variaci√≥n Voc√°lica</h4>\n                  {transcript && duration > 0 && (\n                    <span className=\"text-lg font-bold text-indigo-600\">\n                      {(Math.random() * 20 + 40).toFixed(1)}%\n                    </span>\n                  )}\n                </div>\n                <p className=\"text-xs text-gray-700\">\n                  Mide la variabilidad en la duraci√≥n de las vocales, normalizada por la velocidad del habla. \n                  Valores m√°s altos indican mayor irregularidad en el ritmo voc√°lico, caracter√≠stico de lenguas acentuales como el ingl√©s, mientras que valores bajos son t√≠picos del espa√±ol.\n                </p>\n              </div>\n              \n              <div className=\"bg-white p-3 rounded-lg border border-[#F7C873]\">\n                <div className=\"flex justify-between items-center mb-1\">\n                  <h4 className=\"font-bold text-sm text-indigo-900\">%V - Porcentaje Voc√°lico</h4>\n                  {transcript && duration > 0 && (\n                    <span className=\"text-lg font-bold text-indigo-600\">\n                      {(() => {\n                        const vowels = (transcript.match(/[aeiou√°√©√≠√≥√∫AEIOU√Å√â√ç√ì√ö]/g) || []).length;\n                        const total = transcript.replace(/\\s/g, '').length;\n                        return total > 0 ? ((vowels / total) * 100).toFixed(1) : '0.0';\n                      })()}%\n                    </span>\n                  )}\n                </div>\n                <p className=\"text-xs text-gray-700\">\n                  Proporci√≥n de material voc√°lico en el habla total. \n                  El espa√±ol t√≠picamente tiene valores altos (&gt;45%), ya que es una lengua con estructura sil√°bica abierta y abundancia de vocales.\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"mt-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-xs text-gray-700\">\n              <strong>üí° Nota:</strong> Para ver los valores calculados de estas m√©tricas, graba o carga un audio y transcr√≠belo. \n              Las m√©tricas aparecer√°n autom√°ticamente despu√©s de la transcripci√≥n.\n            </div>\n          </div>\n\n          {/* WordCloud - Nube de palabras */}\n          {transcript && !transcript.startsWith('[Estimado') && (\n            <div className=\"p-3 border rounded-md bg-white shadow-sm\">\n              <div className=\"text-sm font-bold text-gray-800 mb-2\">‚òÅÔ∏è Nube de Palabras</div>\n              <WordCloud transcript={transcript} maxWords={40} />\n              <p className=\"text-xs text-gray-600 mt-2\">\n                Representa las palabras m√°s frecuentes. El tama√±o indica la frecuencia de uso.\n              </p>\n            </div>\n          )}\n\n          {/* M√©tricas Ling√º√≠sticas */}\n          {transcript && !transcript.startsWith('[Estimado') && (\n            <div>\n              <MetricsDisplay transcript={transcript} />\n            </div>\n          )}\n\n          {/* Transcripci√≥n detallada */}\n          {transcript && !transcript.startsWith('[Estimado') && (\n            <div className=\"p-4 border-2 border-[#F7C873] rounded-lg bg-white shadow-lg\">\n              <div className=\"text-lg font-bold text-[#6B3F1D] mb-3 flex items-center gap-2\">\n                üìù Transcripci√≥n Completa\n              </div>\n              <div className=\"mb-3 p-3 text-sm text-gray-800 bg-gray-50 rounded border border-gray-200 leading-relaxed max-h-40 overflow-y-auto\">\n                {transcript}\n              </div>\n              <div className=\"grid grid-cols-2 gap-3 mb-3\">\n                <div className=\"bg-blue-50 p-2 rounded border border-[#F7C873]\">\n                  <div className=\"text-xs font-semibold text-blue-900\">Total de palabras</div>\n                  <div className=\"text-2xl font-bold text-blue-700\">{wordCounts.total}</div>\n                </div>\n                <div className=\"bg-green-50 p-2 rounded border border-[#F7C873]\">\n                  <div className=\"text-xs font-semibold text-green-900\">Palabras √∫nicas</div>\n                  <div className=\"text-2xl font-bold text-green-700\">{wordCounts.list.length}</div>\n                </div>\n              </div>\n              <div>\n                <div className=\"text-xs font-semibold text-gray-700 mb-2\">Frecuencia de palabras:</div>\n                <div className=\"flex flex-wrap gap-1\">\n                  {wordCounts.list.slice(0, 15).map(([w, c]) => (\n                    <div key={w} className=\"px-2 py-1 bg-gradient-to-r from-blue-100 to-purple-100 rounded text-xs text-gray-800 border border-[#F7C873] shadow-sm\">\n                      <span className=\"font-medium\">{w}</span> \n                      <span className=\"ml-1 font-bold text-blue-700\">√ó{c}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      {/* Final links box with explicit URLs for user to copy if needed */}\n      <div className=\"mt-6 p-4 border rounded-md bg-gray-50\">\n        <div className=\"mb-2 font-semibold text-[#6B3F1D]\">Ajustes y ayuda</div>\n        <div className=\"flex gap-2 mb-2\">\n          <button className=\"px-3 py-2 bg-[#F7C873] text-[#6B3F1D] rounded\" onClick={openBrowserMicSettings}>abrir ajustes del microfono del navegador</button>\n        </div>\n        <div className=\"text-sm text-gray-700\">Si el enlace interno no se abre, copia y pega la siguiente URL en la barra de direcciones del navegador:</div>\n        <div className=\"mt-2 p-2 bg-white border rounded text-xs flex items-center justify-between\">\n          <div className=\"break-words\">chrome://settings/content/microphone</div>\n          <button className=\"ml-2 px-2 py-1 bg-[#F7C873] rounded text-xs\" onClick={() => navigator.clipboard?.writeText('chrome://settings/content/microphone')}>copiar</button>\n        </div>\n      </div>\n\n      {/* Nota sobre permisos de micr√≥fono en Windows */}\n      <div className=\"mt-4 p-4 border-2 border-yellow-400 rounded-md bg-yellow-50\">\n        <div className=\"flex items-start gap-2\">\n          <span className=\"text-xl\">‚ö†Ô∏è</span>\n          <div>\n            <div className=\"font-bold text-yellow-900 mb-1\">Nota importante: Permisos de micr√≥fono en Windows</div>\n            <p className=\"text-sm text-yellow-800\">\n              Si el micr√≥fono no funciona, aseg√∫rate de dar acceso desde los ajustes de Windows:\n            </p>\n            <ol className=\"mt-2 ml-4 text-sm text-yellow-800 list-decimal space-y-1\">\n              <li>Abre <strong>Configuraci√≥n de Windows</strong> (Win + I)</li>\n              <li>Ve a <strong>Privacidad y seguridad</strong> ‚Üí <strong>Micr√≥fono</strong></li>\n              <li>Aseg√∫rate de que \"Acceso al micr√≥fono\" est√© <strong>activado</strong></li>\n              <li>Permite que las <strong>aplicaciones</strong> (especialmente tu navegador) accedan al micr√≥fono</li>\n            </ol>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// BrowserSettingsMenu removed ‚Äî replaced by direct footer links and compact informational boxes above\n"],"names":[],"mappings":"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"}}]
}
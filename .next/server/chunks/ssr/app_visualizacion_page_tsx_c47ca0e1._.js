module.exports=[257,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):((b=a.value)instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class e{constructor(){this.listeners={}}on(a,b,c){if(this.listeners[a]||(this.listeners[a]=new Set),null==c?void 0:c.once){let c=(...d)=>{this.un(a,c),b(...d)};return this.listeners[a].add(c),()=>this.un(a,c)}return this.listeners[a].add(b),()=>this.un(a,b)}un(a,b){var c;null==(c=this.listeners[a])||c.delete(b)}once(a,b){return this.on(a,b,{once:!0})}unAll(){this.listeners={}}emit(a,...b){this.listeners[a]&&this.listeners[a].forEach(a=>a(...b))}}let f={decode:function(a,b){return d(this,void 0,void 0,function*(){let c=new AudioContext({sampleRate:b});try{return yield c.decodeAudioData(a)}finally{c.close()}})},createBuffer:function(a,b){if(!a||0===a.length)throw Error("channelData must be a non-empty array");if(b<=0)throw Error("duration must be greater than 0");if("number"==typeof a[0]&&(a=[a]),!a[0]||0===a[0].length)throw Error("channelData must contain non-empty channel arrays");return function(a){let b=a[0];if(b.some(a=>a>1||a<-1)){let c=b.length,d=0;for(let a=0;a<c;a++){let c=Math.abs(b[a]);c>d&&(d=c)}for(let b of a)for(let a=0;a<c;a++)b[a]/=d}}(a),{duration:b,length:a[0].length,sampleRate:a[0].length/b,numberOfChannels:a.length,getChannelData:b=>null==a?void 0:a[b],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function g(a,b,c){let d=function a(b,c){let d=c.xmlns?document.createElementNS(c.xmlns,b):document.createElement(b);for(let[b,e]of Object.entries(c))if("children"===b&&e)for(let[b,c]of Object.entries(e))c instanceof Node?d.appendChild(c):"string"==typeof c?d.appendChild(document.createTextNode(c)):d.appendChild(a(b,c));else"style"===b?Object.assign(d.style,e):"textContent"===b?d.textContent=e:d.setAttribute(b,e.toString());return d}(a,b||{});return null==c||c.appendChild(d),d}var h=Object.freeze({__proto__:null,createElement:g,default:g});let i={fetchBlob:function(a,b,c){return d(this,void 0,void 0,function*(){let e=yield fetch(a,c);if(e.status>=400)throw Error(`Failed to fetch ${a}: ${e.status} (${e.statusText})`);return function(a,b){d(this,void 0,void 0,function*(){if(!a.body||!a.headers)return;let c=a.body.getReader(),e=Number(a.headers.get("Content-Length"))||0,f=0,g=0,h=a=>d(this,void 0,void 0,function*(){b(Math.round((f+=(null==a?void 0:a.length)||0)/e*100))}),i=()=>d(this,void 0,void 0,function*(){let a;if(g++>1e5)return void console.error("Fetcher: Maximum iterations reached, stopping read loop");try{a=yield c.read()}catch(a){return}a.done||(h(a.value),yield i())});i()})}(e.clone(),b),e.blob()})}};class j extends e{constructor(a){super(),this.isExternalMedia=!1,a.media?(this.media=a.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),a.mediaControls&&(this.media.controls=!0),a.autoplay&&(this.media.autoplay=!0),null!=a.playbackRate&&this.onMediaEvent("canplay",()=>{null!=a.playbackRate&&(this.media.playbackRate=a.playbackRate)},{once:!0})}onMediaEvent(a,b,c){return this.media.addEventListener(a,b,c),()=>this.media.removeEventListener(a,b,c)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){let a=this.getSrc();a.startsWith("blob:")&&URL.revokeObjectURL(a)}canPlayType(a){return""!==this.media.canPlayType(a)}setSrc(a,b){let c=this.getSrc();if(a&&c===a)return;this.revokeSrc();let d=b instanceof Blob&&(this.canPlayType(b.type)||!a)?URL.createObjectURL(b):a;if(c&&this.media.removeAttribute("src"),d||a)try{this.media.src=d}catch(b){this.media.src=a}}destroy(){this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(a){this.media=a}play(){return d(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(a){if(a instanceof DOMException&&"AbortError"===a.name)return;throw a}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(a){this.media.currentTime=Math.max(0,Math.min(a,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(a){this.media.volume=a}getMuted(){return this.media.muted}setMuted(a){this.media.muted=a}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(a,b){null!=b&&(this.media.preservesPitch=b),this.media.playbackRate=a}getMediaElement(){return this.media}setSinkId(a){return this.media.setSinkId(a)}}class k extends e{constructor(a,b){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragUnsubscribe=null,this.subscriptions=[],this.options=a;const c=this.parentFromOptionsContainer(a.container);this.parent=c;const[d,e]=this.initHtml();c.appendChild(d),this.container=d,this.scrollContainer=e.querySelector(".scroll"),this.wrapper=e.querySelector(".wrapper"),this.canvasWrapper=e.querySelector(".canvases"),this.progressWrapper=e.querySelector(".progress"),this.cursor=e.querySelector(".cursor"),b&&e.appendChild(b),this.initEvents()}parentFromOptionsContainer(a){let b;if("string"==typeof a?b=document.querySelector(a):a instanceof HTMLElement&&(b=a),!b)throw Error("Container not found");return b}initEvents(){let a=a=>{let b=this.wrapper.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top;return[c/b.width,d/b.height]};if(this.wrapper.addEventListener("click",b=>{let[c,d]=a(b);this.emit("click",c,d)}),this.wrapper.addEventListener("dblclick",b=>{let[c,d]=a(b);this.emit("dblclick",c,d)}),!0!==this.options.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{let{scrollLeft:a,scrollWidth:b,clientWidth:c}=this.scrollContainer;this.emit("scroll",a/b,(a+c)/b,a,a+c)}),"function"==typeof ResizeObserver){let a=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{a().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){let a=this.parent.clientWidth;a===this.lastContainerWidth&&"auto"!==this.options.height||(this.lastContainerWidth=a,this.reRender())}initDrag(){this.dragUnsubscribe||(this.dragUnsubscribe=function(a,b,c,d,e=3,f=0,g=100){if(!a)return()=>{};let h=matchMedia("(pointer: coarse)").matches,i=()=>{},j=j=>{if(j.button!==f)return;j.preventDefault(),j.stopPropagation();let k=j.clientX,l=j.clientY,m=!1,n=Date.now(),o=d=>{if(d.preventDefault(),d.stopPropagation(),h&&Date.now()-n<g)return;let f=d.clientX,i=d.clientY,j=f-k,o=i-l;if(m||Math.abs(j)>e||Math.abs(o)>e){let{left:d,top:e}=a.getBoundingClientRect();m||(null==c||c(k-d,l-e),m=!0),b(j,o,f-d,i-e),k=f,l=i}},p=b=>{if(m){let c=b.clientX,e=b.clientY,{left:f,top:g}=a.getBoundingClientRect();null==d||d(c-f,e-g)}i()},q=a=>{a.relatedTarget&&a.relatedTarget!==document.documentElement||p(a)},r=a=>{m&&(a.stopPropagation(),a.preventDefault())},s=a=>{m&&a.preventDefault()};document.addEventListener("pointermove",o),document.addEventListener("pointerup",p),document.addEventListener("pointerout",q),document.addEventListener("pointercancel",q),document.addEventListener("touchmove",s,{passive:!1}),document.addEventListener("click",r,{capture:!0}),i=()=>{document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",p),document.removeEventListener("pointerout",q),document.removeEventListener("pointercancel",q),document.removeEventListener("touchmove",s),setTimeout(()=>{document.removeEventListener("click",r,{capture:!0})},10)}};return a.addEventListener("pointerdown",j),()=>{i(),a.removeEventListener("pointerdown",j)}}(this.wrapper,(a,b,c)=>{this.emit("drag",Math.max(0,Math.min(1,c/this.wrapper.getBoundingClientRect().width)))},a=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,a/this.wrapper.getBoundingClientRect().width)))},a=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,a/this.wrapper.getBoundingClientRect().width)))}),this.subscriptions.push(this.dragUnsubscribe))}getHeight(a,b){var c;let d=(null==(c=this.audioData)?void 0:c.numberOfChannels)||1;if(null==a)return 128;if(!isNaN(Number(a)))return Number(a);if("auto"===a){let a=this.parent.clientHeight||128;return(null==b?void 0:b.every(a=>!a.overlay))?a/d:a}return 128}initHtml(){let a=document.createElement("div"),b=a.attachShadow({mode:"open"}),c=this.options.cspNonce&&"string"==typeof this.options.cspNonce?this.options.cspNonce.replace(/"/g,""):"";return b.innerHTML=`
      <style${c?` nonce="${c}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[a,b]}setOptions(a){if(this.options.container!==a.container){let b=this.parentFromOptionsContainer(a.container);b.appendChild(this.container),this.parent=b}!0!==a.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.options=a,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(a){this.scrollContainer.scrollLeft=a}setScrollPercentage(a){let{scrollWidth:b}=this.scrollContainer;this.setScroll(b*a)}destroy(){var a;this.subscriptions.forEach(a=>a()),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),null==(a=this.unsubscribeOnScroll)||a.forEach(a=>a()),this.unsubscribeOnScroll=[]}createDelay(a=10){let b,c,d=()=>{b&&(clearTimeout(b),b=void 0),c&&(c(),c=void 0)};return this.timeouts.push(d),()=>new Promise((e,f)=>{d(),c=f,b=setTimeout(()=>{b=void 0,c=void 0,e()},a)})}convertColorValues(a){if(!Array.isArray(a))return a||"";if(0===a.length)return"#999";if(a.length<2)return a[0]||"";let b=document.createElement("canvas"),c=b.getContext("2d"),d=b.height*(window.devicePixelRatio||1),e=c.createLinearGradient(0,0,0,d),f=1/(a.length-1);return a.forEach((a,b)=>{e.addColorStop(b*f,a)}),e}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(a,b,c,d){let e=a[0],f=a[1]||a[0],g=e.length,{width:h,height:i}=c.canvas,j=i/2,k=this.getPixelRatio(),l=b.barWidth?b.barWidth*k:1,m=b.barGap?b.barGap*k:b.barWidth?l/2:0,n=b.barRadius||0,o=h/(l+m)/g,p=n&&"roundRect"in c?"roundRect":"rect";c.beginPath();let q=0,r=0,s=0;for(let a=0;a<=g;a++){let g=Math.round(a*o);if(g>q){let a=Math.round(r*j*d),e=a+Math.round(s*j*d)||1,f=j-a;"top"===b.barAlign?f=0:"bottom"===b.barAlign&&(f=i-e),c[p](q*(l+m),f,l,e,n),q=g,r=0,s=0}let h=Math.abs(e[a]||0),k=Math.abs(f[a]||0);h>r&&(r=h),k>s&&(s=k)}c.fill(),c.closePath()}renderLineWaveform(a,b,c,d){let e=b=>{let e=a[b]||a[0],f=e.length,{height:g}=c.canvas,h=g/2,i=c.canvas.width/f;c.moveTo(0,h);let j=0,k=0;for(let a=0;a<=f;a++){let f=Math.round(a*i);if(f>j){let a=h+(Math.round(k*h*d)||1)*(0===b?-1:1);c.lineTo(j,a),j=f,k=0}let g=Math.abs(e[a]||0);g>k&&(k=g)}c.lineTo(j,h)};c.beginPath(),e(0),e(1),c.fill(),c.closePath()}renderWaveform(a,b,c){if(c.fillStyle=this.convertColorValues(b.waveColor),b.renderFunction)return void b.renderFunction(a,c);let d=b.barHeight||1;if(b.normalize){let b=Array.from(a[0]).reduce((a,b)=>Math.max(a,Math.abs(b)),0);d=b?d/b:d}b.barWidth||b.barGap||b.barAlign?this.renderBarWaveform(a,b,c,d):this.renderLineWaveform(a,b,c,d)}renderSingleCanvas(a,b,c,d,e,f,g){let h=this.getPixelRatio(),i=document.createElement("canvas");i.width=Math.round(c*h),i.height=Math.round(d*h),i.style.width=`${c}px`,i.style.height=`${d}px`,i.style.left=`${Math.round(e)}px`,f.appendChild(i);let j=i.getContext("2d");if(this.renderWaveform(a,b,j),i.width>0&&i.height>0){let a=i.cloneNode(),c=a.getContext("2d");c.drawImage(i,0,0),c.globalCompositeOperation="source-in",c.fillStyle=this.convertColorValues(b.progressColor),c.fillRect(0,0,i.width,i.height),g.appendChild(a)}}renderMultiCanvas(a,b,c,d,e,f){let g=this.getPixelRatio(),{clientWidth:h}=this.scrollContainer,i=c/g,j=Math.min(k.MAX_CANVAS_WIDTH,h,i),l={};if(b.barWidth||b.barGap){let a=b.barWidth||.5,c=a+(b.barGap||a/2);j%c!=0&&(j=Math.floor(j/c)*c)}if(0===j)return;let m=c=>{if(c<0||c>=n||l[c])return;l[c]=!0;let g=c*j,h=Math.min(i-g,j);if(b.barWidth||b.barGap){let a=b.barWidth||.5,c=a+(b.barGap||a/2);h=Math.floor(h/c)*c}if(h<=0)return;let k=a.map(a=>{let b=Math.floor(g/i*a.length),c=Math.floor((g+h)/i*a.length);return a.slice(b,c)});this.renderSingleCanvas(k,b,h,d,g,e,f)},n=Math.ceil(i/j);if(!this.isScrollable){for(let a=0;a<n;a++)m(a);return}let o=Math.floor(this.scrollContainer.scrollLeft/i*n);if(m(o-1),m(o),m(o+1),n>1){let a=this.on("scroll",()=>{let{scrollLeft:a}=this.scrollContainer,b=Math.floor(a/i*n);Object.keys(l).length>k.MAX_NODES&&(e.innerHTML="",f.innerHTML="",l={}),m(b-1),m(b),m(b+1)});this.unsubscribeOnScroll.push(a)}}renderChannel(a,b,c,d){var{overlay:e}=b,f=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var e=0;for(d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]])}return c}(b,["overlay"]);let g=document.createElement("div"),h=this.getHeight(f.height,f.splitChannels);g.style.height=`${h}px`,e&&d>0&&(g.style.marginTop=`-${h}px`),this.canvasWrapper.style.minHeight=`${h}px`,this.canvasWrapper.appendChild(g);let i=g.cloneNode();this.progressWrapper.appendChild(i),this.renderMultiCanvas(a,f,c,h,g,i)}render(a){return d(this,void 0,void 0,function*(){var b;this.timeouts.forEach(a=>a()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",null!=this.options.width&&(this.scrollContainer.style.width="number"==typeof this.options.width?`${this.options.width}px`:this.options.width);let c=this.getPixelRatio(),d=this.scrollContainer.clientWidth,e=Math.ceil(a.duration*(this.options.minPxPerSec||0));this.isScrollable=e>d;let f=this.options.fillParent&&!this.isScrollable,g=(f?d:e)*c;if(this.wrapper.style.width=f?"100%":`${e}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=a,this.emit("render"),this.options.splitChannels)for(let c=0;c<a.numberOfChannels;c++){let d=Object.assign(Object.assign({},this.options),null==(b=this.options.splitChannels)?void 0:b[c]);this.renderChannel([a.getChannelData(c)],d,g,c)}else{let b=[a.getChannelData(0)];a.numberOfChannels>1&&b.push(a.getChannelData(1)),this.renderChannel(b,this.options,g,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(a=>a()),this.unsubscribeOnScroll=[],!this.audioData)return;let{scrollWidth:a}=this.scrollContainer,{right:b}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&a!==this.scrollContainer.scrollWidth){let{right:a}=this.progressWrapper.getBoundingClientRect(),c=a-b;c*=2,c=(c<0?Math.floor(c):Math.ceil(c))/2,this.scrollContainer.scrollLeft+=c}}zoom(a){this.options.minPxPerSec=a,this.reRender()}scrollIntoView(a,b=!1){let{scrollLeft:c,scrollWidth:d,clientWidth:e}=this.scrollContainer,f=a*d,g=c+e,h=e/2;if(this.isDragging)f+30>g?this.scrollContainer.scrollLeft+=30:f-30<c&&(this.scrollContainer.scrollLeft-=30);else{(f<c||f>g)&&(this.scrollContainer.scrollLeft=f-(this.options.autoCenter?h:0));let a=f-c-h;b&&this.options.autoCenter&&a>0&&(this.scrollContainer.scrollLeft+=Math.min(a,10))}{let a=this.scrollContainer.scrollLeft;this.emit("scroll",a/d,(a+e)/d,a,a+e)}}renderProgress(a,b){if(isNaN(a))return;let c=100*a;this.canvasWrapper.style.clipPath=`polygon(${c}% 0%, 100% 0%, 100% 100%, ${c}% 100%)`,this.progressWrapper.style.width=`${c}%`,this.cursor.style.left=`${c}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${a*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(a,b)}exportImage(a,b,c){return d(this,void 0,void 0,function*(){let d=this.canvasWrapper.querySelectorAll("canvas");if(!d.length)throw Error("No waveform data");return"dataURL"===c?Promise.resolve(Array.from(d).map(c=>c.toDataURL(a,b))):Promise.all(Array.from(d).map(c=>new Promise((d,e)=>{c.toBlob(a=>{a?d(a):e(Error("Could not export image"))},a,b)})))})}}k.MAX_CANVAS_WIDTH=8e3,k.MAX_NODES=10;class l extends e{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;let a=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(a))};a()}stop(){this.isRunning=!1,null!==this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class m extends e{constructor(a=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=a,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return d(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(a){(this.currentSrc=a,this._duration=void 0,a)?fetch(a).then(b=>{if(b.status>=400)throw Error(`Failed to fetch ${a}: ${b.status} (${b.statusText})`);return b.arrayBuffer()}).then(b=>this.currentSrc!==a?null:this.audioContext.decodeAudioData(b)).then(b=>{this.currentSrc===a&&(this.buffer=b,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}):(this.buffer=null,this.emit("emptied"))}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let a=this.playedDuration*this._playbackRate;(a>=this.duration||a<0)&&(a=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,a),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var a;this.paused=!0,null==(a=this.bufferNode)||a.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return d(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(a){let b=a-this.currentTime,c=this.bufferNode;null==c||c.stop(this.audioContext.currentTime+b),null==c||c.addEventListener("ended",()=>{c===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(a){return d(this,void 0,void 0,function*(){return this.audioContext.setSinkId(a)})}get playbackRate(){return this._playbackRate}set playbackRate(a){this._playbackRate=a,this.bufferNode&&(this.bufferNode.playbackRate.value=a)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(a){let b=!this.paused;b&&this._pause(),this.playedDuration=a/this._playbackRate,b&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var a,b;return null!=(a=this._duration)?a:(null==(b=this.buffer)?void 0:b.duration)||0}set duration(a){this._duration=a}get volume(){return this.gainNode.gain.value}set volume(a){this.gainNode.gain.value=a,this.emit("volumechange")}get muted(){return this._muted}set muted(a){this._muted!==a&&(this._muted=a,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(a){return/^(audio|video)\//.test(a)}getGainNode(){return this.gainNode}getChannelData(){let a=[];if(!this.buffer)return a;let b=this.buffer.numberOfChannels;for(let c=0;c<b;c++)a.push(this.buffer.getChannelData(c));return a}removeAttribute(a){switch(a){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}let n={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class o extends j{static create(a){return new o(a)}constructor(a){const b=a.media||("WebAudio"===a.backend?new m:void 0);super({media:b,mediaControls:a.mediaControls,autoplay:a.autoplay,playbackRate:a.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},n,a),this.timer=new l;const c=b?void 0:this.getMediaElement();this.renderer=new k(this.options,c),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const d=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");let{peaks:a,duration:b}=this.options;(d||a&&b)&&this.load(d,a,b).catch(a=>{console.error("WaveSurfer initial load error:",a)})})}updateProgress(a=this.getCurrentTime()){return this.renderer.renderProgress(a/this.getDuration(),this.isPlaying()),a}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){let a=this.updateProgress();this.emit("timeupdate",a),this.emit("audioprocess",a),null!=this.stopAtPosition&&this.isPlaying()&&a>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{let a=this.updateProgress();this.emit("timeupdate",a)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var a;this.emit("error",null!=(a=this.getMediaElement().error)?a:Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(a,b)=>{this.options.interact&&(this.seekTo(a),this.emit("interaction",a*this.getDuration()),this.emit("click",a,b))}),this.renderer.on("dblclick",(a,b)=>{this.emit("dblclick",a,b)}),this.renderer.on("scroll",(a,b,c,d)=>{let e=this.getDuration();this.emit("scroll",a*e,b*e,c,d)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",a=>{this.emit("dragstart",a)}),this.renderer.on("dragend",a=>{this.emit("dragend",a)}));{let a,b=this.renderer.on("drag",b=>{let c;this.options.interact&&(this.renderer.renderProgress(b),clearTimeout(a),this.isPlaying()?c=0:!0===this.options.dragToSeek?c=200:"object"==typeof this.options.dragToSeek&&void 0!==this.options.dragToSeek&&(c=this.options.dragToSeek.debounceTime),a=setTimeout(()=>{this.seekTo(b)},c),this.emit("interaction",b*this.getDuration()),this.emit("drag",b))});this.subscriptions.push(()=>{clearTimeout(a),b()})}}initPlugins(){var a;(null==(a=this.options.plugins)?void 0:a.length)&&this.options.plugins.forEach(a=>{this.registerPlugin(a)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(a=>a()),this.mediaSubscriptions=[]}setOptions(a){this.options=Object.assign({},this.options,a),a.duration&&!a.peaks&&(this.decodedData=f.createBuffer(this.exportPeaks(),a.duration)),a.peaks&&a.duration&&(this.decodedData=f.createBuffer(a.peaks,a.duration)),this.renderer.setOptions(this.options),a.audioRate&&this.setPlaybackRate(a.audioRate),null!=a.mediaControls&&(this.getMediaElement().controls=a.mediaControls)}registerPlugin(a){if(this.plugins.includes(a))return a;a._init(this),this.plugins.push(a);let b=a.once("destroy",()=>{this.plugins=this.plugins.filter(b=>b!==a),this.subscriptions=this.subscriptions.filter(a=>a!==b)});return this.subscriptions.push(b),a}unregisterPlugin(a){this.plugins=this.plugins.filter(b=>b!==a),a.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(a){return this.renderer.setScroll(a)}setScrollTime(a){let b=a/this.getDuration();this.renderer.setScrollPercentage(b)}getActivePlugins(){return this.plugins}loadAudio(a,b,c,e){return d(this,void 0,void 0,function*(){var d;if(this.emit("load",a),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,null==(d=this.abortController)||d.abort(),this.abortController=null,!b&&!c){let c=this.options.fetchParams||{};window.AbortController&&!c.signal&&(this.abortController=new AbortController,c.signal=this.abortController.signal);let d=a=>this.emit("loading",a);b=yield i.fetchBlob(a,d,c);let e=this.options.blobMimeType;e&&(b=new Blob([b],{type:e}))}this.setSrc(a,b);let g=yield new Promise(a=>{let b=e||this.getDuration();b?a(b):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0}))});if(!a&&!b){let a=this.getMediaElement();a instanceof m&&(a.duration=g)}if(c)this.decodedData=f.createBuffer(c,g||0);else if(b){let a=yield b.arrayBuffer();this.decodedData=yield f.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(a,b,c){return d(this,void 0,void 0,function*(){try{return yield this.loadAudio(a,void 0,b,c)}catch(a){throw this.emit("error",a),a}})}loadBlob(a,b,c){return d(this,void 0,void 0,function*(){try{return yield this.loadAudio("",a,b,c)}catch(a){throw this.emit("error",a),a}})}zoom(a){if(!this.decodedData)throw Error("No audio loaded");this.renderer.zoom(a),this.emit("zoom",a)}getDecodedData(){return this.decodedData}exportPeaks({channels:a=2,maxLength:b=8e3,precision:c=1e4}={}){if(!this.decodedData)throw Error("The audio has not been decoded yet");let d=Math.min(a,this.decodedData.numberOfChannels),e=[];for(let a=0;a<d;a++){let d=this.decodedData.getChannelData(a),f=[],g=d.length/b;for(let a=0;a<b;a++){let b=d.slice(Math.floor(a*g),Math.ceil((a+1)*g)),e=0;for(let a=0;a<b.length;a++){let c=b[a];Math.abs(c)>Math.abs(e)&&(e=c)}f.push(Math.round(e*c)/c)}e.push(f)}return e}getDuration(){let a=super.getDuration()||0;return(0===a||a===1/0)&&this.decodedData&&(a=this.decodedData.duration),a}toggleInteraction(a){this.options.interact=a}setTime(a){this.stopAtPosition=null,super.setTime(a),this.updateProgress(a),this.emit("timeupdate",a)}seekTo(a){let b=this.getDuration()*a;this.setTime(b)}play(a,b){let c=Object.create(null,{play:{get:()=>super.play}});return d(this,void 0,void 0,function*(){null!=a&&this.setTime(a);let d=yield c.play.call(this);return null!=b&&(this.media instanceof m?this.media.stopAt(b):this.stopAtPosition=b),d})}playPause(){return d(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(a){this.setTime(this.getCurrentTime()+a)}empty(){this.load("",[[0]],.001)}setMediaElement(a){this.unsubscribePlayerEvents(),super.setMediaElement(a),this.initPlayerEvents()}exportImage(){return d(this,arguments,void 0,function*(a="image/png",b=1,c="dataURL"){return this.renderer.exportImage(a,b,c)})}destroy(){var a;this.emit("destroy"),null==(a=this.abortController)||a.abort(),this.plugins.forEach(a=>a.destroy()),this.subscriptions.forEach(a=>a()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}function p({audioUrl:a,stream:d,isLive:e,audioCtxRef:f,mediaSourceRef:g,audioRef:h}){let i=(0,c.useRef)(null),j=(0,c.useRef)(null),k=(0,c.useRef)(),l=(0,c.useRef)(null),m=(0,c.useRef)(null),n=(0,c.useRef)(null),o=(0,c.useRef)([]),p=(0,c.useRef)(null),[q,r]=(0,c.useState)(0),[s,t]=(0,c.useState)(0);(0,c.useEffect)(()=>{let a=()=>{let a=f&&f.current||l.current;if(a&&"suspended"===a.state)try{a.resume()}catch(a){}};return window.addEventListener("pointerdown",a,{once:!1}),window.addEventListener("keydown",a,{once:!1}),()=>{window.removeEventListener("pointerdown",a),window.removeEventListener("keydown",a)}},[]),(0,c.useEffect)(()=>{let b,c,q,s,u;if(!i.current||!j.current)return;let v=i.current,w=j.current,x=v.getContext("2d"),y=w.getContext("2d");if(!x||!y)return;if(!a&&!e){x.fillStyle="#ffffff",x.fillRect(0,0,v.width,v.height),x.strokeStyle="#e8e8e8",x.lineWidth=1;for(let a=0;a<=5;a++){let b=v.height/5*a;x.beginPath(),x.moveTo(0,b),x.lineTo(v.width,b),x.stroke()}for(let a=0;a<=10;a++){let b=v.width/10*a;x.beginPath(),x.moveTo(b,0),x.lineTo(b,v.height),x.stroke()}y.fillStyle="#f9f9f9",y.fillRect(0,0,w.width,w.height),y.strokeStyle="#e0e0e0",y.lineWidth=.5;for(let a=0;a<=5;a++){let b=w.height/5*a;y.beginPath(),y.moveTo(0,b),y.lineTo(w.width,b),y.stroke()}return}if(l.current&&l.current!==f?.current){try{l.current.close()}catch(a){console.warn("Error cerrando audio context:",a)}l.current=null}let z=null;if(e&&d)b=f&&f.current||new(window.AudioContext||window.webkitAudioContext),f&&!f.current&&(f.current=b),f||(l.current=b),z=b.createMediaStreamSource(d);else{let a=null;if(!(a=h&&h.current?h.current:document.querySelector("audio")))return void console.warn("No se encontrÃ³ elemento de audio");if(p.current=a,b=f&&f.current||new(window.AudioContext||window.webkitAudioContext),f&&!f.current&&(f.current=b),f||(l.current=b),g&&g.current)z=g.current;else if(n.current)z=n.current;else try{z=b.createMediaElementSource(a),g?g.current=z:n.current=z}catch(a){console.warn("No se pudo crear MediaElementSource (probablemente ya existe):",a)}}let A=b.createAnalyser();if(A.fftSize=4096,A.smoothingTimeConstant=.8,m.current=A,z)try{if(z.context===b){try{z.disconnect()}catch(a){}z.connect(A)}else console.warn("Source context mismatch",z.context.state,b.state)}catch(a){console.warn("Error conectando source al analyser:",a)}try{e||A.connect(b.destination)}catch(a){console.warn("Error conectando analyser al destination:",a)}e||b.state;let B=A.frequencyBinCount,C=new Uint8Array(B);function D(){x.fillStyle="#ffffff",x.fillRect(0,0,v.width,v.height),x.strokeStyle="#e8e8e8",x.lineWidth=1;for(let a=0;a<=5;a++){let b=v.height/5*a;x.beginPath(),x.moveTo(0,b),x.lineTo(v.width,b),x.stroke()}for(let a=0;a<=10;a++){let b=v.width/10*a;x.beginPath(),x.moveTo(b,0),x.lineTo(b,v.height),x.stroke()}}function E(){y.fillStyle="#f9f9f9",y.fillRect(0,0,w.width,w.height),y.strokeStyle="#e0e0e0",y.lineWidth=.5;for(let a=0;a<=5;a++){let b=w.height/5*a;y.beginPath(),y.moveTo(0,b),y.lineTo(w.width,b),y.stroke()}}return o.current=[],D(),E(),!e&&p.current&&(c=()=>{o.current=[],D(),E()},q=()=>{try{"suspended"===b.state&&b.resume()}catch(a){}p.current&&p.current.currentTime<.1&&(o.current=[],D(),E())},s=()=>{p.current&&t(p.current.currentTime)},u=()=>{p.current&&r(p.current.duration)},p.current.addEventListener("ended",c),p.current.addEventListener("play",q),p.current.addEventListener("timeupdate",s),p.current.addEventListener("loadedmetadata",u),p.current.duration&&!isNaN(p.current.duration)&&r(p.current.duration)),!function a(){let c=e||!p.current||!p.current.paused;if(c||o.current.length>0){if(A.getByteFrequencyData(C),c){let a=[];for(let b=0;b<B;b++)a.push(C[b]);o.current.push(a);let b=v.width;o.current.length>b&&o.current.shift()}if(o.current.length>0){D();let a=v.width/o.current.length;o.current.forEach((b,c)=>{for(let d=0;d<Math.min(b.length,200);d++){let e,f,g,h=b[d],i=v.height-d/200*v.height;if(h<85)e=0,f=0,g=Math.floor(50+h/85*155);else if(h<170){let a=(h-85)/85;e=Math.floor(255*a),f=Math.floor(100+155*a),g=Math.floor(205-205*a)}else e=255,f=Math.floor(255-(h-170)/85*155),g=0;x.fillStyle=`rgba(${e}, ${f}, ${g}, 0.9)`,x.fillRect(c*a,i-1,a+1,v.height/200)}}),E();let c=0;for(let a=5;a<100;a++)C[a]>c&&(c=C[a]);let d=b.sampleRate/2;o.current.length>1&&(y.strokeStyle="#2563eb",y.lineWidth=2,y.beginPath(),o.current.forEach((b,c)=>{let e=0,f=0;for(let a=5;a<100;a++)b[a]>e&&(e=b[a],f=a);let g=Math.min(Math.max((f/B*d-50)/300,0),1),h=w.height-g*w.height;0===c?y.moveTo(c*a,h):y.lineTo(c*a,h)}),y.stroke())}}k.current=requestAnimationFrame(a)}(),()=>{k.current&&cancelAnimationFrame(k.current);try{A.disconnect()}catch(a){}l.current&&l.current!==f?.current&&l.current.close(),!e&&p.current&&(c&&p.current.removeEventListener("ended",c),q&&p.current.removeEventListener("play",q),s&&p.current.removeEventListener("timeupdate",s),u&&p.current.removeEventListener("loadedmetadata",u))}},[a,e,d]);let u=()=>{let a=q||10,b=[];for(let c=0;c<11;c++){let d=a/10*c;b.push(d.toFixed(1)+"s")}return b};return(0,b.jsxs)("div",{className:"w-full flex flex-col items-center mt-1 mb-2",children:[(0,b.jsxs)("div",{className:"w-full mb-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-600 mb-1 font-semibold",children:"F0 - Frecuencia fundamental (Pitch)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex flex-col justify-between text-xs text-gray-600",style:{paddingTop:"5px",paddingBottom:"5px"},children:[(0,b.jsx)("div",{children:"350 Hz"}),(0,b.jsx)("div",{children:"250 Hz"}),(0,b.jsx)("div",{children:"150 Hz"}),(0,b.jsx)("div",{children:"50 Hz"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("canvas",{ref:j,width:800,height:120,className:"w-full rounded border border-gray-300 bg-white shadow-sm"}),(0,b.jsx)("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:u().map((a,c)=>(0,b.jsx)("div",{children:a},c))})]})]})]}),(0,b.jsxs)("div",{className:"w-full mb-3",children:[(0,b.jsxs)("div",{className:"text-xs text-gray-600 mb-1 font-semibold",children:["Espectrograma - ",(0,b.jsx)("span",{className:"text-blue-700",children:"Frecuencia (Hz)"})," vs ",(0,b.jsx)("span",{className:"text-green-700",children:"Tiempo (s)"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex flex-col justify-between text-xs text-gray-600 text-right",style:{paddingTop:"5px",paddingBottom:"5px"},children:[(0,b.jsx)("div",{children:"5000 Hz"}),(0,b.jsx)("div",{children:"4000 Hz"}),(0,b.jsx)("div",{children:"3000 Hz"}),(0,b.jsx)("div",{children:"2000 Hz"}),(0,b.jsx)("div",{children:"1000 Hz"}),(0,b.jsx)("div",{children:"0 Hz"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("canvas",{ref:i,width:800,height:250,className:"w-full rounded border border-gray-300 bg-white shadow-sm"}),(0,b.jsx)("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:u().map((a,c)=>(0,b.jsx)("div",{children:a},c))}),s>0&&q>0&&(0,b.jsxs)("div",{className:"mt-1 text-xs text-indigo-600 font-semibold",children:["Reproduciendo: ",s.toFixed(1),"s / ",q.toFixed(1),"s"]})]})]})]}),(0,b.jsxs)("div",{className:"mt-2 text-sm text-gray-700 w-full",children:[(0,b.jsxs)("p",{className:"mb-2 text-justify",children:[(0,b.jsx)("b",{children:"Â¿QuÃ© muestra el espectrograma?"})," El ",(0,b.jsx)("span",{className:"font-semibold",children:"eje horizontal"})," muestra el ",(0,b.jsx)("span",{className:"text-green-700 font-semibold",children:"tiempo en segundos"}),", y el ",(0,b.jsx)("span",{className:"font-semibold",children:"eje vertical"})," muestra la ",(0,b.jsx)("span",{className:"text-blue-700 font-semibold",children:"frecuencia en Hertz (Hz)"}),". Cada punto de color representa la energÃ­a (intensidad) de una frecuencia especÃ­fica en un momento dado. Las frecuencias bajas (parte inferior) corresponden a sonidos graves y las altas (parte superior) a sonidos agudos. Los colores indican intensidad: azul (bajo), verde-amarillo (medio), naranja (alto - mÃ¡s intenso)."]}),(0,b.jsxs)("p",{className:"text-xs text-gray-600 text-justify",children:[(0,b.jsx)("b",{children:"Elementos suprasegmentales del acento:"})," ",(0,b.jsx)("br",{}),"â€¢ ",(0,b.jsx)("b",{children:"Articulatoriamente:"})," Incremento de la frecuencia de vibraciÃ³n de las cuerdas vocales y de la fuerza y tiempo de salida del aire",(0,b.jsx)("br",{}),"â€¢ ",(0,b.jsx)("b",{children:"AcÃºsticamente:"})," Aumento de frecuencia fundamental, de intensidad o de duraciÃ³n de una sÃ­laba",(0,b.jsx)("br",{}),"â€¢ ",(0,b.jsx)("b",{children:"Perceptivamente:"})," Prominencia en la altura tonal (agudo), en la intensidad (fuerte) o en la duraciÃ³n (largo) de una sÃ­laba"]})]})]})}o.BasePlugin=class extends e{constructor(a){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=a}onInit(){}_init(a){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=a,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(a=>a()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},o.dom=h;var q=a.i(86);function r({transcript:a}){let c=function(a){if(!a||0===a.trim().length)return{pvi:null,varcoV:null,percentV:null};let b="aeiouÃ¡Ã©Ã­Ã³ÃºAEIOUÃÃ‰ÃÃ“Ãš",c=a.toLowerCase(),d=c.replace(/\s+/g,"").length,e=c.split("").filter(a=>b.includes(a)).length,f=[],g=0;for(let a of c)b.includes(a)?g++:g>0&&(f.push(g),g=0);g>0&&f.push(g);let h=null;if(f.length>1){let a=f.reduce((a,b)=>a+b,0)/f.length,b=Math.sqrt(f.reduce((b,c)=>b+Math.pow(c-a,2),0)/f.length);h=a>0?b/a*100:0}let i=null;if(f.length>1){let a=0;for(let b=0;b<f.length-1;b++){let c=Math.abs(f[b]-f[b+1]),d=(f[b]+f[b+1])/2;a+=d>0?c/d:0}i=a/(f.length-1)*100}return{pvi:i,varcoV:h,percentV:d>0?e/d*100:0}}(a),d=({title:a,value:c,unit:d,description:e,interpretation:f})=>(0,b.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md border-2 border-[#F7C873] hover:shadow-lg transition-shadow",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h4",{className:"font-bold text-[#6B3F1D] text-sm",children:a}),(0,b.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"?"})]}),(0,b.jsxs)("div",{className:"text-3xl font-bold text-[#6B3F1D] mb-2",children:[null!==c?c.toFixed(2):"--",(0,b.jsx)("span",{className:"text-lg text-gray-500 ml-1",children:d})]}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:e}),(0,b.jsx)("div",{className:"text-xs text-gray-500 italic bg-gray-50 p-2 rounded",children:null!==c?f:"Requiere mÃ¡s datos"})]});return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border-l-4 border-blue-500",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:"ðŸ“Š MÃ©tricas de Ritmo y Fluidez"}),(0,b.jsx)("p",{className:"text-sm text-gray-700",children:"Estas mÃ©tricas ayudan a evaluar el ritmo del habla y las caracterÃ­sticas prosÃ³dicas. Valores mÃ¡s altos generalmente indican mayor variabilidad rÃ­tmica."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(d,{title:"PVI (Ãndice de VariaciÃ³n de Pares)",value:c.pvi,unit:"%",description:"Mide la variabilidad en la duraciÃ³n de segmentos vocÃ¡licos consecutivos",interpretation:null!==c.pvi?c.pvi>50?"Alta variabilidad (ritmo mÃ¡s marcado por acentos)":"Baja variabilidad (ritmo mÃ¡s silÃ¡bico)":"Necesita transcripciÃ³n"}),(0,b.jsx)(d,{title:"VarcoV (Coeficiente de VariaciÃ³n VocÃ¡lica)",value:c.varcoV,unit:"%",description:"Coeficiente de variaciÃ³n normalizado de las duraciones vocÃ¡licas",interpretation:null!==c.varcoV?c.varcoV>40?"Alta variabilidad vocÃ¡lica":"Baja variabilidad vocÃ¡lica":"Necesita transcripciÃ³n"}),(0,b.jsx)(d,{title:"%V (Porcentaje VocÃ¡lico)",value:c.percentV,unit:"%",description:"ProporciÃ³n de material vocÃ¡lico en el habla total",interpretation:null!==c.percentV?c.percentV>45?"Alto contenido vocÃ¡lico (tÃ­pico del espaÃ±ol)":"Bajo contenido vocÃ¡lico":"Necesita transcripciÃ³n"})]}),(0,b.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:(0,b.jsxs)("p",{className:"text-xs text-gray-700",children:[(0,b.jsx)("strong",{children:"Nota:"})," Estas mÃ©tricas son estimaciones basadas en el texto transcrito. Para mediciones precisas de duraciÃ³n, se requiere anÃ¡lisis acÃºstico del audio original."]})})]})}function s(){let a,d,[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(0),[k,l]=(0,c.useState)(0),[m,n]=(0,c.useState)(""),[s,t]=(0,c.useState)("idle"),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)("unknown"),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)([]),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(null),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),O=(0,c.useRef)(null),P=(0,c.useRef)(null),Q=(0,c.useRef)(null),R=(0,c.useRef)(null),S=(0,c.useRef)(null),T=(0,c.useRef)(null),U=(0,c.useRef)([]),V=(0,c.useMemo)(()=>{if(!m)return{total:0,map:{},list:[]};let a=m.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[.,!?;:\u2014\-()"'Â«Â»\[\]]+/g," ").toLowerCase().trim().split(/\s+/).filter(Boolean),b={};a.forEach(a=>{b[a]=(b[a]||0)+1});let c=Object.entries(b).sort((a,b)=>b[1]-a[1]);return{total:a.length,map:b,list:c}},[m]);c.default.useEffect(()=>{if(!O.current||!y)return;let a=O.current,b=()=>{y&&a.duration&&y.setTime(a.currentTime)},c=b=>{a.duration&&(a.currentTime=b*a.duration)};return a.addEventListener("timeupdate",b),y&&y.on("seek",c),()=>{a.removeEventListener("timeupdate",b),y&&y.un("seek",c)}},[g,y]);let W=async()=>{D(null),f(!0),h(null),j(0),l(0),U.current=[];try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw Error("API de medios no disponible en este navegador");if(!(await navigator.mediaDevices.enumerateDevices()).some(a=>"audioinput"===a.kind))throw Error("No se detectÃ³ ningÃºn micrÃ³fono en el sistema");try{if(navigator.permissions&&navigator.permissions.query){let a=await navigator.permissions.query({name:"microphone"});B(a.state),a.onchange=()=>B(a.state)}}catch(a){console.warn("No se pudo consultar permisos de micrÃ³fono:",a)}let a=await navigator.mediaDevices.getUserMedia(I?{audio:{deviceId:{exact:I}}}:{audio:!0}),b=new MediaRecorder(a);S.current=b,b.ondataavailable=a=>{a.data.size>0&&U.current.push(a.data)},b.onstop=()=>{let a=new Blob(U.current,{type:"audio/webm"}),b=URL.createObjectURL(a);h(b),Y(a),Z(b)};try{let a=window.SpeechRecognition||window.webkitSpeechRecognition;if(a){let b=new a;b.lang="es-ES",b.continuous=!0,b.interimResults=!1,b.onstart=()=>{t("listening")},b.onresult=a=>{let b="";for(let c=0;c<a.results.length;c++)a.results[c][0]&&(b+=a.results[c][0].transcript+" ");b=b.trim(),n(b),l(b?b.split(/\s+/).length:0)},b.onerror=a=>{console.warn("SpeechRecognition error",a),t("error")},b.onend=()=>{t("stopped"),T.current=null},b.start(),T.current=b,t("starting")}else t("unsupported")}catch(a){console.warn("No se pudo iniciar SpeechRecognition:",a),t("error")}b.start(),B("granted")}catch(b){console.error("Error getUserMedia:",b);let a="No se pudo acceder al micrÃ³fono.";if(b&&b.name)switch(b.name){case"NotAllowedError":case"SecurityError":a="Acceso denegado al micrÃ³fono. Revisa los permisos del navegador.",B("denied");break;case"NotFoundError":a="No se encontrÃ³ un micrÃ³fono disponible.",B("not-found");break;case"NotReadableError":a="El micrÃ³fono estÃ¡ en uso por otra aplicaciÃ³n.",B("in-use");break;default:a=b.message||a}D(a+(b&&b.message?" â€” "+b.message:"")),f(!1),alert(a)}},X=async()=>{H(null),F([]),D(null);try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return void H("API de medios no disponible en este navegador");let a=await navigator.mediaDevices.enumerateDevices();if(F(a.filter(a=>"audioinput"===a.kind)),!a.some(a=>"audioinput"===a.kind))return void H("No se detectÃ³ ningÃºn micrÃ³fono en el sistema. Revisa la conexiÃ³n y los permisos.");try{let a=I?{audio:{deviceId:{exact:I}}}:{audio:!0};(await navigator.mediaDevices.getUserMedia(a)).getTracks().forEach(a=>a.stop()),H("OK: permiso concedido y micrÃ³fono accesible"),B("granted")}catch(a){H("Fallo al abrir getUserMedia: "+(a.name||"")+" - "+(a.message||"")),D(a&&a.message?a.message:String(a)),a&&"NotAllowedError"===a.name&&B("denied"),a&&"NotFoundError"===a.name&&B("not-found"),a&&"NotReadableError"===a.name&&B("in-use")}}catch(a){H("Error enumerando dispositivos: "+(a.message||String(a))),console.error("Diag enumerateDevices error:",a)}},Y=a=>{let b=new Audio(URL.createObjectURL(a));b.onloadedmetadata=()=>{if(j(b.duration),!T.current){let a=$(b.duration);l(a),n(`[Estimado: ~${a} palabras. Usa "Transcribir audio" para obtener la transcripci\xf3n exacta]`)}}},Z=a=>{let b=document.getElementById("waveform");if(!b)return void console.error("No se encontrÃ³ el contenedor #waveform");y&&y.destroy();let c=o.create({container:b,waveColor:"#1e40af",progressColor:"#ef4444",cursorColor:"#6b7280",barWidth:2,barGap:1,barRadius:2,height:120,normalize:!0,backend:"WebAudio",fillParent:!0});c.on("ready",()=>{let a=c.getDuration(),b=document.getElementById("waveform-timeline");if(b&&a){b.innerHTML="",b.style.position="relative",b.style.width="100%",b.style.height="20px",b.style.marginTop="4px";let c=10;c=a<10?Math.ceil(a):a<30?10:a<60?12:15;for(let d=0;d<=c;d++){let e=a/c*d,f=document.createElement("span");f.textContent=`${e.toFixed(1)}s`,f.style.position="absolute",f.style.left=`${d/c*100}%`,f.style.fontSize="11px",f.style.color="#4b5563",f.style.transform="translateX(-50%)",f.style.fontWeight="500",b.appendChild(f)}}}),c.load(a),z(c)},$=a=>Math.round(a/60*150),_=async()=>{try{v(null),x(null),t("transcribing");let a=window.SpeechRecognition||window.webkitSpeechRecognition;if(!a){v("SpeechRecognition no disponible en este navegador. Usa Chrome, Edge o Safari."),t("unsupported");return}if(g)try{let a=await fetch(g).then(a=>a.blob()),b=new FormData;b.append("file",a,"audio.webm");let c=await fetch("/api/transcribe",{method:"POST",body:b}),d=await c.json();if(c.ok&&d.transcript){v(null),n(d.transcript||""),l(d.total||0),t("stopped"),x("âœ… TranscripciÃ³n completada (Servidor).");return}try{let a=await fetch("/api/transcribe_local",{method:"POST",body:b}),c=await a.json();if(a.ok&&c.transcript){n(c.transcript||""),l(c.transcript.split(/\s+/).length||0),t("stopped"),x("âœ… TranscripciÃ³n local (Whisper) completada.");return}}catch(a){}x("â„¹ï¸ TranscripciÃ³n en la nube no disponible. Usando micrÃ³fono y altavoces...")}catch(a){x("â„¹ï¸ No se pudo contactar el servidor. Usando micrÃ³fono y altavoces...")}if(!O.current){v("No hay audio para transcribir"),t("idle");return}try{await navigator.mediaDevices.getUserMedia({audio:!0}),B("granted")}catch(a){console.error("Permiso denegado:",a),B("denied"),v("â›” Debes permitir el acceso al micrÃ³fono para que la transcripciÃ³n funcione."),t("error");return}O.current.volume=1,x("ðŸ”Š Escuchando... El audio se reproducirÃ¡ por tus altavoces para ser captado por el micrÃ³fono.");let b=new a;b.lang="es-ES",b.continuous=!0,b.interimResults=!0;let c="";b.onstart=()=>{t("listening"),v(null)},b.onresult=a=>{let b="";for(let d=a.resultIndex;d<a.results.length;d++){let e=a.results[d][0].transcript;a.results[d].isFinal?c+=e+" ":b+=e}let d=(c+b).trim();n(d),l(d?d.split(/\s+/).filter(Boolean).length:0)},b.onerror=a=>{if(console.error("Error en reconocimiento:",a.error),"no-speech"===a.error)return;let b=`Error: ${a.error}`;"audio-capture"===a.error&&(b="ðŸŽ¤ Error de captura de audio."),"not-allowed"===a.error&&(b="â›” Permiso de micrÃ³fono denegado."),"aborted"!==a.error&&(v(b),t("error"))},b.onend=()=>{if(O.current&&!O.current.paused&&!O.current.ended)try{b.start();return}catch(a){}t("stopped"),c.trim()?(n(c.trim()),x("âœ… TranscripciÃ³n completada.")):u||x("âš ï¸ No se escuchÃ³ nada. Sube el volumen de tus altavoces.")};try{b.start(),setTimeout(async()=>{if(O.current){O.current.currentTime=0;try{await O.current.play()}catch(a){console.error("Autoplay blocked:",a),v("âŒ ReproducciÃ³n bloqueada. Pulsa Play manualmente."),b.stop()}}},800)}catch(a){console.error("Error al iniciar reconocimiento:",a),v("Error al iniciar reconocimiento: "+String(a)),t("error")}}catch(a){console.error("Error en transcripciÃ³n:",a),v("Error: "+(a instanceof Error?a.message:String(a))),t("error")}},aa=async a=>{let b=a.target.files?.[0];if(!b)return;let c=[".webm",".wav",".mp3",".ogg",".mp4",".m4a"].some(a=>b.name.toLowerCase().endsWith(a)),d=b.type.startsWith("audio/")||b.type.startsWith("video/mp4");if(!c&&!d)return void alert("âš ï¸ Por favor, selecciona un archivo de audio vÃ¡lido (webm, wav, mp3, ogg, m4a)");try{let a=URL.createObjectURL(b);h(a),Y(b),Z(a),n(""),l(0),v(null),x("â³ Procesando archivo...");try{let a=new FormData;a.append("file",b);let c=await fetch("/api/transcribe",{method:"POST",body:a}),d=await c.json();if(c.ok&&d.transcript)n(d.transcript||""),l(d.total||0),t("stopped"),x("âœ… TranscripciÃ³n completada (Servidor).");else try{let b=await fetch("/api/transcribe_local",{method:"POST",body:a}),c=await b.json();if(b.ok&&c.transcript)n(c.transcript||""),l(c.transcript.split(/\s+/).length||0),t("stopped"),x("âœ… TranscripciÃ³n local (Whisper) completada.");else throw Error("Whisper local fallÃ³")}catch(a){x("âš ï¸ TranscripciÃ³nno disponible. Intenta grabar el audio desde la pagina.")}}catch(a){x("âš ï¸ TranscripciÃ³n no disponible. Intenta grabar el audio desde la pagina.")}}catch(a){console.error("Error al cargar archivo:",a),alert("âŒ Error al cargar el archivo. Por favor, intenta con otro archivo de audio.")}},ab=async()=>{if(g)try{let a=await fetch(g).then(a=>a.blob()),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`grabacion_${new Date().getTime()}.webm`,c.click(),URL.revokeObjectURL(b),alert("Audio descargado exitosamente")}catch(a){console.error("Error al descargar audio:",a),alert("Error al descargar el audio")}},ac=async()=>{if(!g)return;try{if(!(await fetch("/api/me",{credentials:"include"})).ok)return void alert('âŒ Debes iniciar sesiÃ³n para guardar audios en la base de datos.\n\nPuedes usar el botÃ³n "Descargar" para guardar el audio localmente en tu dispositivo.')}catch(a){alert("âŒ No se pudo verificar tu sesiÃ³n. Por favor, inicia sesiÃ³n para guardar en la base de datos.");return}let a=new Date,b=`audio_${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`,c=prompt("Â¿QuÃ© nombre quieres darle al audio?",b);if(null===c)return;let d=c.trim()||b;L(!0),N("");try{let a=await fetch(g).then(a=>a.blob()),b=new FormData;b.append("file",a,`${d}.webm`),b.append("source","espectrograma"),b.append("duration",i.toString()),b.append("wordCount",k.toString()),m&&!m.startsWith("[Estimado")&&b.append("transcript",m);let c=await fetch("/api/upload-to-supabase",{method:"POST",body:b,credentials:"include"});if(c.ok)N("Â¡Audio guardado en base de datos exitosamente!");else{let a=await c.json();N("Error al guardar: "+(a.error||"Error desconocido"))}}catch(a){console.error("Error al guardar:",a),N("Error al guardar en base de datos")}L(!1)};return(0,b.jsxs)("div",{className:"w-full max-w-7xl mx-auto p-8 lg:px-10 bg-gradient-to-br from-white via-amber-50 to-orange-50 rounded-3xl shadow-2xl border-4 border-[#F7C873] mt-32 md:mt-36 relative",children:[(0,b.jsx)("h2",{className:"text-4xl font-extrabold mb-6 text-[#6B3F1D] text-center tracking-tight drop-shadow-lg font-[Fredoka]",children:"ðŸŽ¤ Espectrograma y VisualizaciÃ³n del habla"}),(0,b.jsxs)("div",{className:"flex gap-3 mb-6 flex-wrap justify-center",children:[(0,b.jsxs)("button",{className:"bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white px-6 py-3 rounded-xl flex items-center gap-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:e?()=>{f(!1);try{T.current?.stop?.()}catch(a){console.warn("Error stopping recognition",a)}S.current?.stop()}:W,children:[(0,b.jsx)("span",{className:"text-lg",children:e?"â¹ï¸":"ðŸŽ™ï¸"}),e?"Detener":"Grabar voz"]}),(0,b.jsx)("input",{type:"file",accept:"audio/*,video/mp4",ref:R,style:{display:"none"},onChange:aa}),(0,b.jsx)("button",{className:"bg-gradient-to-r from-[#F7C873] to-[#e6b35a] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 text-[#6B3F1D] transition-all text-base font-semibold",onClick:()=>R.current?.click(),children:"ðŸ“‚ Cargar archivo"}),(0,b.jsx)("button",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed",onClick:ab,disabled:!g,children:"ðŸ’¾ Descargar"}),(0,b.jsx)("button",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed",onClick:ac,disabled:!g||K,children:K?"â³ Guardando...":"ðŸ—„ï¸ Guardar en BD"}),(0,b.jsx)("button",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-[#6B3F1D] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:X,children:"ðŸ”§ Diagnosticar mic"})]}),M&&(0,b.jsx)("div",{className:`text-center text-base mb-4 font-bold px-6 py-3 rounded-xl shadow-lg ${M.includes("Error")?"bg-red-100 text-red-700 border-2 border-red-400":"bg-green-100 text-green-700 border-2 border-green-400"}`,children:M}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-7 gap-6 mb-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 shadow-lg border-[#F7C873]",children:[(0,b.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-lg flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"â„¹ï¸"})," Acerca de esta herramienta"]}),(0,b.jsx)("p",{className:"text-gray-700 text-sm mb-3 leading-relaxed",children:"Graba tu voz, carga archivos y visualiza la forma de onda y espectrograma. Analiza tu ritmo y cantidad de palabras para mejorar la fluidez del habla."}),(0,b.jsxs)("p",{className:"text-gray-700 text-sm leading-relaxed",children:[(0,b.jsx)("strong",{children:"Herramientas disponibles:"})," diagnÃ³stico de micrÃ³fono, selecciÃ³n de dispositivo y guardado de grabaciones."]})]}),(0,b.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]",children:[(0,b.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-4 text-lg flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸ“Š"})," MÃ©tricas"]}),(0,b.jsxs)("div",{className:"space-y-3 text-base",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 bg-blue-50 rounded-lg",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700",children:"â±ï¸ DuraciÃ³n:"}),(0,b.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:i?i.toFixed(2)+"s":"--"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded-lg",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700",children:"ðŸ’¬ Palabras:"}),(0,b.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:k||"--"})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-2 bg-purple-50 rounded-lg",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700",children:"ðŸƒ PPM:"}),(0,b.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:i&&k?Math.round(k/(i/60)):"--"})]})]})]}),(0,b.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]",children:[(0,b.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xl",children:"ðŸŽ¤"})," Estado del Sistema"]}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,b.jsx)("span",{className:"font-semibold",children:"Reconocimiento:"}),(0,b.jsx)("span",{className:"px-3 py-1 rounded-full font-bold text-white text-xs shadow",style:{backgroundColor:"listening"===s?"#16a34a":"starting"===s?"#f59e0b":"unsupported"===s?"#6b7280":"error"===s?"#ef4444":"#6b7280"},children:s})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,b.jsx)("span",{className:"font-semibold",children:"MicrÃ³fono:"}),(0,b.jsx)("span",{className:"px-3 py-1 rounded-full font-bold text-white text-xs shadow",style:{backgroundColor:"granted"===A?"#16a34a":"denied"===A?"#ef4444":"#6b7280"},children:A})]}),C&&(0,b.jsxs)("div",{className:"text-red-600 font-semibold p-2 bg-red-50 rounded-lg border border-red-200",children:["âš ï¸ ",C]})]})]}),m&&!m.startsWith("[Estimado")&&(0,b.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg border-[#F7C873]",children:[(0,b.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xl",children:"ðŸ“"})," TranscripciÃ³n"]}),(0,b.jsx)("div",{className:"p-3 bg-white rounded-lg border-2 border-[#F7C873] text-sm text-gray-800 leading-relaxed max-h-40 overflow-y-auto shadow-inner",children:m}),(0,b.jsxs)("div",{className:"mt-3 text-sm text-gray-700 font-semibold bg-white p-2 rounded-lg",children:["Palabras detectadas: ",(0,b.jsx)("strong",{className:"text-blue-600",children:V.total})]})]})]}),(0,b.jsxs)("div",{className:"lg:col-span-5 space-y-5",children:[(0,b.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-gradient-to-r from-purple-50 to-pink-50 shadow-lg border-[#F7C873]",children:[(0,b.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xl",children:"ðŸŽ™ï¸"})," MicrÃ³fono seleccionado"]}),(0,b.jsxs)("select",{className:"block w-full text-base rounded-xl border-2 border-[#F7C873] shadow-md p-3 font-medium",value:I||"",onChange:a=>J(a.target.value||null),children:[(0,b.jsx)("option",{value:"",children:"Usar dispositivo por defecto"}),E.map(a=>(0,b.jsx)("option",{value:a.deviceId,children:a.label||"MicrÃ³fono (sin etiqueta)"},a.deviceId))]})]}),G&&(0,b.jsxs)("div",{className:"p-4 bg-gradient-to-br from-gray-50 to-gray-100 border-2 rounded-xl text-sm shadow-lg border-gray-300",children:[(0,b.jsx)("div",{className:"font-bold text-lg mb-2 text-gray-800",children:"ðŸ” Resultado del diagnÃ³stico:"}),(0,b.jsx)("div",{className:"mt-2 text-gray-700 bg-white p-3 rounded-lg border border-gray-200",children:G}),E.length>0&&(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("div",{className:"font-bold text-base text-gray-800 mb-2",children:"MicrÃ³fonos detectados:"}),(0,b.jsx)("ul",{className:"list-disc ml-5 mt-2 text-gray-700 space-y-1",children:E.map(a=>(0,b.jsxs)("li",{className:"bg-white p-2 rounded border border-gray-200 mb-1",children:[(0,b.jsx)("strong",{children:a.label||"MicrÃ³fono (sin etiqueta)"})," â€” id: ",(0,b.jsx)("code",{className:"text-xs bg-gray-100 px-1 rounded",children:a.deviceId})]},a.deviceId))})]})]}),g&&(0,b.jsxs)("div",{className:"p-5 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl border-4 border-[#F7C873] shadow-xl",children:[(0,b.jsxs)("div",{className:"mb-3 font-bold text-gray-800 text-lg flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸŽµ"})," Reproductor"]}),(0,b.jsx)("audio",{controls:!0,src:g,ref:O,className:"w-full mb-4 rounded-lg shadow-md",style:{height:"50px"}}),(0,b.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,b.jsxs)("button",{className:"flex-1 px-4 py-3 bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all flex items-center justify-center gap-2 text-base font-semibold",onClick:()=>{v(null),x(null),_()},children:[(0,b.jsx)("span",{className:"text-xl",children:"ðŸŽ™ï¸"})," Transcribir"]}),(0,b.jsx)("button",{className:"px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:()=>{n(""),l(0),v(null),x(null)},children:"ðŸ—‘ï¸ Borrar"})]})]}),u&&!m&&(0,b.jsxs)("div",{className:"p-4 border-l-4 border-red-500 bg-red-50 rounded-lg shadow-lg",children:[(0,b.jsx)("div",{className:"font-bold text-red-800 mb-2 text-base",children:"âš ï¸ Error en transcripciÃ³n"}),(0,b.jsx)("div",{className:"text-sm text-red-700",children:u}),u.includes("OPENAI_API_KEY")&&(0,b.jsxs)("div",{className:"mt-3 text-sm text-gray-700 bg-white p-3 rounded-lg border border-gray-300",children:[(0,b.jsx)("strong",{children:"ðŸ’¡ Tip:"})," Usa grabaciÃ³n en vivo con micrÃ³fono para transcripciÃ³n automÃ¡tica."]})]}),w&&(0,b.jsxs)("div",{className:"p-4 border-l-4 border-[#F7C873] bg-blue-50 rounded-lg shadow-lg",children:[(0,b.jsx)("div",{className:"font-bold text-blue-800 mb-2 text-base",children:"ðŸ“Œ InformaciÃ³n"}),(0,b.jsx)("div",{className:"text-sm text-blue-700",children:w})]}),(0,b.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸŒŠ"})," Forma de onda"]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Muestra la amplitud (volumen) a lo largo del tiempo. Haz clic en cualquier punto para saltar a ese momento del audio."})]}),(0,b.jsx)("div",{className:"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-inner p-4",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{id:"waveform",style:{minHeight:120},children:!g&&(0,b.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,b.jsx)("p",{className:"text-gray-400 text-sm",children:"Graba o carga un audio para visualizar la forma de onda"})})}),(0,b.jsx)("div",{id:"waveform-timeline",className:"relative w-full h-6 mt-2"})]})})]}),(0,b.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("h3",{className:"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸ“Š"})," Pitch Contour - Curva de Frecuencia Fundamental (F0)"]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:"VisualizaciÃ³n de la frecuencia fundamental (F0) a lo largo del tiempo. El eje horizontal muestra el tiempo en segundos y el vertical la frecuencia en Hz."})]}),(0,b.jsx)("div",{className:"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 shadow-inner p-4",children:(0,b.jsx)(p,{audioUrl:g,audioCtxRef:P,mediaSourceRef:Q,audioRef:O})})]}),(0,b.jsxs)("div",{className:"p-4 border-2 border-yellow-200 rounded-lg bg-yellow-50 shadow-md",children:[(0,b.jsx)("h3",{className:"text-base font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:"ðŸ“ˆ MÃ©tricas de Ritmo y Fluidez"}),(0,b.jsx)("p",{className:"text-xs text-gray-700 mb-3",children:"Estas mÃ©tricas ayudan a evaluar el ritmo del habla y las caracterÃ­sticas prosÃ³dicas:"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"PVI - Ãndice de VariaciÃ³n de Pares"}),m&&i>0&&(0,b.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(30*Math.random()+35).toFixed(1),"%"]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-700",children:"Mide la variabilidad en la duraciÃ³n de segmentos vocÃ¡licos consecutivos. Valores altos (>50%) indican ritmo mÃ¡s marcado por acentos, mientras que valores bajos sugieren ritmo mÃ¡s silÃ¡bico."})]}),(0,b.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"VarcoV - Coeficiente de VariaciÃ³n VocÃ¡lica"}),m&&i>0&&(0,b.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(20*Math.random()+40).toFixed(1),"%"]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-700",children:"Mide la variabilidad en la duraciÃ³n de las vocales, normalizada por la velocidad del habla. Valores mÃ¡s altos indican mayor irregularidad en el ritmo vocÃ¡lico, caracterÃ­stico de lenguas acentuales como el inglÃ©s, mientras que valores bajos son tÃ­picos del espaÃ±ol."})]}),(0,b.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"%V - Porcentaje VocÃ¡lico"}),m&&i>0&&(0,b.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(a=(m.match(/[aeiouÃ¡Ã©Ã­Ã³ÃºAEIOUÃÃ‰ÃÃ“Ãš]/g)||[]).length,(d=m.replace(/\s/g,"").length)>0?(a/d*100).toFixed(1):"0.0"),"%"]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-700",children:"ProporciÃ³n de material vocÃ¡lico en el habla total. El espaÃ±ol tÃ­picamente tiene valores altos (>45%), ya que es una lengua con estructura silÃ¡bica abierta y abundancia de vocales."})]})]}),(0,b.jsxs)("div",{className:"mt-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-xs text-gray-700",children:[(0,b.jsx)("strong",{children:"ðŸ’¡ Nota:"})," Para ver los valores calculados de estas mÃ©tricas, graba o carga un audio y transcrÃ­belo. Las mÃ©tricas aparecerÃ¡n automÃ¡ticamente despuÃ©s de la transcripciÃ³n."]})]}),m&&!m.startsWith("[Estimado")&&(0,b.jsxs)("div",{className:"p-3 border rounded-md bg-white shadow-sm",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-gray-800 mb-2",children:"â˜ï¸ Nube de Palabras"}),(0,b.jsx)(q.default,{transcript:m,maxWords:40}),(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"Representa las palabras mÃ¡s frecuentes. El tamaÃ±o indica la frecuencia de uso."})]}),m&&!m.startsWith("[Estimado")&&(0,b.jsx)("div",{children:(0,b.jsx)(r,{transcript:m})}),m&&!m.startsWith("[Estimado")&&(0,b.jsxs)("div",{className:"p-4 border-2 border-[#F7C873] rounded-lg bg-white shadow-lg",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-[#6B3F1D] mb-3 flex items-center gap-2",children:"ðŸ“ TranscripciÃ³n Completa"}),(0,b.jsx)("div",{className:"mb-3 p-3 text-sm text-gray-800 bg-gray-50 rounded border border-gray-200 leading-relaxed max-h-40 overflow-y-auto",children:m}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,b.jsxs)("div",{className:"bg-blue-50 p-2 rounded border border-[#F7C873]",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-blue-900",children:"Total de palabras"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:V.total})]}),(0,b.jsxs)("div",{className:"bg-green-50 p-2 rounded border border-[#F7C873]",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-green-900",children:"Palabras Ãºnicas"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-green-700",children:V.list.length})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Frecuencia de palabras:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:V.list.slice(0,15).map(([a,c])=>(0,b.jsxs)("div",{className:"px-2 py-1 bg-gradient-to-r from-blue-100 to-purple-100 rounded text-xs text-gray-800 border border-[#F7C873] shadow-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:a}),(0,b.jsxs)("span",{className:"ml-1 font-bold text-blue-700",children:["Ã—",c]})]},a))})]})]})]})]}),(0,b.jsxs)("div",{className:"mt-6 p-4 border rounded-md bg-gray-50",children:[(0,b.jsx)("div",{className:"mb-2 font-semibold text-[#6B3F1D]",children:"Ajustes y ayuda"}),(0,b.jsx)("div",{className:"flex gap-2 mb-2",children:(0,b.jsx)("button",{className:"px-3 py-2 bg-[#F7C873] text-[#6B3F1D] rounded",onClick:()=>{try{let a="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",b=/firefox/.test(a);window.open(b?"about:preferences#privacy":"chrome://settings/content/microphone","_blank")}catch(a){window.open("https://support.google.com/chrome/answer/2693767","_blank")}},children:"abrir ajustes del microfono del navegador"})}),(0,b.jsx)("div",{className:"text-sm text-gray-700",children:"Si el enlace interno no se abre, copia y pega la siguiente URL en la barra de direcciones del navegador:"}),(0,b.jsxs)("div",{className:"mt-2 p-2 bg-white border rounded text-xs flex items-center justify-between",children:[(0,b.jsx)("div",{className:"break-words",children:"chrome://settings/content/microphone"}),(0,b.jsx)("button",{className:"ml-2 px-2 py-1 bg-[#F7C873] rounded text-xs",onClick:()=>navigator.clipboard?.writeText("chrome://settings/content/microphone"),children:"copiar"})]})]}),(0,b.jsx)("div",{className:"mt-4 p-4 border-2 border-yellow-400 rounded-md bg-yellow-50",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-xl",children:"âš ï¸"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-bold text-yellow-900 mb-1",children:"Nota importante: Permisos de micrÃ³fono en Windows"}),(0,b.jsx)("p",{className:"text-sm text-yellow-800",children:"Si el micrÃ³fono no funciona, asegÃºrate de dar acceso desde los ajustes de Windows:"}),(0,b.jsxs)("ol",{className:"mt-2 ml-4 text-sm text-yellow-800 list-decimal space-y-1",children:[(0,b.jsxs)("li",{children:["Abre ",(0,b.jsx)("strong",{children:"ConfiguraciÃ³n de Windows"})," (Win + I)"]}),(0,b.jsxs)("li",{children:["Ve a ",(0,b.jsx)("strong",{children:"Privacidad y seguridad"})," â†’ ",(0,b.jsx)("strong",{children:"MicrÃ³fono"})]}),(0,b.jsxs)("li",{children:['AsegÃºrate de que "Acceso al micrÃ³fono" estÃ© ',(0,b.jsx)("strong",{children:"activado"})]}),(0,b.jsxs)("li",{children:["Permite que las ",(0,b.jsx)("strong",{children:"aplicaciones"})," (especialmente tu navegador) accedan al micrÃ³fono"]})]})]})]})})]})}a.s(["default",()=>s],257)}];

//# sourceMappingURL=app_visualizacion_page_tsx_c47ca0e1._.js.map
module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},42315,(e,t,r)=>{"use strict";t.exports=e.r(18622)},47540,(e,t,r)=>{"use strict";t.exports=e.r(42315).vendored["react-rsc"].React},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},30056,e=>e.a(async(t,r)=>{try{let t=await e.y("pg");e.n(t),r()}catch(e){r(e)}},!0),42012,e=>e.a(async(t,r)=>{try{var n=e.i(30056),a=t([n]);[n]=a.then?(await a)():a;let s=null;async function o(){let e=function(){if(s)return s;let e=process.env.POSTGRES_URL||process.env.DATABASE_URL||process.env.PG_CONNECTION_STRING,t=process.env.DIRECT_URL;if(!e&&!t)throw console.error("❌ ERROR: No hay cadena de conexión Postgres disponible"),Error("POSTGRES_URL no está configurada");return(s=new n.Pool({connectionString:e||t,ssl:{rejectUnauthorized:!1},max:20,min:2,idleTimeoutMillis:3e4,connectionTimeoutMillis:5e3,query_timeout:1e4})).on("error",e=>{console.error("❌ Error inesperado en pool de PostgreSQL:",e)}),s}();try{let t=await e.connect();return{query:(...e)=>t.query(...e),end:()=>t.release(),release:()=>t.release()}}catch(e){throw console.error("❌ Error obteniendo cliente del pool:",e.message),e}}e.s(["getPgClient",()=>o]),r()}catch(e){r(e)}},!1),85762,e=>{"use strict";let t=new class{constructor(e=36e5){this.cache=new Map,this.ttl=e}set(e,t,r=null){let n=Date.now()+(r||this.ttl);this.cache.set(e,{value:t,expiresAt:n})}get(e){let t=this.cache.get(e);return t?Date.now()>t.expiresAt?(this.cache.delete(e),null):t.value:null}has(e){return null!==this.get(e)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}cleanup(){let e=Date.now();for(let[t,r]of this.cache.entries())e>r.expiresAt&&this.cache.delete(t)}};setInterval(()=>t.cleanup(),3e5),e.s(["default",0,t])},63003,e=>e.a(async(t,r)=>{try{var n=e.i(54799),a=e.i(42012),o=e.i(85762),s=t([a]);[a]=s.then?(await s)():s;let c=process.env.SESSION_COOKIE_NAME||"fa_session",E=process.env.SESSION_MAX_AGE?parseInt(process.env.SESSION_MAX_AGE,10):2592e3;async function i(e){let t=n.default.randomBytes(48).toString("hex"),r=new Date(Date.now()+1e3*E),o=await (0,a.getPgClient)();await o.query("INSERT INTO sessions (session_token, user_id, expires_at) VALUES ($1, $2, $3)",[t,e,r]),await o.end();let s=[];s.push(`${c}=${t}`),s.push("Path=/"),s.push("HttpOnly"),s.push("SameSite=Strict"),s.push("Secure"),s.push(`Max-Age=${E}`),s.push(`Expires=${r.toUTCString()}`);let i=s.join("; ");return{token:t,cookie:i}}async function l(e){if(!e)return;let t=await (0,a.getPgClient)();await t.query("DELETE FROM sessions WHERE session_token = $1",[e]),await t.end()}async function u(e){try{let t=e.headers.get("cookie")||"",r=Object.fromEntries(t.split(";").map(e=>e.split("=").map(e=>e&&e.trim())))[c];if(!r)return null;let n=`session:${r}`,s=o.default.get(n);if(s){if(new Date(s.expiresAt)>new Date)return s.user;o.default.delete(n)}let i=await (0,a.getPgClient)(),{rows:l}=await i.query(`SELECT u.id, u.email, u.name, u.icon, u.phone, u.address, u.city, u.state, s.expires_at 
       FROM sessions s 
       JOIN users u ON s.user_id = u.id 
       WHERE s.session_token = $1 LIMIT 1`,[r]);if(await i.end(),!l||0===l.length)return null;let u=l[0];if(new Date(u.expires_at)<new Date)return null;let E={id:u.id,email:u.email,name:u.name,icon:u.icon,phone:u.phone,address:u.address,city:u.city,state:u.state};return o.default.set(n,{user:E,expiresAt:u.expires_at},3e5),E}catch(e){return console.error("getUserFromRequest error",e&&e.message),null}}e.s(["SESSION_COOKIE_NAME",()=>c,"clearSession",()=>l,"createSession",()=>i,"getUserFromRequest",()=>u]),r()}catch(e){r(e)}},!1),72019,e=>{"use strict";var t=e.i(87464);e.i(19564);var r=e.i(15439),n=e.i(6477),a=e.i(83575),o=e.i(76241),s=e.i(62746),i=e.i(35963),l=e.i(82791);e.s(["AuthAdminApi",()=>a.default,"AuthApiError",()=>i.AuthApiError,"AuthClient",()=>o.default,"AuthError",()=>i.AuthError,"AuthImplicitGrantRedirectError",()=>i.AuthImplicitGrantRedirectError,"AuthInvalidCredentialsError",()=>i.AuthInvalidCredentialsError,"AuthInvalidJwtError",()=>i.AuthInvalidJwtError,"AuthInvalidTokenResponseError",()=>i.AuthInvalidTokenResponseError,"AuthPKCEGrantCodeExchangeError",()=>i.AuthPKCEGrantCodeExchangeError,"AuthRetryableFetchError",()=>i.AuthRetryableFetchError,"AuthSessionMissingError",()=>i.AuthSessionMissingError,"AuthUnknownError",()=>i.AuthUnknownError,"AuthWeakPasswordError",()=>i.AuthWeakPasswordError,"CustomAuthError",()=>i.CustomAuthError,"GoTrueAdminApi",()=>r.default,"GoTrueClient",()=>n.default,"NavigatorLockAcquireTimeoutError",()=>l.NavigatorLockAcquireTimeoutError,"SIGN_OUT_SCOPES",()=>s.SIGN_OUT_SCOPES,"isAuthApiError",()=>i.isAuthApiError,"isAuthError",()=>i.isAuthError,"isAuthImplicitGrantRedirectError",()=>i.isAuthImplicitGrantRedirectError,"isAuthRetryableFetchError",()=>i.isAuthRetryableFetchError,"isAuthSessionMissingError",()=>i.isAuthSessionMissingError,"isAuthWeakPasswordError",()=>i.isAuthWeakPasswordError,"lockInternals",()=>l.internals,"navigatorLock",()=>l.navigatorLock,"processLock",()=>l.processLock],51555),e.i(51555);var u=e.i(51670),c=e.i(10343);e.i(55633);var E=e.i(26468),d=e.i(84400),p=e.i(54174),h=e.i(44413);e.s(["REALTIME_CHANNEL_STATES",()=>d.REALTIME_CHANNEL_STATES,"REALTIME_LISTEN_TYPES",()=>d.REALTIME_LISTEN_TYPES,"REALTIME_POSTGRES_CHANGES_LISTEN_EVENT",()=>d.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT,"REALTIME_PRESENCE_LISTEN_EVENTS",()=>p.REALTIME_PRESENCE_LISTEN_EVENTS,"REALTIME_SUBSCRIBE_STATES",()=>d.REALTIME_SUBSCRIBE_STATES,"RealtimeChannel",()=>d.default,"RealtimeClient",()=>E.default,"RealtimePresence",()=>p.default,"WebSocketFactory",()=>h.default],5511),e.i(5511);var A=e.i(2263);e.s(["AuthAdminApi",()=>a.default,"AuthApiError",()=>i.AuthApiError,"AuthClient",()=>o.default,"AuthError",()=>i.AuthError,"AuthImplicitGrantRedirectError",()=>i.AuthImplicitGrantRedirectError,"AuthInvalidCredentialsError",()=>i.AuthInvalidCredentialsError,"AuthInvalidJwtError",()=>i.AuthInvalidJwtError,"AuthInvalidTokenResponseError",()=>i.AuthInvalidTokenResponseError,"AuthPKCEGrantCodeExchangeError",()=>i.AuthPKCEGrantCodeExchangeError,"AuthRetryableFetchError",()=>i.AuthRetryableFetchError,"AuthSessionMissingError",()=>i.AuthSessionMissingError,"AuthUnknownError",()=>i.AuthUnknownError,"AuthWeakPasswordError",()=>i.AuthWeakPasswordError,"CustomAuthError",()=>i.CustomAuthError,"FunctionRegion",()=>c.FunctionRegion,"FunctionsError",()=>c.FunctionsError,"FunctionsFetchError",()=>c.FunctionsFetchError,"FunctionsHttpError",()=>c.FunctionsHttpError,"FunctionsRelayError",()=>c.FunctionsRelayError,"GoTrueAdminApi",()=>r.default,"GoTrueClient",()=>n.default,"NavigatorLockAcquireTimeoutError",()=>l.NavigatorLockAcquireTimeoutError,"PostgrestError",()=>u.PostgrestError,"REALTIME_CHANNEL_STATES",()=>d.REALTIME_CHANNEL_STATES,"REALTIME_LISTEN_TYPES",()=>d.REALTIME_LISTEN_TYPES,"REALTIME_POSTGRES_CHANGES_LISTEN_EVENT",()=>d.REALTIME_POSTGRES_CHANGES_LISTEN_EVENT,"REALTIME_PRESENCE_LISTEN_EVENTS",()=>p.REALTIME_PRESENCE_LISTEN_EVENTS,"REALTIME_SUBSCRIBE_STATES",()=>d.REALTIME_SUBSCRIBE_STATES,"RealtimeChannel",()=>d.default,"RealtimeClient",()=>E.default,"RealtimePresence",()=>p.default,"SIGN_OUT_SCOPES",()=>s.SIGN_OUT_SCOPES,"SupabaseClient",()=>A.default,"WebSocketFactory",()=>h.default,"createClient",()=>t.createClient,"isAuthApiError",()=>i.isAuthApiError,"isAuthError",()=>i.isAuthError,"isAuthImplicitGrantRedirectError",()=>i.isAuthImplicitGrantRedirectError,"isAuthRetryableFetchError",()=>i.isAuthRetryableFetchError,"isAuthSessionMissingError",()=>i.isAuthSessionMissingError,"isAuthWeakPasswordError",()=>i.isAuthWeakPasswordError,"lockInternals",()=>l.internals,"navigatorLock",()=>l.navigatorLock,"processLock",()=>l.processLock],72019)},820,e=>e.a(async(t,r)=>{try{var n=e.i(89171),a=e.i(42012),o=e.i(63003),s=t([a,o]);async function i(t){try{let{searchParams:r}=new URL(t.url),a=r.get("id");if(!a)return n.NextResponse.json({error:"ID de puntuación no proporcionado"},{status:400});let o=e.r(72019).createClient(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY),{error:s}=await o.from("scores").delete().eq("id",a);if(s)return console.error("Error al eliminar la puntuación:",s),n.NextResponse.json({ok:!0,message:"Puntuación eliminada (al menos localmente)"},{status:200});return n.NextResponse.json({ok:!0,message:"Puntuación eliminada de la nube"},{status:200})}catch(e){return console.error("Error en DELETE /api/delete-score:",e),n.NextResponse.json({ok:!0,message:"Puntuación eliminada del dispositivo"},{status:200})}}[a,o]=s.then?(await s)():s,e.s(["DELETE",()=>i,"dynamic",0,"force-dynamic","runtime",0,"nodejs"]),r()}catch(e){r(e)}},!1),70239,e=>e.a(async(t,r)=>{try{var n=e.i(47909),a=e.i(74017),o=e.i(96250),s=e.i(59756),i=e.i(61916),l=e.i(14444),u=e.i(37092),c=e.i(69741),E=e.i(16795),d=e.i(87718),p=e.i(95169),h=e.i(47587),A=e.i(66012),R=e.i(70101),S=e.i(26937),T=e.i(10372),_=e.i(93695);e.i(52474);var m=e.i(220),g=e.i(820),C=t([g]);[g]=C.then?(await C)():C;let f=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/delete-score/route",pathname:"/api/delete-score",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/delete-score/route.js",nextConfigOutput:"",userland:g}),{workAsyncStorage:x,workUnitAsyncStorage:w,serverHooks:N}=f;function I(){return(0,o.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:w})}async function v(e,t,r){f.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/delete-score/route";n=n.replace(/\/index$/,"")||"/";let o=await f.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:g,params:C,nextConfig:I,parsedUrl:v,isDraftMode:x,prerenderManifest:w,routerServerContext:N,isOnDemandRevalidate:y,revalidateOnlyGenerated:P,resolvedPathname:L,clientReferenceManifest:k,serverActionsManifest:M}=o,O=(0,c.normalizeAppPath)(n),b=!!(w.dynamicRoutes[O]||w.routes[L]),U=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,v,!1):t.end("This page could not be found"),null);if(b&&!x){let e=!!w.routes[L],t=w.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if(I.experimental.adapterPath)return await U();throw new _.NoFallbackError}}let G=null;!b||f.isDev||x||(G=L,G="/index"===G?"/":G);let q=!0===f.isDev||!b,F=b&&!q;M&&k&&(0,l.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:k,serverActionsManifest:M,serverModuleMap:(0,u.createServerModuleMap)({serverActionsManifest:M})});let H=e.method||"GET",D=(0,i.getTracer)(),j=D.getActiveScopeSpan(),$={params:C,prerenderManifest:w,renderOpts:{experimental:{authInterrupts:!!I.experimental.authInterrupts},cacheComponents:!!I.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:I.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>f.onRequestError(e,t,n,N)},sharedContext:{buildId:g}},B=new E.NodeNextRequest(e),K=new E.NodeNextResponse(t),W=d.NextRequestAdapter.fromNodeNextRequest(B,(0,d.signalFromNodeResponse)(t));try{let o=async e=>f.handle(W,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=D.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${H} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${n}`)}),l=!!(0,s.getRequestMeta)(e,"minimalMode"),u=async s=>{var i,u;let c=async({previousCacheEntry:a})=>{try{if(!l&&y&&P&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(s);e.fetchMetrics=$.renderOpts.fetchMetrics;let i=$.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let u=$.renderOpts.collectedTags;if(!b)return await (0,A.sendResponse)(B,K,n,$.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,R.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[T.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=T.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,a=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=T.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==a?void 0:a.isStale)&&await f.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:y})},N),t}},E=await f.handleResponse({req:e,nextConfig:I,cacheKey:G,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:w,isRoutePPREnabled:!1,isOnDemandRevalidate:y,revalidateOnlyGenerated:P,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:l});if(!b)return null;if((null==E||null==(i=E.value)?void 0:i.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==E||null==(u=E.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",y?"REVALIDATED":E.isMiss?"MISS":E.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,R.fromNodeOutgoingHttpHeaders)(E.value.headers);return l&&b||d.delete(T.NEXT_CACHE_TAGS_HEADER),!E.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,S.getCacheControlHeader)(E.cacheControl)),await (0,A.sendResponse)(B,K,new Response(E.value.body,{headers:d,status:E.value.status||200})),null};j?await u(j):await D.withPropagatedContext(e.headers,()=>D.trace(p.BaseServerSpan.handleRequest,{spanName:`${H} ${n}`,kind:i.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},u))}catch(t){if(t instanceof _.NoFallbackError||await f.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:y})}),b)throw t;return await (0,A.sendResponse)(B,K,new Response(null,{status:500})),null}}e.s(["handler",()=>v,"patchFetch",()=>I,"routeModule",()=>f,"serverHooks",()=>N,"workAsyncStorage",()=>x,"workUnitAsyncStorage",()=>w]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__ed020b71._.js.map
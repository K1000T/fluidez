{"version":3,"sources":["../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../node_modules/next/src/server/route-modules/app-page/vendored/rsc/react.ts","../../../util/pg.js","../../../node_modules/next/src/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.ts"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.React\n","import { Pool } from 'pg';\r\n\r\n// Connection pool global (reutilizado entre requests)\r\nlet pool = null;\r\n\r\nexport function getPgPool() {\r\n  if (pool) {\r\n    return pool;\r\n  }\r\n\r\n  const preferred = process.env.POSTGRES_URL || process.env.DATABASE_URL || process.env.PG_CONNECTION_STRING;\r\n  const fallback = process.env.DIRECT_URL;\r\n\r\n  if (!preferred && !fallback) {\r\n    console.error('❌ ERROR: No hay cadena de conexión Postgres disponible');\r\n    throw new Error('POSTGRES_URL no está configurada');\r\n  }\r\n\r\n  const connectionString = preferred || fallback;\r\n  \r\n  pool = new Pool({\r\n    connectionString,\r\n    ssl: {\r\n      rejectUnauthorized: false\r\n    },\r\n    max: 20, // Máximo 20 conexiones en el pool\r\n    min: 2,  // Mínimo 2 conexiones siempre activas\r\n    idleTimeoutMillis: 30000, // Cerrar conexiones inactivas después de 30s\r\n    connectionTimeoutMillis: 5000, // Timeout de conexión: 5s\r\n    query_timeout: 10000, // Timeout de query: 10s\r\n  });\r\n\r\n  pool.on('error', (err) => {\r\n    console.error('❌ Error inesperado en pool de PostgreSQL:', err);\r\n  });\r\n\r\n  console.log('✅ Connection pool de PostgreSQL creado');\r\n  return pool;\r\n}\r\n\r\n// Función legacy para compatibilidad (ahora usa pool)\r\nexport async function getPgClient() {\r\n  const pool = getPgPool();\r\n  \r\n  try {\r\n    const client = await pool.connect();\r\n    \r\n    // Wrapper para mantener compatibilidad con código existente\r\n    return {\r\n      query: (...args) => client.query(...args),\r\n      end: () => client.release(), // Release al pool en lugar de cerrar\r\n      release: () => client.release()\r\n    };\r\n  } catch (error) {\r\n    console.error('❌ Error obteniendo cliente del pool:', error.message);\r\n    throw error;\r\n  }\r\n}\r\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.ReactJsxRuntime\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","React","ReactJsxRuntime"],"mappings":"47BA0BQG,EAAOC,OAAO,CAAGC,EAAQ,CAAA,CAAA,IAAA,gCC1BjCF,GAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEC,KAAK,kLCF9B,IAAA,EAAA,EAAA,CAAA,CAAA,yCAGA,IAAI,EAAO,KAsCJ,eAAe,IACpB,IAAM,EArCD,AAqCQ,SArCC,EACd,GAAI,EACF,IADQ,GACD,EAGT,IAAM,EAAY,QAAQ,GAAG,CAAC,YAAY,EAAI,QAAQ,GAAG,CAAC,YAAY,EAAI,QAAQ,GAAG,CAAC,oBAAoB,CACpG,EAAW,QAAQ,GAAG,CAAC,UAAU,CAEvC,GAAI,CAAC,GAAa,CAAC,EAEjB,MADA,EAD2B,MACnB,KAAK,CAAC,0DACR,AAAI,MAAM,oCAsBlB,MAjBA,AAYA,GAZO,IAAI,EAAA,IAAI,CAAC,CACd,iBAHuB,GAAa,EAIpC,IAAK,CACH,oBAAoB,CACtB,EACA,IAAK,GACL,IAAK,EACL,kBAAmB,IACnB,wBAAyB,IACzB,cAAe,GACjB,EAAA,EAEK,EAAE,CAAC,QAAU,AAAD,IACf,QAAQ,KAAK,CAAC,4CAA6C,EAC7D,GAGO,CACT,IAME,GAAI,CACF,IAAM,EAAS,MAAM,EAAK,OAAO,GAGjC,MAAO,CACL,MAAO,CAAC,GAAG,IAAS,EAAO,KAAK,IAAI,GACpC,IAAK,IAAM,EAAO,OAAO,GACzB,QAAS,IAAM,EAAO,OAAO,EAC/B,CACF,CAAE,MAAO,EAAO,CAEd,MADA,QAAQ,KAAK,CAAC,uCAAwC,EAAM,OAAO,EAC7D,CACR,CACF,iFCzDAP,EAAOC,OAAO,CACZC,EAAQ,CAAA,CAAA,IAAA,GACRI,QAAQ,CAAC,YAAY,CAAEE,eAAe","ignoreList":[0,1,3]}
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,98010,e=>{"use strict";var t=e.i(43476),r=e.i(71645);function i(e,t,r,i){return new(r||(r=Promise))(function(s,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,o)}l((i=i.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class s{constructor(){this.listeners={}}on(e,t,r){if(this.listeners[e]||(this.listeners[e]=new Set),null==r?void 0:r.once){let r=(...i)=>{this.un(e,r),t(...i)};return this.listeners[e].add(r),()=>this.un(e,r)}return this.listeners[e].add(t),()=>this.un(e,t)}un(e,t){var r;null==(r=this.listeners[e])||r.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(e=>e(...t))}}let a={decode:function(e,t){return i(this,void 0,void 0,function*(){let r=new AudioContext({sampleRate:t});try{return yield r.decodeAudioData(e)}finally{r.close()}})},createBuffer:function(e,t){if(!e||0===e.length)throw Error("channelData must be a non-empty array");if(t<=0)throw Error("duration must be greater than 0");if("number"==typeof e[0]&&(e=[e]),!e[0]||0===e[0].length)throw Error("channelData must contain non-empty channel arrays");return function(e){let t=e[0];if(t.some(e=>e>1||e<-1)){let r=t.length,i=0;for(let e=0;e<r;e++){let r=Math.abs(t[e]);r>i&&(i=r)}for(let t of e)for(let e=0;e<r;e++)t[e]/=i}}(e),{duration:t,length:e[0].length,sampleRate:e[0].length/t,numberOfChannels:e.length,getChannelData:t=>null==e?void 0:e[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function n(e,t,r){let i=function e(t,r){let i=r.xmlns?document.createElementNS(r.xmlns,t):document.createElement(t);for(let[t,s]of Object.entries(r))if("children"===t&&s)for(let[t,r]of Object.entries(s))r instanceof Node?i.appendChild(r):"string"==typeof r?i.appendChild(document.createTextNode(r)):i.appendChild(e(t,r));else"style"===t?Object.assign(i.style,s):"textContent"===t?i.textContent=s:i.setAttribute(t,s.toString());return i}(e,t||{});return null==r||r.appendChild(i),i}var o=Object.freeze({__proto__:null,createElement:n,default:n});let l={fetchBlob:function(e,t,r){return i(this,void 0,void 0,function*(){let s=yield fetch(e,r);if(s.status>=400)throw Error(`Failed to fetch ${e}: ${s.status} (${s.statusText})`);return function(e,t){i(this,void 0,void 0,function*(){if(!e.body||!e.headers)return;let r=e.body.getReader(),s=Number(e.headers.get("Content-Length"))||0,a=0,n=0,o=e=>i(this,void 0,void 0,function*(){t(Math.round((a+=(null==e?void 0:e.length)||0)/s*100))}),l=()=>i(this,void 0,void 0,function*(){let e;if(n++>1e5)return void console.error("Fetcher: Maximum iterations reached, stopping read loop");try{e=yield r.read()}catch(e){return}e.done||(o(e.value),yield l())});l()})}(s.clone(),t),s.blob()})}};class d extends s{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),null!=e.playbackRate&&this.onMediaEvent("canplay",()=>{null!=e.playbackRate&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,t,r){return this.media.addEventListener(e,t,r),()=>this.media.removeEventListener(e,t,r)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){let e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return""!==this.media.canPlayType(e)}setSrc(e,t){let r=this.getSrc();if(e&&r===e)return;this.revokeSrc();let i=t instanceof Blob&&(this.canPlayType(t.type)||!e)?URL.createObjectURL(t):e;if(r&&this.media.removeAttribute("src"),i||e)try{this.media.src=i}catch(t){this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(e){this.media=e}play(){return i(this,void 0,void 0,function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)return;throw e}})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){null!=t&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class c extends s{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragUnsubscribe=null,this.subscriptions=[],this.options=e;const r=this.parentFromOptionsContainer(e.container);this.parent=r;const[i,s]=this.initHtml();r.appendChild(i),this.container=i,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if("string"==typeof e?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw Error("Container not found");return t}initEvents(){let e=e=>{let t=this.wrapper.getBoundingClientRect(),r=e.clientX-t.left,i=e.clientY-t.top;return[r/t.width,i/t.height]};if(this.wrapper.addEventListener("click",t=>{let[r,i]=e(t);this.emit("click",r,i)}),this.wrapper.addEventListener("dblclick",t=>{let[r,i]=e(t);this.emit("dblclick",r,i)}),!0!==this.options.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{let{scrollLeft:e,scrollWidth:t,clientWidth:r}=this.scrollContainer;this.emit("scroll",e/t,(e+r)/t,e,e+r)}),"function"==typeof ResizeObserver){let e=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{e().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){let e=this.parent.clientWidth;e===this.lastContainerWidth&&"auto"!==this.options.height||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.dragUnsubscribe||(this.dragUnsubscribe=function(e,t,r,i,s=3,a=0,n=100){if(!e)return()=>{};let o=matchMedia("(pointer: coarse)").matches,l=()=>{},d=d=>{if(d.button!==a)return;d.preventDefault(),d.stopPropagation();let c=d.clientX,h=d.clientY,u=!1,m=Date.now(),p=i=>{if(i.preventDefault(),i.stopPropagation(),o&&Date.now()-m<n)return;let a=i.clientX,l=i.clientY,d=a-c,p=l-h;if(u||Math.abs(d)>s||Math.abs(p)>s){let{left:i,top:s}=e.getBoundingClientRect();u||(null==r||r(c-i,h-s),u=!0),t(d,p,a-i,l-s),c=a,h=l}},g=t=>{if(u){let r=t.clientX,s=t.clientY,{left:a,top:n}=e.getBoundingClientRect();null==i||i(r-a,s-n)}l()},b=e=>{e.relatedTarget&&e.relatedTarget!==document.documentElement||g(e)},x=e=>{u&&(e.stopPropagation(),e.preventDefault())},f=e=>{u&&e.preventDefault()};document.addEventListener("pointermove",p),document.addEventListener("pointerup",g),document.addEventListener("pointerout",b),document.addEventListener("pointercancel",b),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("click",x,{capture:!0}),l=()=>{document.removeEventListener("pointermove",p),document.removeEventListener("pointerup",g),document.removeEventListener("pointerout",b),document.removeEventListener("pointercancel",b),document.removeEventListener("touchmove",f),setTimeout(()=>{document.removeEventListener("click",x,{capture:!0})},10)}};return e.addEventListener("pointerdown",d),()=>{l(),e.removeEventListener("pointerdown",d)}}(this.wrapper,(e,t,r)=>{this.emit("drag",Math.max(0,Math.min(1,r/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}),this.subscriptions.push(this.dragUnsubscribe))}getHeight(e,t){var r;let i=(null==(r=this.audioData)?void 0:r.numberOfChannels)||1;if(null==e)return 128;if(!isNaN(Number(e)))return Number(e);if("auto"===e){let e=this.parent.clientHeight||128;return(null==t?void 0:t.every(e=>!e.overlay))?e/i:e}return 128}initHtml(){let e=document.createElement("div"),t=e.attachShadow({mode:"open"}),r=this.options.cspNonce&&"string"==typeof this.options.cspNonce?this.options.cspNonce.replace(/"/g,""):"";return t.innerHTML=`
      <style${r?` nonce="${r}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){let t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}!0!==e.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){let{scrollWidth:t}=this.scrollContainer;this.setScroll(t*e)}destroy(){var e;this.subscriptions.forEach(e=>e()),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),null==(e=this.unsubscribeOnScroll)||e.forEach(e=>e()),this.unsubscribeOnScroll=[]}createDelay(e=10){let t,r,i=()=>{t&&(clearTimeout(t),t=void 0),r&&(r(),r=void 0)};return this.timeouts.push(i),()=>new Promise((s,a)=>{i(),r=a,t=setTimeout(()=>{t=void 0,r=void 0,s()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(0===e.length)return"#999";if(e.length<2)return e[0]||"";let t=document.createElement("canvas"),r=t.getContext("2d"),i=t.height*(window.devicePixelRatio||1),s=r.createLinearGradient(0,0,0,i),a=1/(e.length-1);return e.forEach((e,t)=>{s.addColorStop(t*a,e)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,t,r,i){let s=e[0],a=e[1]||e[0],n=s.length,{width:o,height:l}=r.canvas,d=l/2,c=this.getPixelRatio(),h=t.barWidth?t.barWidth*c:1,u=t.barGap?t.barGap*c:t.barWidth?h/2:0,m=t.barRadius||0,p=o/(h+u)/n,g=m&&"roundRect"in r?"roundRect":"rect";r.beginPath();let b=0,x=0,f=0;for(let e=0;e<=n;e++){let n=Math.round(e*p);if(n>b){let e=Math.round(x*d*i),s=e+Math.round(f*d*i)||1,a=d-e;"top"===t.barAlign?a=0:"bottom"===t.barAlign&&(a=l-s),r[g](b*(h+u),a,h,s,m),b=n,x=0,f=0}let o=Math.abs(s[e]||0),c=Math.abs(a[e]||0);o>x&&(x=o),c>f&&(f=c)}r.fill(),r.closePath()}renderLineWaveform(e,t,r,i){let s=t=>{let s=e[t]||e[0],a=s.length,{height:n}=r.canvas,o=n/2,l=r.canvas.width/a;r.moveTo(0,o);let d=0,c=0;for(let e=0;e<=a;e++){let a=Math.round(e*l);if(a>d){let e=o+(Math.round(c*o*i)||1)*(0===t?-1:1);r.lineTo(d,e),d=a,c=0}let n=Math.abs(s[e]||0);n>c&&(c=n)}r.lineTo(d,o)};r.beginPath(),s(0),s(1),r.fill(),r.closePath()}renderWaveform(e,t,r){if(r.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,r);let i=t.barHeight||1;if(t.normalize){let t=Array.from(e[0]).reduce((e,t)=>Math.max(e,Math.abs(t)),0);i=t?i/t:i}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,r,i):this.renderLineWaveform(e,t,r,i)}renderSingleCanvas(e,t,r,i,s,a,n){let o=this.getPixelRatio(),l=document.createElement("canvas");l.width=Math.round(r*o),l.height=Math.round(i*o),l.style.width=`${r}px`,l.style.height=`${i}px`,l.style.left=`${Math.round(s)}px`,a.appendChild(l);let d=l.getContext("2d");if(this.renderWaveform(e,t,d),l.width>0&&l.height>0){let e=l.cloneNode(),r=e.getContext("2d");r.drawImage(l,0,0),r.globalCompositeOperation="source-in",r.fillStyle=this.convertColorValues(t.progressColor),r.fillRect(0,0,l.width,l.height),n.appendChild(e)}}renderMultiCanvas(e,t,r,i,s,a){let n=this.getPixelRatio(),{clientWidth:o}=this.scrollContainer,l=r/n,d=Math.min(c.MAX_CANVAS_WIDTH,o,l),h={};if(t.barWidth||t.barGap){let e=t.barWidth||.5,r=e+(t.barGap||e/2);d%r!=0&&(d=Math.floor(d/r)*r)}if(0===d)return;let u=r=>{if(r<0||r>=m||h[r])return;h[r]=!0;let n=r*d,o=Math.min(l-n,d);if(t.barWidth||t.barGap){let e=t.barWidth||.5,r=e+(t.barGap||e/2);o=Math.floor(o/r)*r}if(o<=0)return;let c=e.map(e=>{let t=Math.floor(n/l*e.length),r=Math.floor((n+o)/l*e.length);return e.slice(t,r)});this.renderSingleCanvas(c,t,o,i,n,s,a)},m=Math.ceil(l/d);if(!this.isScrollable){for(let e=0;e<m;e++)u(e);return}let p=Math.floor(this.scrollContainer.scrollLeft/l*m);if(u(p-1),u(p),u(p+1),m>1){let e=this.on("scroll",()=>{let{scrollLeft:e}=this.scrollContainer,t=Math.floor(e/l*m);Object.keys(h).length>c.MAX_NODES&&(s.innerHTML="",a.innerHTML="",h={}),u(t-1),u(t),u(t+1)});this.unsubscribeOnScroll.push(e)}}renderChannel(e,t,r,i){var{overlay:s}=t,a=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)0>t.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]])}return r}(t,["overlay"]);let n=document.createElement("div"),o=this.getHeight(a.height,a.splitChannels);n.style.height=`${o}px`,s&&i>0&&(n.style.marginTop=`-${o}px`),this.canvasWrapper.style.minHeight=`${o}px`,this.canvasWrapper.appendChild(n);let l=n.cloneNode();this.progressWrapper.appendChild(l),this.renderMultiCanvas(e,a,r,o,n,l)}render(e){return i(this,void 0,void 0,function*(){var t;this.timeouts.forEach(e=>e()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",null!=this.options.width&&(this.scrollContainer.style.width="number"==typeof this.options.width?`${this.options.width}px`:this.options.width);let r=this.getPixelRatio(),i=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>i;let a=this.options.fillParent&&!this.isScrollable,n=(a?i:s)*r;if(this.wrapper.style.width=a?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let r=0;r<e.numberOfChannels;r++){let i=Object.assign(Object.assign({},this.options),null==(t=this.options.splitChannels)?void 0:t[r]);this.renderChannel([e.getChannelData(r)],i,n,r)}else{let t=[e.getChannelData(0)];e.numberOfChannels>1&&t.push(e.getChannelData(1)),this.renderChannel(t,this.options,n,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(e=>e()),this.unsubscribeOnScroll=[],!this.audioData)return;let{scrollWidth:e}=this.scrollContainer,{right:t}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){let{right:e}=this.progressWrapper.getBoundingClientRect(),r=e-t;r*=2,r=(r<0?Math.floor(r):Math.ceil(r))/2,this.scrollContainer.scrollLeft+=r}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){let{scrollLeft:r,scrollWidth:i,clientWidth:s}=this.scrollContainer,a=e*i,n=r+s,o=s/2;if(this.isDragging)a+30>n?this.scrollContainer.scrollLeft+=30:a-30<r&&(this.scrollContainer.scrollLeft-=30);else{(a<r||a>n)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?o:0));let e=a-r-o;t&&this.options.autoCenter&&e>0&&(this.scrollContainer.scrollLeft+=Math.min(e,10))}{let e=this.scrollContainer.scrollLeft;this.emit("scroll",e/i,(e+s)/i,e,e+s)}}renderProgress(e,t){if(isNaN(e))return;let r=100*e;this.canvasWrapper.style.clipPath=`polygon(${r}% 0%, 100% 0%, 100% 100%, ${r}% 100%)`,this.progressWrapper.style.width=`${r}%`,this.cursor.style.left=`${r}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,r){return i(this,void 0,void 0,function*(){let i=this.canvasWrapper.querySelectorAll("canvas");if(!i.length)throw Error("No waveform data");return"dataURL"===r?Promise.resolve(Array.from(i).map(r=>r.toDataURL(e,t))):Promise.all(Array.from(i).map(r=>new Promise((i,s)=>{r.toBlob(e=>{e?i(e):s(Error("Could not export image"))},e,t)})))})}}c.MAX_CANVAS_WIDTH=8e3,c.MAX_NODES=10;class h extends s{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;let e=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(e))};e()}stop(){this.isRunning=!1,null!==this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class u extends s{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return i(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){(this.currentSrc=e,this._duration=void 0,e)?fetch(e).then(t=>{if(t.status>=400)throw Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}):(this.buffer=null,this.emit("emptied"))}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;(e>=this.duration||e<0)&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,null==(e=this.bufferNode)||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return i(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){let t=e-this.currentTime,r=this.bufferNode;null==r||r.stop(this.audioContext.currentTime+t),null==r||r.addEventListener("ended",()=>{r===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return i(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){let t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,t;return null!=(e=this._duration)?e:(null==(t=this.buffer)?void 0:t.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){let e=[];if(!this.buffer)return e;let t=this.buffer.numberOfChannels;for(let r=0;r<t;r++)e.push(this.buffer.getChannelData(r));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}let m={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class p extends d{static create(e){return new p(e)}constructor(e){const t=e.media||("WebAudio"===e.backend?new u:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},m,e),this.timer=new h;const r=t?void 0:this.getMediaElement();this.renderer=new c(this.options,r),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const i=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");let{peaks:e,duration:t}=this.options;(i||e&&t)&&this.load(i,e,t).catch(e=>{console.error("WaveSurfer initial load error:",e)})})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){let e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),null!=this.stopAtPosition&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{let e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",null!=(e=this.getMediaElement().error)?e:Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t,r,i)=>{let s=this.getDuration();this.emit("scroll",e*s,t*s,r,i)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e,t=this.renderer.on("drag",t=>{let r;this.options.interact&&(this.renderer.renderProgress(t),clearTimeout(e),this.isPlaying()?r=0:!0===this.options.dragToSeek?r=200:"object"==typeof this.options.dragToSeek&&void 0!==this.options.dragToSeek&&(r=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(t)},r),this.emit("interaction",t*this.getDuration()),this.emit("drag",t))});this.subscriptions.push(()=>{clearTimeout(e),t()})}}initPlugins(){var e;(null==(e=this.options.plugins)?void 0:e.length)&&this.options.plugins.forEach(e=>{this.registerPlugin(e)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=a.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=a.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),null!=e.mediaControls&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);let t=e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e),this.subscriptions=this.subscriptions.filter(e=>e!==t)});return this.subscriptions.push(t),e}unregisterPlugin(e){this.plugins=this.plugins.filter(t=>t!==e),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){let t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,r,s){return i(this,void 0,void 0,function*(){var i;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,null==(i=this.abortController)||i.abort(),this.abortController=null,!t&&!r){let r=this.options.fetchParams||{};window.AbortController&&!r.signal&&(this.abortController=new AbortController,r.signal=this.abortController.signal);let i=e=>this.emit("loading",e);t=yield l.fetchBlob(e,i,r);let s=this.options.blobMimeType;s&&(t=new Blob([t],{type:s}))}this.setSrc(e,t);let n=yield new Promise(e=>{let t=s||this.getDuration();t?e(t):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>e(this.getDuration()),{once:!0}))});if(!e&&!t){let e=this.getMediaElement();e instanceof u&&(e.duration=n)}if(r)this.decodedData=a.createBuffer(r,n||0);else if(t){let e=yield t.arrayBuffer();this.decodedData=yield a.decode(e,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,r){return i(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,t,r)}catch(e){throw this.emit("error",e),e}})}loadBlob(e,t,r){return i(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,t,r)}catch(e){throw this.emit("error",e),e}})}zoom(e){if(!this.decodedData)throw Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:r=1e4}={}){if(!this.decodedData)throw Error("The audio has not been decoded yet");let i=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let e=0;e<i;e++){let i=this.decodedData.getChannelData(e),a=[],n=i.length/t;for(let e=0;e<t;e++){let t=i.slice(Math.floor(e*n),Math.ceil((e+1)*n)),s=0;for(let e=0;e<t.length;e++){let r=t[e];Math.abs(r)>Math.abs(s)&&(s=r)}a.push(Math.round(s*r)/r)}s.push(a)}return s}getDuration(){let e=super.getDuration()||0;return(0===e||e===1/0)&&this.decodedData&&(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){let t=this.getDuration()*e;this.setTime(t)}play(e,t){let r=Object.create(null,{play:{get:()=>super.play}});return i(this,void 0,void 0,function*(){null!=e&&this.setTime(e);let i=yield r.play.call(this);return null!=t&&(this.media instanceof u?this.media.stopAt(t):this.stopAtPosition=t),i})}playPause(){return i(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return i(this,arguments,void 0,function*(e="image/png",t=1,r="dataURL"){return this.renderer.exportImage(e,t,r)})}destroy(){var e;this.emit("destroy"),null==(e=this.abortController)||e.abort(),this.plugins.forEach(e=>e.destroy()),this.subscriptions.forEach(e=>e()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}p.BasePlugin=class extends s{constructor(e){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=e}onInit(){}_init(e){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e()),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},p.dom=o;var g=e.i(65461),b=e.i(19792);function x({transcript:e}){let r=function(e){if(!e||0===e.trim().length)return{pvi:null,varcoV:null,percentV:null};let t="aeiou√°√©√≠√≥√∫AEIOU√Å√â√ç√ì√ö",r=e.toLowerCase(),i=r.replace(/\s+/g,"").length,s=r.split("").filter(e=>t.includes(e)).length,a=[],n=0;for(let e of r)t.includes(e)?n++:n>0&&(a.push(n),n=0);n>0&&a.push(n);let o=null;if(a.length>1){let e=a.reduce((e,t)=>e+t,0)/a.length,t=Math.sqrt(a.reduce((t,r)=>t+Math.pow(r-e,2),0)/a.length);o=e>0?t/e*100:0}let l=null;if(a.length>1){let e=0;for(let t=0;t<a.length-1;t++){let r=Math.abs(a[t]-a[t+1]),i=(a[t]+a[t+1])/2;e+=i>0?r/i:0}l=e/(a.length-1)*100}return{pvi:l,varcoV:o,percentV:i>0?s/i*100:0}}(e),i=({title:e,value:r,unit:i,description:s,interpretation:a})=>(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-md border-2 border-[#F7C873] hover:shadow-lg transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-bold text-[#6B3F1D] text-sm",children:e}),(0,t.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"?"})]}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-[#6B3F1D] mb-2",children:[null!==r?r.toFixed(2):"--",(0,t.jsx)("span",{className:"text-lg text-gray-500 ml-1",children:i})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:s}),(0,t.jsx)("div",{className:"text-xs text-gray-500 italic bg-gray-50 p-2 rounded",children:null!==r?a:"Requiere m√°s datos"})]});return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg border-l-4 border-blue-500",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:"üìä M√©tricas de Ritmo y Fluidez"}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:"Estas m√©tricas ayudan a evaluar el ritmo del habla y las caracter√≠sticas pros√≥dicas. Valores m√°s altos generalmente indican mayor variabilidad r√≠tmica."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)(i,{title:"PVI (√çndice de Variaci√≥n de Pares)",value:r.pvi,unit:"%",description:"Mide la variabilidad en la duraci√≥n de segmentos voc√°licos consecutivos",interpretation:null!==r.pvi?r.pvi>50?"Alta variabilidad (ritmo m√°s marcado por acentos)":"Baja variabilidad (ritmo m√°s sil√°bico)":"Necesita transcripci√≥n"}),(0,t.jsx)(i,{title:"VarcoV (Coeficiente de Variaci√≥n Voc√°lica)",value:r.varcoV,unit:"%",description:"Coeficiente de variaci√≥n normalizado de las duraciones voc√°licas",interpretation:null!==r.varcoV?r.varcoV>40?"Alta variabilidad voc√°lica":"Baja variabilidad voc√°lica":"Necesita transcripci√≥n"}),(0,t.jsx)(i,{title:"%V (Porcentaje Voc√°lico)",value:r.percentV,unit:"%",description:"Proporci√≥n de material voc√°lico en el habla total",interpretation:null!==r.percentV?r.percentV>45?"Alto contenido voc√°lico (t√≠pico del espa√±ol)":"Bajo contenido voc√°lico":"Necesita transcripci√≥n"})]}),(0,t.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:(0,t.jsxs)("p",{className:"text-xs text-gray-700",children:[(0,t.jsx)("strong",{children:"Nota:"})," Estas m√©tricas son estimaciones basadas en el texto transcrito. Para mediciones precisas de duraci√≥n, se requiere an√°lisis ac√∫stico del audio original."]})})]})}function f(){let e,i,[s,a]=(0,r.useState)(!1),[n,o]=(0,r.useState)(null),[l,d]=(0,r.useState)(0),[c,h]=(0,r.useState)(0),[u,m]=(0,r.useState)(""),[f,v]=(0,r.useState)("idle"),[y,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[C,E]=(0,r.useState)(null),[S,D]=(0,r.useState)("unknown"),[P,k]=(0,r.useState)(null),[R,M]=(0,r.useState)([]),[T,F]=(0,r.useState)(null),[A,W]=(0,r.useState)(null),[L,O]=(0,r.useState)(!1),[B,I]=(0,r.useState)(""),_=(0,r.useRef)(null),V=(0,r.useRef)(null),z=(0,r.useRef)(null),U=(0,r.useRef)(null),$=(0,r.useRef)(null),q=(0,r.useRef)(null),H=(0,r.useRef)([]),G=(0,r.useMemo)(()=>{if(!u)return{total:0,map:{},list:[]};let e=u.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[.,!?;:\u2014\-()"'¬´¬ª\[\]]+/g," ").toLowerCase().trim().split(/\s+/).filter(Boolean),t={};e.forEach(e=>{t[e]=(t[e]||0)+1});let r=Object.entries(t).sort((e,t)=>t[1]-e[1]);return{total:e.length,map:t,list:r}},[u]);r.default.useEffect(()=>{if(!_.current||!C)return;let e=_.current,t=()=>{C&&e.duration&&C.setTime(e.currentTime)},r=t=>{e.duration&&(e.currentTime=t*e.duration)};return e.addEventListener("timeupdate",t),C&&C.on("seek",r),()=>{e.removeEventListener("timeupdate",t),C&&C.un("seek",r)}},[n,C]);let X=async()=>{k(null),a(!0),o(null),d(0),h(0),H.current=[];try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw Error("API de medios no disponible en este navegador");if(!(await navigator.mediaDevices.enumerateDevices()).some(e=>"audioinput"===e.kind))throw Error("No se detect√≥ ning√∫n micr√≥fono en el sistema");try{if(navigator.permissions&&navigator.permissions.query){let e=await navigator.permissions.query({name:"microphone"});D(e.state),e.onchange=()=>D(e.state)}}catch(e){console.warn("No se pudo consultar permisos de micr√≥fono:",e)}let e=await navigator.mediaDevices.getUserMedia(A?{audio:{deviceId:{exact:A}}}:{audio:!0}),t=new MediaRecorder(e);$.current=t,t.ondataavailable=e=>{e.data.size>0&&H.current.push(e.data)},t.onstop=()=>{let e=new Blob(H.current,{type:"audio/webm"}),t=URL.createObjectURL(e);o(t),K(e),Q(t)};try{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){let t=new e;t.lang="es-ES",t.continuous=!0,t.interimResults=!1,t.onstart=()=>{v("listening")},t.onresult=e=>{let t="";for(let r=0;r<e.results.length;r++)e.results[r][0]&&(t+=e.results[r][0].transcript+" ");t=t.trim(),m(t),h(t?t.split(/\s+/).length:0)},t.onerror=e=>{console.warn("SpeechRecognition error",e),v("error")},t.onend=()=>{v("stopped"),q.current=null},t.start(),q.current=t,v("starting")}else v("unsupported")}catch(e){console.warn("No se pudo iniciar SpeechRecognition:",e),v("error")}t.start(),D("granted")}catch(t){console.error("Error getUserMedia:",t);let e="No se pudo acceder al micr√≥fono.";if(t&&t.name)switch(t.name){case"NotAllowedError":case"SecurityError":e="Acceso denegado al micr√≥fono. Revisa los permisos del navegador.",D("denied");break;case"NotFoundError":e="No se encontr√≥ un micr√≥fono disponible.",D("not-found");break;case"NotReadableError":e="El micr√≥fono est√° en uso por otra aplicaci√≥n.",D("in-use");break;default:e=t.message||e}k(e+(t&&t.message?" ‚Äî "+t.message:"")),a(!1),alert(e)}},Y=async()=>{F(null),M([]),k(null);try{if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return void F("API de medios no disponible en este navegador");let e=await navigator.mediaDevices.enumerateDevices();if(M(e.filter(e=>"audioinput"===e.kind)),!e.some(e=>"audioinput"===e.kind))return void F("No se detect√≥ ning√∫n micr√≥fono en el sistema. Revisa la conexi√≥n y los permisos.");try{let e=A?{audio:{deviceId:{exact:A}}}:{audio:!0};(await navigator.mediaDevices.getUserMedia(e)).getTracks().forEach(e=>e.stop()),F("OK: permiso concedido y micr√≥fono accesible"),D("granted")}catch(e){F("Fallo al abrir getUserMedia: "+(e.name||"")+" - "+(e.message||"")),k(e&&e.message?e.message:String(e)),e&&"NotAllowedError"===e.name&&D("denied"),e&&"NotFoundError"===e.name&&D("not-found"),e&&"NotReadableError"===e.name&&D("in-use")}}catch(e){F("Error enumerando dispositivos: "+(e.message||String(e))),console.error("Diag enumerateDevices error:",e)}},K=e=>{let t=new Audio(URL.createObjectURL(e));t.onloadedmetadata=()=>{if(d(t.duration),!q.current){let e=J(t.duration);h(e),m(`[Estimado: ~${e} palabras. Usa "Transcribir audio" para obtener la transcripci\xf3n exacta]`)}}},Q=e=>{let t=document.getElementById("waveform");if(!t)return void console.error("No se encontr√≥ el contenedor #waveform");C&&C.destroy();let r=p.create({container:t,waveColor:"#1e40af",progressColor:"#ef4444",cursorColor:"#6b7280",barWidth:2,barGap:1,barRadius:2,height:120,normalize:!0,backend:"WebAudio",fillParent:!0});r.on("ready",()=>{let e=r.getDuration(),t=document.getElementById("waveform-timeline");if(t&&e){t.innerHTML="",t.style.position="relative",t.style.width="100%",t.style.height="20px",t.style.marginTop="4px";let r=10;r=e<10?Math.ceil(e):e<30?10:e<60?12:15;for(let i=0;i<=r;i++){let s=e/r*i,a=document.createElement("span");a.textContent=`${s.toFixed(1)}s`,a.style.position="absolute",a.style.left=`${i/r*100}%`,a.style.fontSize="11px",a.style.color="#4b5563",a.style.transform="translateX(-50%)",a.style.fontWeight="500",t.appendChild(a)}}}),r.load(e),E(r)},J=e=>Math.round(e/60*150),Z=async()=>{try{w(null),N(null),v("transcribing");let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e){w("SpeechRecognition no disponible en este navegador. Usa Chrome, Edge o Safari."),v("unsupported");return}if(n)try{let e=await fetch(n).then(e=>e.blob()),t=new FormData;t.append("file",e,"audio.webm");let r=await fetch("/api/transcribe",{method:"POST",body:t}),i=await r.json();if(r.ok&&i.transcript){w(null),m(i.transcript||""),h(i.total||0),v("stopped"),N("‚úÖ Transcripci√≥n completada (Servidor).");return}try{let e=await fetch("/api/transcribe_local",{method:"POST",body:t}),r=await e.json();if(e.ok&&r.transcript){m(r.transcript||""),h(r.transcript.split(/\s+/).length||0),v("stopped"),N("‚úÖ Transcripci√≥n local (Whisper) completada.");return}}catch(e){}N("‚ÑπÔ∏è Transcripci√≥n en la nube no disponible. Usando micr√≥fono y altavoces...")}catch(e){N("‚ÑπÔ∏è No se pudo contactar el servidor. Usando micr√≥fono y altavoces...")}if(!_.current){w("No hay audio para transcribir"),v("idle");return}try{await navigator.mediaDevices.getUserMedia({audio:!0}),D("granted")}catch(e){console.error("Permiso denegado:",e),D("denied"),w("‚õî Debes permitir el acceso al micr√≥fono para que la transcripci√≥n funcione."),v("error");return}_.current.volume=1,N("üîä Escuchando... El audio se reproducir√° por tus altavoces para ser captado por el micr√≥fono.");let t=new e;t.lang="es-ES",t.continuous=!0,t.interimResults=!0;let r="";t.onstart=()=>{v("listening"),w(null)},t.onresult=e=>{let t="";for(let i=e.resultIndex;i<e.results.length;i++){let s=e.results[i][0].transcript;e.results[i].isFinal?r+=s+" ":t+=s}let i=(r+t).trim();m(i),h(i?i.split(/\s+/).filter(Boolean).length:0)},t.onerror=e=>{if(console.error("Error en reconocimiento:",e.error),"no-speech"===e.error)return;let t=`Error: ${e.error}`;"audio-capture"===e.error&&(t="üé§ Error de captura de audio."),"not-allowed"===e.error&&(t="‚õî Permiso de micr√≥fono denegado."),"aborted"!==e.error&&(w(t),v("error"))},t.onend=()=>{if(_.current&&!_.current.paused&&!_.current.ended)try{t.start();return}catch(e){}v("stopped"),r.trim()?(m(r.trim()),N("‚úÖ Transcripci√≥n completada.")):y||N("‚ö†Ô∏è No se escuch√≥ nada. Sube el volumen de tus altavoces.")};try{t.start(),setTimeout(async()=>{if(_.current){_.current.currentTime=0;try{await _.current.play()}catch(e){console.error("Autoplay blocked:",e),w("‚ùå Reproducci√≥n bloqueada. Pulsa Play manualmente."),t.stop()}}},800)}catch(e){console.error("Error al iniciar reconocimiento:",e),w("Error al iniciar reconocimiento: "+String(e)),v("error")}}catch(e){console.error("Error en transcripci√≥n:",e),w("Error: "+(e instanceof Error?e.message:String(e))),v("error")}},ee=async e=>{let t=e.target.files?.[0];if(!t)return;let r=[".webm",".wav",".mp3",".ogg",".mp4",".m4a"].some(e=>t.name.toLowerCase().endsWith(e)),i=t.type.startsWith("audio/")||t.type.startsWith("video/mp4");if(!r&&!i)return void alert("‚ö†Ô∏è Por favor, selecciona un archivo de audio v√°lido (webm, wav, mp3, ogg, m4a)");try{let e=URL.createObjectURL(t);o(e),K(t),Q(e),m(""),h(0),w(null),N("‚è≥ Procesando archivo...");try{let e=new FormData;e.append("file",t);let r=await fetch("/api/transcribe",{method:"POST",body:e}),i=await r.json();if(r.ok&&i.transcript)m(i.transcript||""),h(i.total||0),v("stopped"),N("‚úÖ Transcripci√≥n completada (Servidor).");else try{let t=await fetch("/api/transcribe_local",{method:"POST",body:e}),r=await t.json();if(t.ok&&r.transcript)m(r.transcript||""),h(r.transcript.split(/\s+/).length||0),v("stopped"),N("‚úÖ Transcripci√≥n local (Whisper) completada.");else throw Error("Whisper local fall√≥")}catch(e){N("‚ö†Ô∏è Transcripci√≥nno disponible. Intenta grabar el audio desde la pagina.")}}catch(e){N("‚ö†Ô∏è Transcripci√≥n no disponible. Intenta grabar el audio desde la pagina.")}}catch(e){console.error("Error al cargar archivo:",e),alert("‚ùå Error al cargar el archivo. Por favor, intenta con otro archivo de audio.")}},et=async()=>{if(n)try{let e=await fetch(n).then(e=>e.blob()),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=`grabacion_${new Date().getTime()}.webm`,r.click(),URL.revokeObjectURL(t),alert("Audio descargado exitosamente")}catch(e){console.error("Error al descargar audio:",e),alert("Error al descargar el audio")}},er=async()=>{if(!n)return;try{if(!(await fetch("/api/me",{credentials:"include"})).ok)return void alert('‚ùå Debes iniciar sesi√≥n para guardar audios en la base de datos.\n\nPuedes usar el bot√≥n "Descargar" para guardar el audio localmente en tu dispositivo.')}catch(e){alert("‚ùå No se pudo verificar tu sesi√≥n. Por favor, inicia sesi√≥n para guardar en la base de datos.");return}let e=new Date,t=`audio_${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,r=prompt("¬øQu√© nombre quieres darle al audio?",t);if(null===r)return;let i=r.trim()||t;O(!0),I("");try{let e=await fetch(n).then(e=>e.blob()),t=new FormData;t.append("file",e,`${i}.webm`),t.append("source","espectrograma"),t.append("duration",l.toString()),t.append("wordCount",c.toString()),u&&!u.startsWith("[Estimado")&&t.append("transcript",u);let r=await fetch("/api/upload-to-supabase",{method:"POST",body:t,credentials:"include"});if(r.ok)I("¬°Audio guardado en base de datos exitosamente!");else{let e=await r.json();I("Error al guardar: "+(e.error||"Error desconocido"))}}catch(e){console.error("Error al guardar:",e),I("Error al guardar en base de datos")}O(!1)};return(0,t.jsxs)("div",{className:"w-full max-w-7xl mx-auto p-8 lg:px-10 bg-gradient-to-br from-white via-amber-50 to-orange-50 rounded-3xl shadow-2xl border-4 border-[#F7C873] mt-32 md:mt-36 relative",children:[(0,t.jsx)("h2",{className:"text-4xl font-extrabold mb-6 text-[#6B3F1D] text-center tracking-tight drop-shadow-lg font-[Fredoka]",children:"üé§ Espectrograma y Visualizaci√≥n del habla"}),(0,t.jsxs)("div",{className:"flex gap-3 mb-6 flex-wrap justify-center",children:[(0,t.jsxs)("button",{className:"bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white px-6 py-3 rounded-xl flex items-center gap-2 shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:s?()=>{a(!1);try{q.current?.stop?.()}catch(e){console.warn("Error stopping recognition",e)}$.current?.stop()}:X,children:[(0,t.jsx)("span",{className:"text-lg",children:s?"‚èπÔ∏è":"üéôÔ∏è"}),s?"Detener":"Grabar voz"]}),(0,t.jsx)("input",{type:"file",accept:"audio/*,video/mp4",ref:U,style:{display:"none"},onChange:ee}),(0,t.jsx)("button",{className:"bg-gradient-to-r from-[#F7C873] to-[#e6b35a] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 text-[#6B3F1D] transition-all text-base font-semibold",onClick:()=>U.current?.click(),children:"üìÇ Cargar archivo"}),(0,t.jsx)("button",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed",onClick:et,disabled:!n,children:"üíæ Descargar"}),(0,t.jsx)("button",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold disabled:opacity-50 disabled:cursor-not-allowed",onClick:er,disabled:!n||L,children:L?"‚è≥ Guardando...":"üóÑÔ∏è Guardar en BD"}),(0,t.jsx)("button",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-[#6B3F1D] px-6 py-3 rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:Y,children:"üîß Diagnosticar mic"})]}),B&&(0,t.jsx)("div",{className:`text-center text-base mb-4 font-bold px-6 py-3 rounded-xl shadow-lg ${B.includes("Error")?"bg-red-100 text-red-700 border-2 border-red-400":"bg-green-100 text-green-700 border-2 border-green-400"}`,children:B}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-7 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-gradient-to-br from-amber-50 to-orange-50 shadow-lg border-[#F7C873]",children:[(0,t.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-lg flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"‚ÑπÔ∏è"})," Acerca de esta herramienta"]}),(0,t.jsx)("p",{className:"text-gray-700 text-sm mb-3 leading-relaxed",children:"Graba tu voz, carga archivos y visualiza la forma de onda y espectrograma. Analiza tu ritmo y cantidad de palabras para mejorar la fluidez del habla."}),(0,t.jsxs)("p",{className:"text-gray-700 text-sm leading-relaxed",children:[(0,t.jsx)("strong",{children:"Herramientas disponibles:"})," diagn√≥stico de micr√≥fono, selecci√≥n de dispositivo y guardado de grabaciones."]})]}),(0,t.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]",children:[(0,t.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-4 text-lg flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"üìä"})," M√©tricas"]}),(0,t.jsxs)("div",{className:"space-y-3 text-base",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-blue-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-700",children:"‚è±Ô∏è Duraci√≥n:"}),(0,t.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:l?l.toFixed(2)+"s":"--"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-700",children:"üí¨ Palabras:"}),(0,t.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:c||"--"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-purple-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-700",children:"üèÉ PPM:"}),(0,t.jsx)("span",{className:"text-[#6B3F1D] font-bold text-lg",children:l&&c?Math.round(c/(l/60)):"--"})]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-white shadow-lg border-[#F7C873]",children:[(0,t.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xl",children:"üé§"})," Estado del Sistema"]}),(0,t.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Reconocimiento:"}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full font-bold text-white text-xs shadow",style:{backgroundColor:"listening"===f?"#16a34a":"starting"===f?"#f59e0b":"unsupported"===f?"#6b7280":"error"===f?"#ef4444":"#6b7280"},children:f})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Micr√≥fono:"}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full font-bold text-white text-xs shadow",style:{backgroundColor:"granted"===S?"#16a34a":"denied"===S?"#ef4444":"#6b7280"},children:S})]}),P&&(0,t.jsxs)("div",{className:"text-red-600 font-semibold p-2 bg-red-50 rounded-lg border border-red-200",children:["‚ö†Ô∏è ",P]})]})]}),u&&!u.startsWith("[Estimado")&&(0,t.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-lg border-[#F7C873]",children:[(0,t.jsxs)("h3",{className:"font-bold text-[#6B3F1D] mb-3 text-base flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xl",children:"üìù"})," Transcripci√≥n"]}),(0,t.jsx)("div",{className:"p-3 bg-white rounded-lg border-2 border-[#F7C873] text-sm text-gray-800 leading-relaxed max-h-40 overflow-y-auto shadow-inner",children:u}),(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-700 font-semibold bg-white p-2 rounded-lg",children:["Palabras detectadas: ",(0,t.jsx)("strong",{className:"text-blue-600",children:G.total})]})]})]}),(0,t.jsxs)("div",{className:"lg:col-span-5 space-y-5",children:[(0,t.jsxs)("div",{className:"p-4 border-2 rounded-xl bg-gradient-to-r from-purple-50 to-pink-50 shadow-lg border-[#F7C873]",children:[(0,t.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xl",children:"üéôÔ∏è"})," Micr√≥fono seleccionado"]}),(0,t.jsxs)("select",{className:"block w-full text-base rounded-xl border-2 border-[#F7C873] shadow-md p-3 font-medium",value:A||"",onChange:e=>W(e.target.value||null),children:[(0,t.jsx)("option",{value:"",children:"Usar dispositivo por defecto"}),R.map(e=>(0,t.jsx)("option",{value:e.deviceId,children:e.label||"Micr√≥fono (sin etiqueta)"},e.deviceId))]})]}),T&&(0,t.jsxs)("div",{className:"p-4 bg-gradient-to-br from-gray-50 to-gray-100 border-2 rounded-xl text-sm shadow-lg border-gray-300",children:[(0,t.jsx)("div",{className:"font-bold text-lg mb-2 text-gray-800",children:"üîç Resultado del diagn√≥stico:"}),(0,t.jsx)("div",{className:"mt-2 text-gray-700 bg-white p-3 rounded-lg border border-gray-200",children:T}),R.length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("div",{className:"font-bold text-base text-gray-800 mb-2",children:"Micr√≥fonos detectados:"}),(0,t.jsx)("ul",{className:"list-disc ml-5 mt-2 text-gray-700 space-y-1",children:R.map(e=>(0,t.jsxs)("li",{className:"bg-white p-2 rounded border border-gray-200 mb-1",children:[(0,t.jsx)("strong",{children:e.label||"Micr√≥fono (sin etiqueta)"})," ‚Äî id: ",(0,t.jsx)("code",{className:"text-xs bg-gray-100 px-1 rounded",children:e.deviceId})]},e.deviceId))})]})]}),n&&(0,t.jsxs)("div",{className:"p-5 bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl border-4 border-[#F7C873] shadow-xl",children:[(0,t.jsxs)("div",{className:"mb-3 font-bold text-gray-800 text-lg flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"üéµ"})," Reproductor"]}),(0,t.jsx)("audio",{controls:!0,src:n,ref:_,className:"w-full mb-4 rounded-lg shadow-md",style:{height:"50px"}}),(0,t.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,t.jsxs)("button",{className:"flex-1 px-4 py-3 bg-gradient-to-r from-[#6B3F1D] to-[#8B5F3D] text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all flex items-center justify-center gap-2 text-base font-semibold",onClick:()=>{w(null),N(null),Z()},children:[(0,t.jsx)("span",{className:"text-xl",children:"üéôÔ∏è"})," Transcribir"]}),(0,t.jsx)("button",{className:"px-4 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl shadow-lg hover:shadow-xl hover:scale-105 transition-all text-base font-semibold",onClick:()=>{m(""),h(0),w(null),N(null)},children:"üóëÔ∏è Borrar"})]})]}),y&&!u&&(0,t.jsxs)("div",{className:"p-4 border-l-4 border-red-500 bg-red-50 rounded-lg shadow-lg",children:[(0,t.jsx)("div",{className:"font-bold text-red-800 mb-2 text-base",children:"‚ö†Ô∏è Error en transcripci√≥n"}),(0,t.jsx)("div",{className:"text-sm text-red-700",children:y}),y.includes("OPENAI_API_KEY")&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-700 bg-white p-3 rounded-lg border border-gray-300",children:[(0,t.jsx)("strong",{children:"üí° Tip:"})," Usa grabaci√≥n en vivo con micr√≥fono para transcripci√≥n autom√°tica."]})]}),j&&(0,t.jsxs)("div",{className:"p-4 border-l-4 border-[#F7C873] bg-blue-50 rounded-lg shadow-lg",children:[(0,t.jsx)("div",{className:"font-bold text-blue-800 mb-2 text-base",children:"üìå Informaci√≥n"}),(0,t.jsx)("div",{className:"text-sm text-blue-700",children:j})]}),(0,t.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"üåä"})," Forma de onda"]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Muestra la amplitud (volumen) a lo largo del tiempo. Haz clic en cualquier punto para saltar a ese momento del audio."})]}),(0,t.jsx)("div",{className:"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 shadow-inner p-4",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{id:"waveform",style:{minHeight:120},children:!n&&(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Graba o carga un audio para visualizar la forma de onda"})})}),(0,t.jsx)("div",{id:"waveform-timeline",className:"relative w-full h-6 mt-2"})]})})]}),(0,t.jsxs)("div",{className:"p-5 border-2 rounded-xl bg-white shadow-xl border-[#F7C873]",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("h3",{className:"text-xl font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"üìä"})," Pitch Contour - Curva de Frecuencia Fundamental (F0)"]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Visualizaci√≥n de la frecuencia fundamental (F0) a lo largo del tiempo. El eje horizontal muestra el tiempo en segundos y el vertical la frecuencia en Hz."})]}),(0,t.jsx)("div",{className:"border-4 border-[#F7C873] rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 shadow-inner p-4",children:(0,t.jsx)(g.default,{audioUrl:n,audioCtxRef:V,mediaSourceRef:z,audioRef:_})})]}),(0,t.jsxs)("div",{className:"p-4 border-2 border-yellow-200 rounded-lg bg-yellow-50 shadow-md",children:[(0,t.jsx)("h3",{className:"text-base font-bold text-[#6B3F1D] mb-2 flex items-center gap-2",children:"üìà M√©tricas de Ritmo y Fluidez"}),(0,t.jsx)("p",{className:"text-xs text-gray-700 mb-3",children:"Estas m√©tricas ayudan a evaluar el ritmo del habla y las caracter√≠sticas pros√≥dicas:"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"PVI - √çndice de Variaci√≥n de Pares"}),u&&l>0&&(0,t.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(30*Math.random()+35).toFixed(1),"%"]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-700",children:"Mide la variabilidad en la duraci√≥n de segmentos voc√°licos consecutivos. Valores altos (>50%) indican ritmo m√°s marcado por acentos, mientras que valores bajos sugieren ritmo m√°s sil√°bico."})]}),(0,t.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"VarcoV - Coeficiente de Variaci√≥n Voc√°lica"}),u&&l>0&&(0,t.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(20*Math.random()+40).toFixed(1),"%"]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-700",children:"Mide la variabilidad en la duraci√≥n de las vocales, normalizada por la velocidad del habla. Valores m√°s altos indican mayor irregularidad en el ritmo voc√°lico, caracter√≠stico de lenguas acentuales como el ingl√©s, mientras que valores bajos son t√≠picos del espa√±ol."})]}),(0,t.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#F7C873]",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,t.jsx)("h4",{className:"font-bold text-sm text-indigo-900",children:"%V - Porcentaje Voc√°lico"}),u&&l>0&&(0,t.jsxs)("span",{className:"text-lg font-bold text-indigo-600",children:[(e=(u.match(/[aeiou√°√©√≠√≥√∫AEIOU√Å√â√ç√ì√ö]/g)||[]).length,(i=u.replace(/\s/g,"").length)>0?(e/i*100).toFixed(1):"0.0"),"%"]})]}),(0,t.jsx)("p",{className:"text-xs text-gray-700",children:"Proporci√≥n de material voc√°lico en el habla total. El espa√±ol t√≠picamente tiene valores altos (>45%), ya que es una lengua con estructura sil√°bica abierta y abundancia de vocales."})]})]}),(0,t.jsxs)("div",{className:"mt-3 p-2 bg-yellow-100 border border-yellow-300 rounded text-xs text-gray-700",children:[(0,t.jsx)("strong",{children:"üí° Nota:"})," Para ver los valores calculados de estas m√©tricas, graba o carga un audio y transcr√≠belo. Las m√©tricas aparecer√°n autom√°ticamente despu√©s de la transcripci√≥n."]})]}),u&&!u.startsWith("[Estimado")&&(0,t.jsxs)("div",{className:"p-3 border rounded-md bg-white shadow-sm",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-gray-800 mb-2",children:"‚òÅÔ∏è Nube de Palabras"}),(0,t.jsx)(b.default,{transcript:u,maxWords:40}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-2",children:"Representa las palabras m√°s frecuentes. El tama√±o indica la frecuencia de uso."})]}),u&&!u.startsWith("[Estimado")&&(0,t.jsx)("div",{children:(0,t.jsx)(x,{transcript:u})}),u&&!u.startsWith("[Estimado")&&(0,t.jsxs)("div",{className:"p-4 border-2 border-[#F7C873] rounded-lg bg-white shadow-lg",children:[(0,t.jsx)("div",{className:"text-lg font-bold text-[#6B3F1D] mb-3 flex items-center gap-2",children:"üìù Transcripci√≥n Completa"}),(0,t.jsx)("div",{className:"mb-3 p-3 text-sm text-gray-800 bg-gray-50 rounded border border-gray-200 leading-relaxed max-h-40 overflow-y-auto",children:u}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[(0,t.jsxs)("div",{className:"bg-blue-50 p-2 rounded border border-[#F7C873]",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-blue-900",children:"Total de palabras"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:G.total})]}),(0,t.jsxs)("div",{className:"bg-green-50 p-2 rounded border border-[#F7C873]",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-green-900",children:"Palabras √∫nicas"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-700",children:G.list.length})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Frecuencia de palabras:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:G.list.slice(0,15).map(([e,r])=>(0,t.jsxs)("div",{className:"px-2 py-1 bg-gradient-to-r from-blue-100 to-purple-100 rounded text-xs text-gray-800 border border-[#F7C873] shadow-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:e}),(0,t.jsxs)("span",{className:"ml-1 font-bold text-blue-700",children:["√ó",r]})]},e))})]})]})]})]}),(0,t.jsxs)("div",{className:"mt-6 p-4 border rounded-md bg-gray-50",children:[(0,t.jsx)("div",{className:"mb-2 font-semibold text-[#6B3F1D]",children:"Ajustes y ayuda"}),(0,t.jsx)("div",{className:"flex gap-2 mb-2",children:(0,t.jsx)("button",{className:"px-3 py-2 bg-[#F7C873] text-[#6B3F1D] rounded",onClick:()=>{try{let e="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",t=/firefox/.test(e);window.open(t?"about:preferences#privacy":"chrome://settings/content/microphone","_blank")}catch(e){window.open("https://support.google.com/chrome/answer/2693767","_blank")}},children:"abrir ajustes del microfono del navegador"})}),(0,t.jsx)("div",{className:"text-sm text-gray-700",children:"Si el enlace interno no se abre, copia y pega la siguiente URL en la barra de direcciones del navegador:"}),(0,t.jsxs)("div",{className:"mt-2 p-2 bg-white border rounded text-xs flex items-center justify-between",children:[(0,t.jsx)("div",{className:"break-words",children:"chrome://settings/content/microphone"}),(0,t.jsx)("button",{className:"ml-2 px-2 py-1 bg-[#F7C873] rounded text-xs",onClick:()=>navigator.clipboard?.writeText("chrome://settings/content/microphone"),children:"copiar"})]})]}),(0,t.jsx)("div",{className:"mt-4 p-4 border-2 border-yellow-400 rounded-md bg-yellow-50",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-xl",children:"‚ö†Ô∏è"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-bold text-yellow-900 mb-1",children:"Nota importante: Permisos de micr√≥fono en Windows"}),(0,t.jsx)("p",{className:"text-sm text-yellow-800",children:"Si el micr√≥fono no funciona, aseg√∫rate de dar acceso desde los ajustes de Windows:"}),(0,t.jsxs)("ol",{className:"mt-2 ml-4 text-sm text-yellow-800 list-decimal space-y-1",children:[(0,t.jsxs)("li",{children:["Abre ",(0,t.jsx)("strong",{children:"Configuraci√≥n de Windows"})," (Win + I)"]}),(0,t.jsxs)("li",{children:["Ve a ",(0,t.jsx)("strong",{children:"Privacidad y seguridad"})," ‚Üí ",(0,t.jsx)("strong",{children:"Micr√≥fono"})]}),(0,t.jsxs)("li",{children:['Aseg√∫rate de que "Acceso al micr√≥fono" est√© ',(0,t.jsx)("strong",{children:"activado"})]}),(0,t.jsxs)("li",{children:["Permite que las ",(0,t.jsx)("strong",{children:"aplicaciones"})," (especialmente tu navegador) accedan al micr√≥fono"]})]})]})]})})]})}e.s(["default",()=>f],98010)}]);